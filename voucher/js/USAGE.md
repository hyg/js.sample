# 电子凭证自动整理工具使用说明

## 安装

确保已安装Node.js，然后在项目目录中运行：

```bash
npm install
```

## 使用方法

### 1. 批量处理模式

将电子凭证内容保存为文本文件，然后使用以下命令处理：

```bash
node voucher.js < your-voucher.txt
```

或者使用npm脚本：

```bash
npm start < your-voucher.txt
```

### 2. 交互式模式

运行交互式模式，可以连续处理多个电子凭证：

```bash
node vi.js
```

或者使用npm脚本：

```bash
npm run interactive
```

在交互式模式下：
1. 输入电子凭证的多行内容
2. 输入"END"结束当前凭证的输入
3. 系统会自动生成AVR.id.yaml和AER.id.yaml文件
4. 继续输入下一个电子凭证或按Ctrl+C退出

## 高级功能

### 自定义金额和摘要

在凭证输入的最后，您可以使用以下格式来指定自定义的金额和摘要：

1. 输入凭证内容后，用"---"作为分隔符开始新的一行
2. 在下一行输入金额（例如：128.00）
3. 在再下一行输入摘要（例如：阿里云服务购买）

示例：
```
当前状态

支付成功

支付时间

2025年8月22日 20:54:21

商品

商户单号XP2125082220200492539796002493

收单机构

财付通支付科技有限公司

支付方式

零钱

交易单号

4200002841202508223625922851

商户单号

XP2125082220200492539796002493

商家小程序
---
128.00
阿里云服务购买
```

## 输出文件

生成的YAML文件将保存在项目目录中，文件名为`AVR.{id}.yaml`和`AER.{id}.yaml`，其中id是自动递增的数字。

## 示例

输入文件内容示例：
```
当前状态

支付成功

支付时间

2025年8月23日 10:30:45

商品

美团订单-25082311100300001304615814784877

商户全称

北京三快在线科技有限公司

收单机构

财付通支付科技有限公司

支付方式

零钱

交易单号

4200002727202508230795047469

商户单号

20250823103045U70804517930403524

商家小程序
```

生成的YAML文件：
```yaml
date: 2025-08-23 10:30:45
title: 微信支付账单
VoucherID: 4200002727202508230795047469
VoucherType: 交易单号
amount: 0.00
summary: 商品购买
comment:
  - name: 商户单号
    value: 20250823103045U70804517930403524
  - name: 美团订单
    value: 25082311100300001304615814784877
```