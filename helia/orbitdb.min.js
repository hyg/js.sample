/*! For license information please see orbitdb.min.js.LICENSE.txt */
var OrbitDB;(()=>{var t={464:(t,e,r)=>{"use strict";const{fromCallback:n}=r(957),i=r(473),{getCallback:o,getOptions:s}=r(520),a=Symbol("promise"),c=Symbol("status"),u=Symbol("operations"),h=Symbol("finishClose"),l=Symbol("closeCallbacks");e.AbstractChainedBatch=class{constructor(t){if("object"!=typeof t||null===t)throw new TypeError("The first argument must be an abstract-level database, received "+(null===t?"null":typeof t));this[u]=[],this[l]=[],this[c]="open",this[h]=this[h].bind(this),this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get length(){return this[u].length}put(t,e,r){if("open"!==this[c])throw new i("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(t)||this.db._checkValue(e);if(n)throw n;const o=r&&null!=r.sublevel?r.sublevel:this.db,s=r,a=o.keyEncoding(r&&r.keyEncoding),h=o.valueEncoding(r&&r.valueEncoding),l=a.format;r={...r,keyEncoding:l,valueEncoding:h.format},o!==this.db&&(r.sublevel=null);const f=o.prefixKey(a.encode(t),l),d=h.encode(e);return this._put(f,d,r),this[u].push({...s,type:"put",key:t,value:e}),this}_put(t,e,r){}del(t,e){if("open"!==this[c])throw new i("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(t);if(r)throw r;const n=e&&null!=e.sublevel?e.sublevel:this.db,o=e,s=n.keyEncoding(e&&e.keyEncoding),a=s.format;return e={...e,keyEncoding:a},n!==this.db&&(e.sublevel=null),this._del(n.prefixKey(s.encode(t),a),e),this[u].push({...o,type:"del",key:t}),this}_del(t,e){}clear(){if("open"!==this[c])throw new i("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[u]=[],this}_clear(){}write(t,e){return e=o(t,e),e=n(e,a),t=s(t),"open"!==this[c]?this.nextTick(e,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(e):(this[c]="writing",this._write(t,(t=>{this[c]="closing",this[l].push((()=>e(t))),t||this.db.emit("batch",this[u]),this._close(this[h])}))),e[a]}_write(t,e){}close(t){return t=n(t,a),"closing"===this[c]?this[l].push(t):"closed"===this[c]?this.nextTick(t):(this[l].push(t),"writing"!==this[c]&&(this[c]="closing",this._close(this[h]))),t[a]}_close(t){this.nextTick(t)}[h](){this[c]="closed",this.db.detachResource(this);const t=this[l];this[l]=[];for(const e of t)e()}}},961:(t,e,r)=>{"use strict";const{fromCallback:n}=r(957),i=r(473),{getOptions:o,getCallback:s}=r(520),a=Symbol("promise"),c=Symbol("callback"),u=Symbol("working"),h=Symbol("handleOne"),l=Symbol("handleMany"),f=Symbol("autoClose"),d=Symbol("finishWork"),y=Symbol("returnMany"),p=Symbol("closing"),g=Symbol("handleClose"),w=Symbol("closed"),b=Symbol("closeCallbacks"),m=Symbol("keyEncoding"),v=Symbol("valueEncoding"),E=Symbol("abortOnClose"),x=Symbol("legacy"),B=Symbol("keys"),A=Symbol("values"),k=Symbol("limit"),S=Symbol("count"),I=Object.freeze({}),T=()=>{};let C=!1;class U{constructor(t,e,r){if("object"!=typeof t||null===t)throw new TypeError("The first argument must be an abstract-level database, received "+(null===t?"null":typeof t));if("object"!=typeof e||null===e)throw new TypeError("The second argument must be an options object");this[w]=!1,this[b]=[],this[u]=!1,this[p]=!1,this[f]=!1,this[c]=null,this[h]=this[h].bind(this),this[l]=this[l].bind(this),this[g]=this[g].bind(this),this[m]=e[m],this[v]=e[v],this[x]=r,this[k]=Number.isInteger(e.limit)&&e.limit>=0?e.limit:1/0,this[S]=0,this[E]=!!e.abortOnClose,this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get count(){return this[S]}get limit(){return this[k]}next(t){let e;if(void 0===t)e=new Promise(((e,r)=>{t=(t,n,i)=>{t?r(t):this[x]?void 0===n&&void 0===i?e():e([n,i]):e(n)}}));else if("function"!=typeof t)throw new TypeError("Callback must be a function");return this[p]?this.nextTick(t,new i("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(t,new i("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[u]=!0,this[c]=t,this[S]>=this[k]?this.nextTick(this[h],null):this._next(this[h])),e}_next(t){this.nextTick(t)}nextv(t,e,r){return r=s(e,r),r=n(r,a),e=o(e,I),Number.isInteger(t)?(this[p]?this.nextTick(r,new i("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(r,new i("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(t<1&&(t=1),this[k]<1/0&&(t=Math.min(t,this[k]-this[S])),this[u]=!0,this[c]=r,t<=0?this.nextTick(this[l],null,[]):this._nextv(t,e,this[l])),r[a]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[a])}_nextv(t,e,r){const n=[],i=(e,o,s)=>e?r(e):(this[x]?void 0===o&&void 0===s:void 0===o)?r(null,n):(n.push(this[x]?[o,s]:o),void(n.length===t?r(null,n):this._next(i)));this._next(i)}all(t,e){return e=s(t,e),e=n(e,a),t=o(t,I),this[p]?this.nextTick(e,new i("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(e,new i("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[u]=!0,this[c]=e,this[f]=!0,this[S]>=this[k]?this.nextTick(this[l],null,[]):this._all(t,this[l])),e[a]}_all(t,e){let r=this[S];const n=[],i=()=>{const t=this[k]<1/0?Math.min(1e3,this[k]-r):1e3;t<=0?this.nextTick(e,null,n):this._nextv(t,I,o)},o=(t,o)=>{t?e(t):0===o.length?e(null,n):(n.push.apply(n,o),r+=o.length,i())};i()}[d](){const t=this[c];return this[E]&&null===t?T:(this[u]=!1,this[c]=null,this[p]&&this._close(this[g]),t)}[y](t,e,r){this[f]?this.close(t.bind(null,e,r)):t(e,r)}seek(t,e){if(e=o(e,I),this[p]);else{if(this[u])throw new i("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(e.keyEncoding||this[m]),n=r.format;e.keyEncoding!==n&&(e={...e,keyEncoding:n});const i=this.db.prefixKey(r.encode(t),n);this._seek(i,e)}}}_seek(t,e){throw new i("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(t){return t=n(t,a),this[w]?this.nextTick(t):this[p]?this[b].push(t):(this[p]=!0,this[b].push(t),this[u]?this[E]&&this[d]()(new i("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[g])),t[a]}_close(t){this.nextTick(t)}[g](){this[w]=!0,this.db.detachResource(this);const t=this[b];this[b]=[];for(const e of t)e()}async*[Symbol.asyncIterator](){try{let t;for(;void 0!==(t=await this.next());)yield t}finally{this[w]||await this.close()}}}class L extends U{constructor(t,e){super(t,e,!0),this[B]=!1!==e.keys,this[A]=!1!==e.values}[h](t,e,r){const n=this[d]();if(t)return n(t);try{e=this[B]&&void 0!==e?this[m].decode(e):void 0,r=this[A]&&void 0!==r?this[v].decode(r):void 0}catch(t){return n(new N("entry",t))}void 0===e&&void 0===r||this[S]++,n(null,e,r)}[l](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(const t of e){const e=t[0],r=t[1];t[0]=this[B]&&void 0!==e?this[m].decode(e):void 0,t[1]=this[A]&&void 0!==r?this[v].decode(r):void 0}}catch(t){return this[y](r,new N("entries",t))}this[S]+=e.length,this[y](r,null,e)}end(t){return C||"undefined"==typeof console||(C=!0,console.warn(new i("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(t)}}class N extends i{constructor(t,e){super(`Iterator could not decode ${t}`,{code:"LEVEL_DECODE_ERROR",cause:e})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(L.prototype,t.split(" ")[0],{get(){throw new i(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new i(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});L.keyEncoding=m,L.valueEncoding=v,e.AbstractIterator=L,e.AbstractKeyIterator=class extends U{constructor(t,e){super(t,e,!1)}[h](t,e){const r=this[d]();if(t)return r(t);try{e=void 0!==e?this[m].decode(e):void 0}catch(t){return r(new N("key",t))}void 0!==e&&this[S]++,r(null,e)}[l](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(let t=0;t<e.length;t++){const r=e[t];e[t]=void 0!==r?this[m].decode(r):void 0}}catch(t){return this[y](r,new N("keys",t))}this[S]+=e.length,this[y](r,null,e)}},e.AbstractValueIterator=class extends U{constructor(t,e){super(t,e,!1)}[h](t,e){const r=this[d]();if(t)return r(t);try{e=void 0!==e?this[v].decode(e):void 0}catch(t){return r(new N("value",t))}void 0!==e&&this[S]++,r(null,e)}[l](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(let t=0;t<e.length;t++){const r=e[t];e[t]=void 0!==r?this[v].decode(r):void 0}}catch(t){return this[y](r,new N("values",t))}this[S]+=e.length,this[y](r,null,e)}}},71:(t,e,r)=>{"use strict";const{supports:n}=r(675),{Transcoder:i}=r(499),{EventEmitter:o}=r(187),{fromCallback:s}=r(957),a=r(473),{AbstractIterator:c}=r(961),{DefaultKeyIterator:u,DefaultValueIterator:h}=r(429),{DeferredIterator:l,DeferredKeyIterator:f,DeferredValueIterator:d}=r(593),{DefaultChainedBatch:y}=r(765),{getCallback:p,getOptions:g}=r(520),w=r(56),b=Symbol("promise"),m=Symbol("landed"),v=Symbol("resources"),E=Symbol("closeResources"),x=Symbol("operations"),B=Symbol("undefer"),A=Symbol("deferOpen"),k=Symbol("options"),S=Symbol("status"),I=Symbol("defaultOptions"),T=Symbol("transcoder"),C=Symbol("keyEncoding"),U=Symbol("valueEncoding"),L=()=>{};class N extends o{constructor(t,e){if(super(),"object"!=typeof t||null===t)throw new TypeError("The first argument 'manifest' must be an object");e=g(e);const{keyEncoding:r,valueEncoding:o,passive:s,...a}=e;this[v]=new Set,this[x]=[],this[A]=!0,this[k]=a,this[S]="opening",this.supports=n(t,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==t.snapshots,permanence:!1!==t.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:t.encodings||{},events:Object.assign({},t.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new i(R(this)),this[C]=this[T].encoding(r||"utf8"),this[U]=this[T].encoding(o||"utf8");for(const t of this[T].encodings())this.supports.encodings[t.commonName]||(this.supports.encodings[t.commonName]=!0);this[I]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[C].commonName,valueEncoding:this[U].commonName}),key:Object.freeze({keyEncoding:this[C].commonName})},this.nextTick((()=>{this[A]&&this.open({passive:!1},L)}))}get status(){return this[S]}keyEncoding(t){return this[T].encoding(null!=t?t:this[C])}valueEncoding(t){return this[T].encoding(null!=t?t:this[U])}open(t,e){e=p(t,e),e=s(e,b),(t={...this[k],...g(t)}).createIfMissing=!1!==t.createIfMissing,t.errorIfExists=!!t.errorIfExists;const r=t=>{"closing"===this[S]||"opening"===this[S]?this.once(m,t?()=>r(t):r):"open"!==this[S]?e(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:t})):e()};return t.passive?"opening"===this[S]?this.once(m,r):this.nextTick(r):"closed"===this[S]||this[A]?(this[A]=!1,this[S]="opening",this.emit("opening"),this._open(t,(t=>{if(t)return this[S]="closed",this[E]((()=>{this.emit(m),r(t)})),void this[B]();this[S]="open",this[B](),this.emit(m),"open"===this[S]&&this.emit("open"),"open"===this[S]&&this.emit("ready"),r()}))):"open"===this[S]?this.nextTick(r):this.once(m,(()=>this.open(t,e))),e[b]}_open(t,e){this.nextTick(e)}close(t){t=s(t,b);const e=r=>{"opening"===this[S]||"closing"===this[S]?this.once(m,r?e(r):e):"closed"!==this[S]?t(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):t()};if("open"===this[S]){this[S]="closing",this.emit("closing");const t=t=>{this[S]="open",this[B](),this.emit(m),e(t)};this[E]((()=>{this._close((r=>{if(r)return t(r);this[S]="closed",this[B](),this.emit(m),"closed"===this[S]&&this.emit("closed"),e()}))}))}else"closed"===this[S]?this.nextTick(e):this.once(m,(()=>this.close(t)));return t[b]}[E](t){if(0===this[v].size)return this.nextTick(t);let e=this[v].size,r=!0;const n=()=>{0==--e&&(r?this.nextTick(t):t())};for(const t of this[v])t.close(n);r=!1,this[v].clear()}_close(t){this.nextTick(t)}get(t,e,r){if(r=p(e,r),r=s(r,b),e=g(e,this[I].entry),"opening"===this[S])return this.defer((()=>this.get(t,e,r))),r[b];if(_(this,r))return r[b];const n=this._checkKey(t);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(e.keyEncoding),o=this.valueEncoding(e.valueEncoding),c=i.format,u=o.format;return e.keyEncoding===c&&e.valueEncoding===u||(e=Object.assign({},e,{keyEncoding:c,valueEncoding:u})),this._get(this.prefixKey(i.encode(t),c),e,((t,e)=>{if(t)return("LEVEL_NOT_FOUND"===t.code||t.notFound||/NotFound/i.test(t))&&(t.code||(t.code="LEVEL_NOT_FOUND"),t.notFound||(t.notFound=!0),t.status||(t.status=404)),r(t);try{e=o.decode(e)}catch(t){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:t}))}r(null,e)})),r[b]}_get(t,e,r){this.nextTick(r,new Error("NotFound"))}getMany(t,e,r){if(r=p(e,r),r=s(r,b),e=g(e,this[I].entry),"opening"===this[S])return this.defer((()=>this.getMany(t,e,r))),r[b];if(_(this,r))return r[b];if(!Array.isArray(t))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[b];if(0===t.length)return this.nextTick(r,null,[]),r[b];const n=this.keyEncoding(e.keyEncoding),i=this.valueEncoding(e.valueEncoding),o=n.format,c=i.format;e.keyEncoding===o&&e.valueEncoding===c||(e=Object.assign({},e,{keyEncoding:o,valueEncoding:c}));const u=new Array(t.length);for(let e=0;e<t.length;e++){const i=t[e],s=this._checkKey(i);if(s)return this.nextTick(r,s),r[b];u[e]=this.prefixKey(n.encode(i),o)}return this._getMany(u,e,((t,e)=>{if(t)return r(t);try{for(let t=0;t<e.length;t++)void 0!==e[t]&&(e[t]=i.decode(e[t]))}catch(t){return r(new a(`Could not decode one or more of ${e.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:t}))}r(null,e)})),r[b]}_getMany(t,e,r){this.nextTick(r,null,new Array(t.length).fill(void 0))}put(t,e,r,n){if(n=p(r,n),n=s(n,b),r=g(r,this[I].entry),"opening"===this[S])return this.defer((()=>this.put(t,e,r,n))),n[b];if(_(this,n))return n[b];const i=this._checkKey(t)||this._checkValue(e);if(i)return this.nextTick(n,i),n[b];const o=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),c=o.format,u=a.format;r.keyEncoding===c&&r.valueEncoding===u||(r=Object.assign({},r,{keyEncoding:c,valueEncoding:u}));const h=this.prefixKey(o.encode(t),c),l=a.encode(e);return this._put(h,l,r,(r=>{if(r)return n(r);this.emit("put",t,e),n()})),n[b]}_put(t,e,r,n){this.nextTick(n)}del(t,e,r){if(r=p(e,r),r=s(r,b),e=g(e,this[I].key),"opening"===this[S])return this.defer((()=>this.del(t,e,r))),r[b];if(_(this,r))return r[b];const n=this._checkKey(t);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(e.keyEncoding),o=i.format;return e.keyEncoding!==o&&(e=Object.assign({},e,{keyEncoding:o})),this._del(this.prefixKey(i.encode(t),o),e,(e=>{if(e)return r(e);this.emit("del",t),r()})),r[b]}_del(t,e,r){this.nextTick(r)}batch(t,e,r){if(!arguments.length){if("opening"===this[S])return new y(this);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"==typeof t?t:p(e,r),r=s(r,b),e=g(e,this[I].empty),"opening"===this[S])return this.defer((()=>this.batch(t,e,r))),r[b];if(_(this,r))return r[b];if(!Array.isArray(t))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[b];if(0===t.length)return this.nextTick(r),r[b];const n=new Array(t.length),{keyEncoding:i,valueEncoding:o,...c}=e;for(let e=0;e<t.length;e++){if("object"!=typeof t[e]||null===t[e])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[b];const s=Object.assign({},t[e]);if("put"!==s.type&&"del"!==s.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[b];const a=this._checkKey(s.key);if(a)return this.nextTick(r,a),r[b];const c=null!=s.sublevel?s.sublevel:this,u=c.keyEncoding(s.keyEncoding||i),h=u.format;if(s.key=c.prefixKey(u.encode(s.key),h),s.keyEncoding=h,"put"===s.type){const t=this._checkValue(s.value);if(t)return this.nextTick(r,t),r[b];const e=c.valueEncoding(s.valueEncoding||o);s.value=e.encode(s.value),s.valueEncoding=e.format}c!==this&&(s.sublevel=null),n[e]=s}return this._batch(n,c,(e=>{if(e)return r(e);this.emit("batch",t),r()})),r[b]}_batch(t,e,r){this.nextTick(r)}sublevel(t,e){return this._sublevel(t,O.defaults(e))}_sublevel(t,e){return new O(this,t,e)}prefixKey(t,e){return t}clear(t,e){if(e=p(t,e),e=s(e,b),t=g(t,this[I].empty),"opening"===this[S])return this.defer((()=>this.clear(t,e))),e[b];if(_(this,e))return e[b];const r=t,n=this.keyEncoding(t.keyEncoding);return(t=w(t,n)).keyEncoding=n.format,0===t.limit?this.nextTick(e):this._clear(t,(t=>{if(t)return e(t);this.emit("clear",r),e()})),e[b]}_clear(t,e){this.nextTick(e)}iterator(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=w(t,e)).keys=!1!==t.keys,t.values=!1!==t.values,t[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[S])return new l(this,t);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(t)}_iterator(t){return new c(this,t)}keys(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=w(t,e))[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[S])return new f(this,t);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(t)}_keys(t){return new u(this,t)}values(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=w(t,e))[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[S])return new d(this,t);if("open"!==this[S])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(t)}_values(t){return new h(this,t)}defer(t){if("function"!=typeof t)throw new TypeError("The first argument must be a function");this[x].push(t)}[B](){if(0===this[x].length)return;const t=this[x];this[x]=[];for(const e of t)e()}attachResource(t){if("object"!=typeof t||null===t||"function"!=typeof t.close)throw new TypeError("The first argument must be a resource object");this[v].add(t)}detachResource(t){this[v].delete(t)}_chainedBatch(){return new y(this)}_checkKey(t){if(null==t)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(t){if(null==t)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}N.prototype.nextTick=r(909);const{AbstractSublevel:O}=r(650)({AbstractLevel:N});e.AbstractLevel=N,e.AbstractSublevel=O;const _=function(t,e){return"open"!==t[S]&&(t.nextTick(e,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},R=function(t){return Object.keys(t.supports.encodings).filter((e=>!!t.supports.encodings[e]))}},875:(t,e,r)=>{"use strict";e.AbstractLevel=r(71).AbstractLevel,e.AbstractSublevel=r(71).AbstractSublevel,e.AbstractIterator=r(961).AbstractIterator,e.AbstractKeyIterator=r(961).AbstractKeyIterator,e.AbstractValueIterator=r(961).AbstractValueIterator,e.AbstractChainedBatch=r(464).AbstractChainedBatch},970:(t,e,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:o}=r(961),s=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),u=Symbol("handleMany"),h=Symbol("callback");class l extends n{constructor(t,e,r,n){super(t,e),this[a]=r,this[s]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[h]=null}[c](t,e,r){const n=this[h];if(t)return n(t);void 0!==e&&(e=this[s](e)),n(t,e,r)}[u](t,e){const r=this[h];if(t)return r(t);for(const t of e){const e=t[0];void 0!==e&&(t[0]=this[s](e))}r(t,e)}}class f extends i{constructor(t,e,r,n){super(t,e),this[a]=r,this[s]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[h]=null}[c](t,e){const r=this[h];if(t)return r(t);void 0!==e&&(e=this[s](e)),r(t,e)}[u](t,e){const r=this[h];if(t)return r(t);for(let t=0;t<e.length;t++){const r=e[t];void 0!==r&&(e[t]=this[s](r))}r(t,e)}}class d extends o{constructor(t,e,r){super(t,e),this[a]=r}}for(const t of[l,f])t.prototype._next=function(t){this[h]=t,this[a].next(this[c])},t.prototype._nextv=function(t,e,r){this[h]=r,this[a].nextv(t,e,this[u])},t.prototype._all=function(t,e){this[h]=e,this[a].all(t,this[u])};for(const t of[d])t.prototype._next=function(t){this[a].next(t)},t.prototype._nextv=function(t,e,r){this[a].nextv(t,e,r)},t.prototype._all=function(t,e){this[a].all(t,e)};for(const t of[l,f,d])t.prototype._seek=function(t,e){this[a].seek(t,e)},t.prototype._close=function(t){this[a].close(t)};e.AbstractSublevelIterator=l,e.AbstractSublevelKeyIterator=f,e.AbstractSublevelValueIterator=d},650:(t,e,r)=>{"use strict";const n=r(473),{Buffer:i}=r(764)||{},{AbstractSublevelIterator:o,AbstractSublevelKeyIterator:s,AbstractSublevelValueIterator:a}=r(970),c=Symbol("prefix"),u=Symbol("upperBound"),h=Symbol("prefixRange"),l=Symbol("parent"),f=Symbol("unfix"),d=new TextEncoder,y={separator:"!"};t.exports=function({AbstractLevel:t}){class e extends t{static defaults(t){if("string"==typeof t)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(t&&t.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==t?y:t.separator?t:{...t,separator:"!"}}constructor(t,r,i){const{separator:o,manifest:s,...a}=e.defaults(i);r=m(r,o);const h=o.charCodeAt(0)+1,y=t[l]||t;if(!d.encode(r).every((t=>t>h&&t<127)))throw new n(`Prefix must use bytes > ${h} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(p(y,s),a);const g=(t.prefix||"")+o+r+o,v=g.slice(0,-1)+String.fromCharCode(h);this[l]=y,this[c]=new w(g),this[u]=new w(v),this[f]=new b,this.nextTick=y.nextTick}prefixKey(t,e){if("utf8"===e)return this[c].utf8+t;if(0===t.byteLength)return this[c][e];if("view"===e){const e=this[c].view,r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e,0),r.set(t,e.byteLength),r}{const e=this[c].buffer;return i.concat([e,t],e.byteLength+t.byteLength)}}[h](t,e){void 0!==t.gte?t.gte=this.prefixKey(t.gte,e):void 0!==t.gt?t.gt=this.prefixKey(t.gt,e):t.gte=this[c][e],void 0!==t.lte?t.lte=this.prefixKey(t.lte,e):void 0!==t.lt?t.lt=this.prefixKey(t.lt,e):t.lte=this[u][e]}get prefix(){return this[c].utf8}get db(){return this[l]}_open(t,e){this[l].open({passive:!0},e)}_put(t,e,r,n){this[l].put(t,e,r,n)}_get(t,e,r){this[l].get(t,e,r)}_getMany(t,e,r){this[l].getMany(t,e,r)}_del(t,e,r){this[l].del(t,e,r)}_batch(t,e,r){this[l].batch(t,e,r)}_clear(t,e){this[h](t,t.keyEncoding),this[l].clear(t,e)}_iterator(t){this[h](t,t.keyEncoding);const e=this[l].iterator(t),r=this[f].get(this[c].utf8.length,t.keyEncoding);return new o(this,t,e,r)}_keys(t){this[h](t,t.keyEncoding);const e=this[l].keys(t),r=this[f].get(this[c].utf8.length,t.keyEncoding);return new s(this,t,e,r)}_values(t){this[h](t,t.keyEncoding);const e=this[l].values(t);return new a(this,t,e)}}return{AbstractSublevel:e}};const p=function(t,e){return{...t.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:g(t,"utf8"),buffer:g(t,"buffer"),view:g(t,"view")}}},g=function(t,e){return!!t.supports.encodings[e]&&t.keyEncoding(e).name===e};class w{constructor(t){this.utf8=t,this.view=d.encode(t),this.buffer=i?i.from(this.view.buffer,0,this.view.byteLength):{}}}class b{constructor(){this.cache=new Map}get(t,e){let r=this.cache.get(e);return void 0===r&&(r="view"===e?function(t,e){return e.subarray(t)}.bind(null,t):function(t,e){return e.slice(t)}.bind(null,t),this.cache.set(e,r)),r}}const m=function(t,e){let r=0,n=t.length;for(;r<n&&t[r]===e;)r++;for(;n>r&&t[n-1]===e;)n--;return t.slice(r,n)}},520:(t,e)=>{"use strict";e.getCallback=function(t,e){return"function"==typeof t?t:e},e.getOptions=function(t,e){return"object"==typeof t&&null!==t?t:void 0!==e?e:{}}},765:(t,e,r)=>{"use strict";const{AbstractChainedBatch:n}=r(464),i=r(473),o=Symbol("encoded");e.DefaultChainedBatch=class extends n{constructor(t){super(t),this[o]=[]}_put(t,e,r){this[o].push({...r,type:"put",key:t,value:e})}_del(t,e){this[o].push({...e,type:"del",key:t})}_clear(){this[o]=[]}_write(t,e){"opening"===this.db.status?this.db.defer((()=>this._write(t,e))):"open"===this.db.status?0===this[o].length?this.nextTick(e):this.db._batch(this[o],t,e):this.nextTick(e,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},429:(t,e,r)=>{"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:i}=r(961),o=Symbol("iterator"),s=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class u extends n{constructor(t,e){super(t,e),this[o]=t.iterator({...e,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class h extends i{constructor(t,e){super(t,e),this[o]=t.iterator({...e,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const t of[u,h]){const e=t===u,r=e?t=>t[0]:t=>t[1];t.prototype._next=function(t){this[s]=t,this[o].next(this[a])},t.prototype[a]=function(t,r,n){const i=this[s];t?i(t):i(null,e?r:n)},t.prototype._nextv=function(t,e,r){this[s]=r,this[o].nextv(t,e,this[c])},t.prototype._all=function(t,e){this[s]=e,this[o].all(t,this[c])},t.prototype[c]=function(t,e){const n=this[s];t?n(t):n(null,e.map(r))},t.prototype._seek=function(t,e){this[o].seek(t,e)},t.prototype._close=function(t){this[o].close(t)}}e.DefaultKeyIterator=u,e.DefaultValueIterator=h},593:(t,e,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:o}=r(961),s=r(473),a=Symbol("nut"),c=Symbol("undefer"),u=Symbol("factory");class h extends n{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.iterator(e),this.db.defer((()=>this[c]()))}}class l extends i{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.keys(e),this.db.defer((()=>this[c]()))}}class f extends o{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.values(e),this.db.defer((()=>this[c]()))}}for(const t of[h,l,f])t.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[u]())},t.prototype._next=function(t){null!==this[a]?this[a].next(t):"opening"===this.db.status?this.db.defer((()=>this._next(t))):this.nextTick(t,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(t,e,r){null!==this[a]?this[a].nextv(t,e,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(t,e,r))):this.nextTick(r,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(t,e){null!==this[a]?this[a].all(e):"opening"===this.db.status?this.db.defer((()=>this._all(t,e))):this.nextTick(e,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(t,e){null!==this[a]?this[a]._seek(t,e):"opening"===this.db.status&&this.db.defer((()=>this._seek(t,e)))},t.prototype._close=function(t){null!==this[a]?this[a].close(t):"opening"===this.db.status?this.db.defer((()=>this._close(t))):this.nextTick(t)};e.DeferredIterator=h,e.DeferredKeyIterator=l,e.DeferredValueIterator=f},909:(t,e,r)=>{"use strict";const n=r(375);t.exports=function(t,...e){0===e.length?n(t):n((()=>t(...e)))}},56:(t,e,r)=>{"use strict";const n=r(473),i=Object.prototype.hasOwnProperty,o=new Set(["lt","lte","gt","gte"]);t.exports=function(t,e){const r={};for(const s in t)if(i.call(t,s)&&"keyEncoding"!==s&&"valueEncoding"!==s){if("start"===s||"end"===s)throw new n(`The legacy range option '${s}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===s)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});o.has(s)?r[s]=e.encode(t[s]):r[s]=t[s]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},742:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,o=a(t),s=o[0],c=o[1],u=new i(function(t,e,r){return 3*(e+r)/4-r}(0,s,c)),h=0,l=c>0?s-4:s;for(r=0;r<l;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e;return 2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[h++]=255&e),1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e),u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(c(t,a,a+s>u?u:a+s));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},708:(t,e,r)=>{"use strict";const{AbstractLevel:n}=r(875),i=r(473),o=r(967),{fromCallback:s}=r(957),{Iterator:a}=r(212),c=r(687),u=r(968),h=r(217),l="level-js-",f=Symbol("idb"),d=Symbol("namePrefix"),y=Symbol("location"),p=Symbol("version"),g=Symbol("store"),w=Symbol("onComplete"),b=Symbol("promise");class m extends n{constructor(t,e,r){if("function"==typeof e||"function"==typeof r)throw new i("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:o,...s}=e||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),"string"!=typeof t)throw new Error("constructor requires a location string argument");this[y]=t,this[d]=null==n?l:n,this[p]=parseInt(o||1,10),this[f]=null}get location(){return this[y]}get namePrefix(){return this[d]}get version(){return this[p]}get db(){return this[f]}get type(){return"browser-level"}_open(t,e){const r=indexedDB.open(this[d]+this[y],this[p]);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[f]=r.result,e()},r.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this[y])||e.createObjectStore(this[y])}}[g](t){return this[f].transaction([this[y]],t).objectStore(this[y])}[w](t,e){const r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}}_get(t,e,r){const n=this[g]("readonly");let o;try{o=n.get(t)}catch(t){return this.nextTick(r,t)}this[w](o,(function(t,e){return t?r(t):void 0===e?r(new i("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,c(e))}))}_getMany(t,e,r){const n=this[g]("readonly"),i=t.map((t=>e=>{let r;try{r=n.get(t)}catch(t){return e(t)}r.onsuccess=()=>{const t=r.result;e(null,void 0===t?t:c(t))},r.onerror=t=>{t.stopPropagation(),e(r.error)}}));o(i,16,r)}_del(t,e,r){const n=this[g]("readwrite");let i;try{i=n.delete(t)}catch(t){return this.nextTick(r,t)}this[w](i,r)}_put(t,e,r,n){const i=this[g]("readwrite");let o;try{o=i.put(e,t)}catch(t){return this.nextTick(n,t)}this[w](o,n)}_iterator(t){return new a(this,this[y],t)}_batch(t,e,r){const n=this[g]("readwrite"),i=n.transaction;let o,s=0;i.onabort=function(){r(o||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()},function e(){const r=t[s++],a=r.key;let c;try{c="del"===r.type?n.delete(a):n.put(r.value,a)}catch(t){return o=t,void i.abort()}s<t.length?c.onsuccess=e:"function"==typeof i.commit&&i.commit()}()}_clear(t,e){let r,n;try{r=h(t)}catch(t){return this.nextTick(e)}if(t.limit>=0)return u(this,this[y],r,t,e);try{const t=this[g]("readwrite");n=r?t.delete(r):t.clear()}catch(t){return this.nextTick(e,t)}this[w](n,e)}_close(t){this[f].close(),this.nextTick(t)}}m.destroy=function(t,e,r){"function"==typeof e&&(r=e,e=l),r=s(r,b);const n=indexedDB.deleteDatabase(e+t);return n.onsuccess=function(){r()},n.onerror=function(t){r(t)},r[b]},e.BrowserLevel=m},212:(t,e,r)=>{"use strict";const{AbstractIterator:n}=r(875),i=r(217),o=r(687),s=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),u=Symbol("currentOptions"),h=Symbol("position"),l=Symbol("location"),f=Symbol("first"),d={};function y(t){"function"==typeof t.commit&&t.commit()}e.Iterator=class extends n{constructor(t,e,r){super(t,r),this[s]=[],this[a]=0===this.limit,this[c]=r,this[u]={...r},this[h]=void 0,this[l]=e,this[f]=!0}_nextv(t,e,r){if(this[f]=!1,this[a])return this.nextTick(r,null,[]);if(this[s].length>0)return t=Math.min(t,this[s].length),this.nextTick(r,null,this[s].splice(0,t));let n;void 0!==this[h]&&(this[c].reverse?(this[u].lt=this[h],this[u].lte=void 0):(this[u].gt=this[h],this[u].gte=void 0));try{n=i(this[u])}catch(t){return this[a]=!0,this.nextTick(r,null,[])}const d=this.db.db.transaction([this[l]],"readonly"),p=d.objectStore(this[l]),g=[];if(this[c].reverse)p[!this[c].values&&p.openKeyCursor?"openKeyCursor":"openCursor"](n,"prev").onsuccess=e=>{const r=e.target.result;if(r){const{key:e,value:n}=r;this[h]=e,g.push([this[c].keys&&void 0!==e?o(e):void 0,this[c].values&&void 0!==n?o(n):void 0]),g.length<t?r.continue():y(d)}else this[a]=!0};else{let e,r;const i=()=>{if(void 0===e||void 0===r)return;const n=Math.max(e.length,r.length);0===n||t===1/0?this[a]=!0:this[h]=e[n-1],g.length=n;for(let t=0;t<n;t++){const n=e[t],i=r[t];g[t]=[this[c].keys&&void 0!==n?o(n):void 0,this[c].values&&void 0!==i?o(i):void 0]}y(d)};this[c].keys||t<1/0?p.getAllKeys(n,t<1/0?t:void 0).onsuccess=t=>{e=t.target.result,i()}:(e=[],this.nextTick(i)),this[c].values?p.getAll(n,t<1/0?t:void 0).onsuccess=t=>{r=t.target.result,i()}:(r=[],this.nextTick(i))}d.onabort=()=>{r(d.error||new Error("aborted by user")),r=null},d.oncomplete=()=>{r(null,g),r=null}}_next(t){if(this[s].length>0){const[e,r]=this[s].shift();this.nextTick(t,null,e,r)}else if(this[a])this.nextTick(t);else{let e=Math.min(100,this.limit-this.count);this[f]&&(this[f]=!1,e=1),this._nextv(e,d,((e,r)=>{if(e)return t(e);this[s]=r,this._next(t)}))}}_all(t,e){this[f]=!1;const r=this[s].splice(0,this[s].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(e,null,r);this._nextv(n,d,((t,n)=>{if(t)return e(t);r.length>0&&(n=r.concat(n)),e(null,n)}))}_seek(t,e){let r;this[f]=!0,this[s]=[],this[a]=!1,this[h]=void 0,this[u]={...this[c]};try{r=i(this[c])}catch(t){return void(this[a]=!0)}null===r||r.includes(t)?this[c].reverse?this[u].lte=t:this[u].gte=t:this[a]=!0}}},968:t=>{"use strict";t.exports=function(t,e,r,n,i){if(0===n.limit)return t.nextTick(i);const o=t.db.transaction([e],"readwrite"),s=o.objectStore(e);let a=0;o.oncomplete=function(){i()},o.onabort=function(){i(o.error||new Error("aborted by user"))};const c=s.openKeyCursor?"openKeyCursor":"openCursor",u=n.reverse?"prev":"next";s[c](r,u).onsuccess=function(t){const e=t.target.result;e&&(s.delete(e.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&e.continue()})}}},687:t=>{"use strict";const e=new TextEncoder;t.exports=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):e.encode(t)}},217:t=>{"use strict";t.exports=function(t){const e=void 0!==t.gte?t.gte:void 0!==t.gt?t.gt:void 0,r=void 0!==t.lte?t.lte:void 0!==t.lt?t.lt:void 0,n=void 0===t.gte,i=void 0===t.lte;return void 0!==e&&void 0!==r?IDBKeyRange.bound(e,r,n,i):void 0!==e?IDBKeyRange.lowerBound(e,n):void 0!==r?IDBKeyRange.upperBound(r,i):null}},764:(t,e,r)=>{"use strict";const n=r(742),i=r(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|p(t,e);let n=a(r);const i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(W(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(W(t,ArrayBuffer)||t&&W(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(W(t,SharedArrayBuffer)||t&&W(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);const i=function(t){if(c.isBuffer(t)){const e=0|y(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||Z(t.length)?a(0):f(t):"Buffer"===t.type&&Array.isArray(t.data)?f(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t){return h(t),a(t<0?0:0|y(t))}function f(t){const e=t.length<0?0:0|y(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function y(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function p(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||W(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(i)return n?-1:K(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return U(this,e,r);case"utf8":case"utf-8":return S(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return C(this,e,r);case"base64":return k(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function w(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){let o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(t,o+n)!==u(e,n)){r=!1;break}if(r)return o}return-1}function v(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(Z(n))return s;t[r+s]=n}return s}function E(t,e,r,n){return J(K(e,t.length-r),t,r,n)}function x(t,e,r,n){return J(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function B(t,e,r,n){return J(G(e),t,r,n)}function A(t,e,r,n){return J(function(t,e){let r,n,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function k(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function S(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(o=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=I));return r}(n)}e.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return h(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return l(t)},c.allocUnsafeSlow=function(t){return l(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),W(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=c.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(W(e,Uint8Array))i+e.length>n.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)w(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,i){if(W(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0);const a=Math.min(o,s),u=this.slice(n,i),h=t.slice(e,r);for(let t=0;t<a;++t)if(u[t]!==h[t]){o=u[t],s=h[t];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return x(this,t,e,r);case"base64":return B(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function C(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function U(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=Y[t[n]];return i}function L(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function N(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function _(t,e,r,n,i){F(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function R(t,e,r,n,i){F(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o>>=8,t[r+6]=o,o>>=8,t[r+5]=o,o>>=8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function D(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(t,e,r,n,o){return e=+e,r>>>=0,o||D(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function M(t,e,r,n,o){return e=+e,r>>>=0,o||D(t,0,r,8),i.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=Q((function(t){j(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Q((function(t){j(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);let n=e,i=1,o=this[t+--n];for(;n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=Q((function(t){j(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=Q((function(t){j(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||z(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);let i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);let i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=Q((function(t,e=0){return _(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Q((function(t,e=0){return R(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=Q((function(t,e=0){return _(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Q((function(t,e=0){return R(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,r){return V(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return V(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return M(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return M(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const o=c.isBuffer(t)?t:c.from(t,n),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%s]}return this};const P={};function H(t,e,r){P[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function $(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function F(t,e,r,n,i,o){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new P.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){j(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||z(e,t.length-(r+1))}(n,i,o)}function j(t,e){if("number"!=typeof t)throw new P.ERR_INVALID_ARG_TYPE(e,"number",t)}function z(t,e,r){if(Math.floor(t)!==t)throw j(t,r),new P.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new P.ERR_BUFFER_OUT_OF_BOUNDS;throw new P.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}H("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),H("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),H("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=$(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=$(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function K(t,e){let r;e=e||1/0;const n=t.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function J(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function W(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const Y=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Q(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}},957:(t,e,r)=>{"use strict";var n=r(886);e.fromCallback=function(t,e){if(void 0===t){var r=new Promise((function(e,r){t=function(t,n){t?r(t):e(n)}}));t[void 0!==e?e:"promise"]=r}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},e.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){n((()=>e(null,t)))})).catch((function(t){n((()=>e(t)))}))}},886:t=>{t.exports="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t)},729:t=>{"use strict";var e=Object.prototype.hasOwnProperty,r="~";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||t,s),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,i=[];if(0===this._eventsCount)return i;for(n in t=this._events)e.call(t,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,i,o,s){var a=r?r+t:t;if(!this._events[a])return!1;var c,u,h=this._events[a],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,i),!0;case 5:return h.fn.call(h.context,e,n,i,o),!0;case 6:return h.fn.call(h.context,e,n,i,o,s),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var f,d=h.length;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),l){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,n);break;case 4:h[u].fn.call(h[u].context,e,n,i);break;default:if(!c)for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];h[u].fn.apply(h[u].context,c)}}return!0},a.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,i){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,u=[],h=a.length;c<h;c++)(a[c].fn!==e||i&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&s(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a},187:t=>{"use strict";var e,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};e=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(r,n){function i(r){t.removeListener(e,o),n(r)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}p(t,e,o,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&p(t,"error",e,{once:!0})}(t,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,r,n){var i,o,s,u;if(a(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(t))>0&&s.length>i&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,u=h,console&&console.warn&&console.warn(u)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function f(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):y(i,i.length)}function d(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function y(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function p(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){n.once&&t.removeEventListener(e,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)n(c,this,e);else{var u=c.length,h=y(c,u);for(r=0;r<u;++r)n(h[r],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,l(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,l(this,t,e)),this},o.prototype.removeListener=function(t,e){var r,n,i,o,s;if(a(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},o.prototype.listeners=function(t){return f(this,t,!0)},o.prototype.rawListeners=function(t){return f(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},645:(t,e)=>{e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,h=-7,l=r?i-1:0,f=r?-1:1,d=t[e+l];for(l+=f,o=d&(1<<-h)-1,d>>=-h,h+=a;h>0;o=256*o+t[e+l],l+=f,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+l],l+=f,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=u}return(d?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,y=n?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+l>=1?f/c:f*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(e*c-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[r+d]=255&a,d+=y,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+d]=255&s,d+=y,s/=256,u-=8);t[r+d-y]|=128*p}},717:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},675:(t,e)=>{"use strict";e.supports=function(...t){const e=t.reduce(((t,e)=>Object.assign(t,e)),{});return Object.assign(e,{snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,getMany:e.getMany||!1,keyIterator:e.keyIterator||!1,valueIterator:e.valueIterator||!1,iteratorNextv:e.iteratorNextv||!1,iteratorAll:e.iteratorAll||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:Object.assign({},e.encodings),events:Object.assign({},e.events),additionalMethods:Object.assign({},e.additionalMethods)})}},499:(t,e,r)=>{"use strict";const n=r(473),i=r(2),{Encoding:o}=r(266),{BufferFormat:s,ViewFormat:a,UTF8Format:c}=r(376),u=Symbol("formats"),h=Symbol("encodings"),l=new Set(["buffer","view","utf8"]);e.Transcoder=class{constructor(t){if(!Array.isArray(t))throw new TypeError("The first argument 'formats' must be an array");if(!t.every((t=>l.has(t))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[h]=new Map,this[u]=new Set(t);for(const t in i)try{this.encoding(t)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[h].values()))}encoding(t){let e=this[h].get(t);if(void 0===e){if("string"==typeof t&&""!==t){if(e=d[t],!e)throw new n(`Encoding '${t}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof t||null===t)throw new TypeError("First argument 'encoding' must be a string or object");e=function(t){if(t instanceof o)return t;const e="type"in t&&"string"==typeof t.type?t.type:void 0,r=t.name||e||"anonymous-"+y++;switch(function(t){return"format"in t&&void 0!==t.format?t.format:"buffer"in t&&"boolean"==typeof t.buffer?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}(t)){case"view":return new a({...t,name:r});case"utf8":return new c({...t,name:r});case"buffer":return new s({...t,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(t)}const{name:r,format:i}=e;if(!this[u].has(i))if(this[u].has("view"))e=e.createViewTranscoder();else if(this[u].has("buffer"))e=e.createBufferTranscoder();else{if(!this[u].has("utf8"))throw new n(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});e=e.createUTF8Transcoder()}for(const n of[t,r,e.name,e.commonName])this[h].set(n,e)}return e}};const f={binary:i.buffer,"utf-8":i.utf8},d={...i,...f};let y=0},266:(t,e,r)=>{"use strict";const n=r(473),i=new Set(["buffer","view","utf8"]);e.Encoding=class{constructor(t){if(this.encode=t.encode||this.encode,this.decode=t.decode||this.decode,this.name=t.name||this.name,this.format=t.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!i.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");t.createViewTranscoder&&(this.createViewTranscoder=t.createViewTranscoder),t.createBufferTranscoder&&(this.createBufferTranscoder=t.createBufferTranscoder),t.createUTF8Transcoder&&(this.createUTF8Transcoder=t.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},2:(t,e,r)=>{"use strict";const{Buffer:n}=r(764)||{Buffer:{isBuffer:()=>!1}},{textEncoder:i,textDecoder:o}=r(850)(),{BufferFormat:s,ViewFormat:a,UTF8Format:c}=r(376),u=t=>t;e.utf8=new c({encode:function(t){return n.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?o.decode(t):String(t)},decode:u,name:"utf8",createViewTranscoder(){return new a({encode:function(t){return ArrayBuffer.isView(t)?t:i.encode(t)},decode:function(t){return o.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}}),e.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),e.buffer=new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:u,name:"buffer",createViewTranscoder(){return new a({encode:function(t){return ArrayBuffer.isView(t)?t:n.from(String(t),"utf8")},decode:function(t){return n.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}}),e.view=new a({encode:function(t){return ArrayBuffer.isView(t)?t:i.encode(t)},decode:u,name:"view",createBufferTranscoder(){return new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:u,name:`${this.name}+buffer`})}}),e.hex=new s({encode:function(t){return n.isBuffer(t)?t:n.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"}),e.base64=new s({encode:function(t){return n.isBuffer(t)?t:n.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"})},376:(t,e,r)=>{"use strict";const{Buffer:n}=r(764)||{},{Encoding:i}=r(266),o=r(850);class s extends i{constructor(t){super({...t,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:t=>this.decode(n.from(t.buffer,t.byteOffset,t.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends i{constructor(t){super({...t,format:"view"})}createBufferTranscoder(){return new s({encode:t=>{const e=this.encode(t);return n.from(e.buffer,e.byteOffset,e.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}e.BufferFormat=s,e.ViewFormat=a,e.UTF8Format=class extends i{constructor(t){super({...t,format:"utf8"})}createBufferTranscoder(){return new s({encode:t=>n.from(this.encode(t),"utf8"),decode:t=>this.decode(t.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:t,textDecoder:e}=o();return new a({encode:e=>t.encode(this.encode(e)),decode:t=>this.decode(e.decode(t)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},850:t=>{"use strict";let e=null;t.exports=function(){return null===e&&(e={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),e}},301:(t,e,r)=>{e.Level=r(708).BrowserLevel},117:(t,e,r)=>{var n=r(187),i=r(717);function o(t){if(!(this instanceof o))return new o(t);"number"==typeof t&&(t={max:t}),t||(t={}),n.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=t.max||1e3,this.maxAge=t.maxAge||0}t.exports=o,i(o,n.EventEmitter),Object.defineProperty(o.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),o.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},o.prototype.remove=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];return delete this.cache[t],this._unlink(t,e.prev,e.next),e.value}},o.prototype._unlink=function(t,e,r){this.length--,0===this.length?this.head=this.tail=null:this.head===t?(this.head=e,this.cache[this.head].next=null):this.tail===t?(this.tail=r,this.cache[this.tail].prev=null):(this.cache[e].next=r,this.cache[r].prev=e)},o.prototype.peek=function(t){if(this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return e.value}},o.prototype.set=function(t,e){var r;if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){if((r=this.cache[t]).value=e,this.maxAge&&(r.modified=Date.now()),t===this.head)return e;this._unlink(t,r.prev,r.next)}else r={value:e,modified:0,next:null,prev:null},this.maxAge&&(r.modified=Date.now()),this.cache[t]=r,this.length===this.max&&this.evict();return this.length++,r.next=null,r.prev=this.head,this.head&&(this.cache[this.head].next=t),this.head=t,this.tail||(this.tail=t),e},o.prototype._checkAge=function(t,e){return!(this.maxAge&&Date.now()-e.modified>this.maxAge&&(this.remove(t),this.emit("evict",{key:t,value:e.value}),1))},o.prototype.get=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return this.head!==t&&(t===this.tail?(this.tail=e.next,this.cache[this.tail].prev=null):this.cache[e.prev].next=e.next,this.cache[e.next].prev=e.prev,this.cache[this.head].next=t,e.prev=this.head,e.next=null,this.head=t),e.value}},o.prototype.evict=function(){if(this.tail){var t=this.tail,e=this.remove(this.tail);this.emit("evict",{key:t,value:e})}}},473:t=>{"use strict";t.exports=class extends Error{constructor(t,e){super(t||""),"object"==typeof e&&null!==e&&(e.code&&(this.code=String(e.code)),e.expected&&(this.expected=!0),e.transient&&(this.transient=!0),e.cause&&(this.cause=e.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},43:(t,e)=>{"use strict";class r{static isArrayBuffer(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e)return t;if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const n=r.toUint8Array(t),i=r.toUint8Array(e);if(n.length!==i.byteLength)return!1;for(let t=0;t<n.length;t++)if(n[t]!==i[t])return!1;return!0}static concat(...t){let e;e=!Array.isArray(t[0])||t[1]instanceof Function?Array.isArray(t[0])&&t[1]instanceof Function?t[0]:t[t.length-1]instanceof Function?t.slice(0,t.length-1):t:t[0];let r=0;for(const t of e)r+=t.byteLength;const n=new Uint8Array(r);let i=0;for(const t of e){const e=this.toUint8Array(t);n.set(e,i),i+=e.length}return t[t.length-1]instanceof Function?this.toView(n,t[t.length-1]):n.buffer}}const n="string",i=/^[0-9a-f]+$/i,o=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,s=/^[a-zA-Z0-9-_]+$/;class a{static fromString(t){const e=unescape(encodeURIComponent(t)),r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r.buffer}static toString(t){const e=r.toUint8Array(t);let n="";for(let t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return decodeURIComponent(escape(n))}}class c{static toString(t,e=!1){const n=r.toArrayBuffer(t),i=new DataView(n);let o="";for(let t=0;t<n.byteLength;t+=2){const r=i.getUint16(t,e);o+=String.fromCharCode(r)}return o}static fromString(t,e=!1){const r=new ArrayBuffer(2*t.length),n=new DataView(r);for(let r=0;r<t.length;r++)n.setUint16(2*r,t.charCodeAt(r),e);return r}}class u{static isHex(t){return typeof t===n&&i.test(t)}static isBase64(t){return typeof t===n&&o.test(t)}static isBase64Url(t){return typeof t===n&&s.test(t)}static ToString(t,e="utf8"){const n=r.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return c.toString(n,!0);case"utf16":case"utf16be":return c.toString(n);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return c.fromString(t,!0);case"utf16":case"utf16be":return c.fromString(t);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToBase64(t){const e=r.toUint8Array(t);if("undefined"!=typeof btoa){const t=this.ToString(e,"binary");return btoa(t)}return Buffer.from(e).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!u.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(e)):new Uint8Array(Buffer.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!u.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=u.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return a.fromString(t);case"utf16":case"utf16be":return c.fromString(t);case"utf16le":case"usc2":return c.fromString(t,!0);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToUtf8String(t,e=u.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return a.toString(t);case"utf16":case"utf16be":return c.toString(t);case"utf16le":case"usc2":return c.toString(t,!0);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromBinary(t){const e=t.length,r=new Uint8Array(e);for(let n=0;n<e;n++)r[n]=t.charCodeAt(n);return r.buffer}static ToBinary(t){const e=r.toUint8Array(t);let n="";for(let t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}static ToHex(t){const e=r.toUint8Array(t);let n="";const i=e.length;for(let t=0;t<i;t++){const r=e[t];r<16&&(n+="0"),n+=r.toString(16)}return n}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!u.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e=`0${e}`);const r=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2){const n=e.slice(t,t+2);r[t/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(t,e=!1){return c.toString(t,e)}static FromUtf16String(t,e=!1){return c.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let r=0;r<e;r++)t+="=";return t}static formatString(t){return(null==t?void 0:t.replace(/[\n\r\t ]/g,""))||""}}u.DEFAULT_UTF8_ENCODING="utf8",e.vJ=r,e.ep=u},375:(t,e,r)=>{let n;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):t=>(n||(n=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)))},916:(t,e,r)=>{"use strict";const n=r(807);class i{constructor(t,e,r){const i=this;this._started=n(),this._rescheduled=0,this._scheduled=e,this._args=r,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(n()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,t.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,e)}reschedule(t){t||(t=this._scheduled);const e=n();e+t-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(t)):this._triggered?this._schedule(t):(this._started=e,this._rescheduled=t)}_schedule(t){this._triggered=!1,this._started=n(),this._rescheduled=0,this._scheduled=t,this._timer=setTimeout(this._timerWrapper,t)}clear(){clearTimeout(this._timer)}}t.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new i(arguments[0],arguments[1],t)}},807:t=>{"use strict";t.exports=function(){return Date.now()}},967:(t,e,r)=>{t.exports=function(t,e,r){if("number"!=typeof e)throw new Error("second argument must be a Number");let i,o,s,a,c,u,h=!0;function l(t){function e(){r&&r(t,i),r=null}h?n(e):e()}function f(e,r,n){if(i[e]=n,r&&(c=!0),0==--s||r)l(r);else if(!c&&u<o){let e;a?(e=a[u],u+=1,t[e]((function(t,r){f(e,t,r)}))):(e=u,u+=1,t[e]((function(t,r){f(e,t,r)})))}}Array.isArray(t)?(i=[],s=o=t.length):(a=Object.keys(t),i={},s=o=a.length),u=e,s?a?a.some((function(r,n){return t[r]((function(t,e){f(r,t,e)})),n===e-1})):t.some((function(t,r){return t((function(t,e){f(r,t,e)})),r===e-1})):l(null),h=!1};const n=r(375)},715:(t,e,r)=>{"use strict";const{AbortController:n}=globalThis,i=r(916);class o extends n{constructor(t){super(),this._ms=t,this._timer=i((()=>this.abort()),t),Object.setPrototypeOf(this,o.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=i((()=>this.abort()),this._ms)}}t.exports={TimeoutController:o}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{ComposedStorage:()=>kn,Database:()=>Nn,DefaultAccessController:()=>Bn,Documents:()=>Dn,Entry:()=>fn,Events:()=>Pn,IPFSAccessController:()=>xf,IPFSBlockStorage:()=>Sn,Identities:()=>uf,KeyStore:()=>Jl,KeyValue:()=>Fn,KeyValueIndexed:()=>qn,LRUStorage:()=>Un,LevelStorage:()=>Tn,Log:()=>An,MemoryStorage:()=>dn,OrbitDBAccessController:()=>kf,PublicKeyIdentityProvider:()=>nf,createOrbitDB:()=>Cf,isIdentity:()=>tf,isValidAddress:()=>hf,parseAddress:()=>lf,useAccessController:()=>If,useDatabaseType:()=>Gn,useIdentityProvider:()=>af});var t={};r.r(t),r.d(t,{code:()=>en,decode:()=>nn,decodeOptions:()=>Xr,encode:()=>rn,encodeOptions:()=>Yr,name:()=>tn,toByteView:()=>Wr});var e={};r.r(e),r.d(e,{gk:()=>wo,dQ:()=>Uo,ci:()=>mo,bytesToNumberBE:()=>Ao,ty:()=>ko,eV:()=>Co,n$:()=>Oo,ql:()=>To,hexToBytes:()=>Bo,_t:()=>go,tL:()=>So,S5:()=>Io,FF:()=>Ro});var i={};r.r(i),r.d(i,{base10:()=>la});var o={};r.r(o),r.d(o,{base16:()=>fa,base16upper:()=>da});var s={};r.r(s),r.d(s,{base2:()=>ya});var a={};r.r(a),r.d(a,{base256emoji:()=>ba});var c={};r.r(c),r.d(c,{base32:()=>ma,base32hex:()=>Ba,base32hexpad:()=>ka,base32hexpadupper:()=>Sa,base32hexupper:()=>Aa,base32pad:()=>Ea,base32padupper:()=>xa,base32upper:()=>va,base32z:()=>Ia});var u={};r.r(u),r.d(u,{base36:()=>Ta,base36upper:()=>Ca});var h={};r.r(h),r.d(h,{base58btc:()=>Ua,base58flickr:()=>La});var l={};r.r(l),r.d(l,{base64:()=>Na,base64pad:()=>Oa,base64url:()=>_a,base64urlpad:()=>Ra});var f={};r.r(f),r.d(f,{base8:()=>Da});var d={};r.r(d),r.d(d,{identity:()=>Va});var y={};r.r(y),r.d(y,{code:()=>$a,decode:()=>ja,encode:()=>Fa,name:()=>Ha});var p={};r.r(p),r.d(p,{code:()=>qa,decode:()=>Ga,encode:()=>Ka,name:()=>za});var g={};r.r(g),r.d(g,{identity:()=>yc});var w={};r.r(w),r.d(w,{sha256:()=>bc,sha512:()=>mc});var b=r(187),m=r(729);class v extends Error{constructor(t){super(t),this.name="TimeoutError"}}class E extends Error{constructor(t){super(),this.name="AbortError",this.message=t}}const x=t=>void 0===globalThis.DOMException?new E(t):new DOMException(t),B=t=>{const e=void 0===t.reason?x("This operation was aborted."):t.reason;return e instanceof Error?e:x(e)};class A{#t=[];enqueue(t,e){const r={priority:(e={priority:0,...e}).priority,run:t};if(this.size&&this.#t[this.size-1].priority>=e.priority)return void this.#t.push(r);const n=function(t,e,r){let n=0,i=t.length;for(;i>0;){const r=Math.trunc(i/2);let s=n+r;o=t[s],e.priority-o.priority<=0?(n=++s,i-=r+1):i=r}var o;return n}(this.#t,r);this.#t.splice(n,0,r)}dequeue(){const t=this.#t.shift();return t?.run}filter(t){return this.#t.filter((e=>e.priority===t.priority)).map((t=>t.run))}get size(){return this.#t.length}}class k extends m{#e;#r;#n=0;#i;#o;#s=0;#a;#c;#t;#u;#h=0;#l;#f;#d;timeout;constructor(t){if(super(),!("number"==typeof(t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:A,...t}).intervalCap&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(void 0===t.interval||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);this.#e=t.carryoverConcurrencyCount,this.#r=t.intervalCap===Number.POSITIVE_INFINITY||0===t.interval,this.#i=t.intervalCap,this.#o=t.interval,this.#t=new t.queueClass,this.#u=t.queueClass,this.concurrency=t.concurrency,this.timeout=t.timeout,this.#d=!0===t.throwOnTimeout,this.#f=!1===t.autoStart}get#y(){return this.#r||this.#n<this.#i}get#p(){return this.#h<this.#l}#g(){this.#h--,this.#w(),this.emit("next")}#b(){this.#m(),this.#v(),this.#c=void 0}get#E(){const t=Date.now();if(void 0===this.#a){const e=this.#s-t;if(!(e<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#b()}),e)),!0;this.#n=this.#e?this.#h:0}return!1}#w(){if(0===this.#t.size)return this.#a&&clearInterval(this.#a),this.#a=void 0,this.emit("empty"),0===this.#h&&this.emit("idle"),!1;if(!this.#f){const t=!this.#E;if(this.#y&&this.#p){const e=this.#t.dequeue();return!!e&&(this.emit("active"),e(),t&&this.#v(),!0)}}return!1}#v(){this.#r||void 0!==this.#a||(this.#a=setInterval((()=>{this.#m()}),this.#o),this.#s=Date.now()+this.#o)}#m(){0===this.#n&&0===this.#h&&this.#a&&(clearInterval(this.#a),this.#a=void 0),this.#n=this.#e?this.#h:0,this.#x()}#x(){for(;this.#w(););}get concurrency(){return this.#l}set concurrency(t){if(!("number"==typeof t&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#l=t,this.#x()}async#B(t){return new Promise(((e,r)=>{t.addEventListener("abort",(()=>{r(t.reason)}),{once:!0})}))}async add(t,e={}){return e={timeout:this.timeout,throwOnTimeout:this.#d,...e},new Promise(((r,n)=>{this.#t.enqueue((async()=>{this.#h++,this.#n++;try{e.signal?.throwIfAborted();let n=t({signal:e.signal});e.timeout&&(n=function(t,e){const{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e;let s;const a=new Promise(((a,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(e.signal){const{signal:t}=e;t.aborted&&c(B(t)),t.addEventListener("abort",(()=>{c(B(t))}))}if(r===Number.POSITIVE_INFINITY)return void t.then(a,c);const u=new v;s=o.setTimeout.call(void 0,(()=>{if(n)try{a(n())}catch(t){c(t)}else"function"==typeof t.cancel&&t.cancel(),!1===i?a():i instanceof Error?c(i):(u.message=i??`Promise timed out after ${r} milliseconds`,c(u))}),r),(async()=>{try{a(await t)}catch(t){c(t)}})()})).finally((()=>{a.clear()}));return a.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},a}(Promise.resolve(n),{milliseconds:e.timeout})),e.signal&&(n=Promise.race([n,this.#B(e.signal)]));const i=await n;r(i),this.emit("completed",i)}catch(t){if(t instanceof v&&!e.throwOnTimeout)return void r();n(t),this.emit("error",t)}finally{this.#g()}}),e),this.emit("add"),this.#w()}))}async addAll(t,e){return Promise.all(t.map((async t=>this.add(t,e))))}start(){return this.#f?(this.#f=!1,this.#x(),this):this}pause(){this.#f=!0}clear(){this.#t=new this.#u}async onEmpty(){0!==this.#t.size&&await this.#A("empty")}async onSizeLessThan(t){this.#t.size<t||await this.#A("next",(()=>this.#t.size<t))}async onIdle(){0===this.#h&&0===this.#t.size||await this.#A("idle")}async#A(t,e){return new Promise((r=>{const n=()=>{e&&!e()||(this.off(t,n),r())};this.on(t,n)}))}get size(){return this.#t.size}sizeBy(t){return this.#t.filter(t).length}get pending(){return this.#h}get isPaused(){return this.#f}}function S(){const t={};return t.promise=new Promise(((e,r)=>{t.resolve=e,t.reject=r})),t}class I{buffer;mask;top;btm;next;constructor(t){if(!(t>0)||0!=(t-1&t))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){const t=this.buffer[this.btm];if(void 0!==t)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return void 0===this.buffer[this.btm]}}class T{size;hwm;head;tail;constructor(t={}){this.hwm=t.splitLimit??16,this.head=new I(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return null!=t?.byteLength?t.byteLength:1}push(t){if(null!=t?.value&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){const e=this.head;this.head=e.next=new I(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=t?.value&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class C extends Error{type;code;constructor(t,e){super(t??"The operation was aborted"),this.type="aborted",this.code=e??"ABORT_ERR"}}function U(t={}){return function(t,e){let r,n,i,o=(e=e??{}).onEnd,s=new T,a=S();const c=t=>null!=n?n(t):(s.push(t),r),u=t=>{if(i)return r;if(!0!==e?.objectMode&&null==t?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:t})},h=t=>i?r:(i=!0,null!=t?(t=>(s=new T,null!=n?n({error:t}):(s.push({error:t}),r)))(t):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return s.isEmpty()?i?{done:!0}:await new Promise(((e,i)=>{n=o=>{n=null,s.push(o);try{e(t(s))}catch(t){i(t)}return r}})):t(s)}finally{s.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=S()}))}},return:()=>(s=new T,h(),{done:!0}),throw:t=>(h(t),{done:!0}),push:u,end:h,get readableLength(){return s.size},onEmpty:async t=>{const e=t?.signal;if(e?.throwIfAborted(),s.isEmpty())return;let r,n;null!=e&&(r=new Promise(((t,r)=>{n=()=>{r(new C)},e.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=e&&e?.removeEventListener("abort",n)}}},null==o)return r;const l=r;return r={[Symbol.asyncIterator](){return this},next:()=>l.next(),throw:t=>(l.throw(t),null!=o&&(o(t),o=void 0),{done:!0}),return:()=>(l.return(),null!=o&&(o(),o=void 0),{done:!0}),push:u,end:t=>(l.end(t),null!=o&&(o(t),o=void 0),r),get readableLength(){return l.readableLength},onEmpty:t=>l.onEmpty(t)},r}((t=>{const e=t.shift();if(null==e)return{done:!0};if(null!=e.error)throw e.error;return{done:!0===e.done,value:e.value}}),t)}function L(t,...e){if(null==t)throw new Error("Empty pipeline");if(R(t)){const e=t;t=()=>e.source}else if(_(t)||O(t)){const e=t;t=()=>e}const r=[t,...e];if(r.length>1&&R(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let t=1;t<r.length-1;t++)R(r[t])&&(r[t]=D(r[t]));return N(...r)}const N=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},O=t=>null!=t?.[Symbol.asyncIterator],_=t=>null!=t?.[Symbol.iterator],R=t=>null!=t&&null!=t.sink&&null!=t.source,D=t=>e=>{const r=t.sink(e);if(null!=r?.then){const e=U({objectMode:!0});let n;r.then((()=>{e.end()}),(t=>{e.end(t)}));const i=t.source;if(O(i))n=async function*(){yield*i,e.end()};else{if(!_(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");n=function*(){yield*i,e.end()}}return function(...t){const e=[];for(const r of t)null==r[Symbol.asyncIterator]&&e.push(r);return e.length===t.length?function*(){for(const t of e)yield*t}():async function*(){const e=U({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const r of t)e.push(r)}))),e.end()}catch(t){e.end(t)}})),yield*e}()}(e,n())}return t.source};var V=r(715);const M=(...t)=>t.join("/").replace(/((?<=\/)\/+)|(^\.\/)|((?<=\/)\.\/)/g,"")||".",P=M;var H=r(117);const $=(t,e)=>({id:t,time:e=e||0}),F=(new Uint8Array(0),t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")});const j=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var l=0,f=o-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*s[f]>>>0,s[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=e[i],f=0,d=s-1;(0!==l||f<n)&&-1!==d;d--,f++)l+=256*u[d]>>>0,u[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:l,decode:function(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class z{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class q{constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return G(this,t)}}class K{constructor(t){this.decoders=t}or(t){return G(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const G=(t,e)=>new K({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class J{constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new z(t,e,r),this.decoder=new q(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const W=({name:t,prefix:e,encode:r,decode:n})=>new J(t,e,r,n),Z=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=j(r,e);return W({prefix:t,name:e,encode:n,decode:t=>F(i(t))})},Y=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>W({prefix:e,name:t,encode:t=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(t,n,r),decode:e=>((t,e,r,n)=>{const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,n,r,t)}),Q=Y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X=(Y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Z({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));Z({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tt=128,et=-128,rt=Math.pow(2,31),nt=128,it=127,ot=Math.pow(2,7),st=Math.pow(2,14),at=Math.pow(2,21),ct=Math.pow(2,28),ut=Math.pow(2,35),ht=Math.pow(2,42),lt=Math.pow(2,49),ft=Math.pow(2,56),dt=Math.pow(2,63);const yt={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=rt;)r[n++]=255&e|tt,e/=128;for(;e&et;)r[n++]=255&e|tt,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&it)<<o:(n&it)*Math.pow(2,o),o+=7}while(n>=nt);return t.bytes=s-r,i},encodingLength:function(t){return t<ot?1:t<st?2:t<at?3:t<ct?4:t<ut?5:t<ht?6:t<lt?7:t<ft?8:t<dt?9:10}},pt=(t,e=0)=>[yt.decode(t,e),yt.decode.bytes],gt=(t,e,r=0)=>(yt.encode(t,e,r),e),wt=t=>yt.encodingLength(t),bt=(t,e)=>{const r=e.byteLength,n=wt(t),i=n+wt(r),o=new Uint8Array(i+r);return gt(t,o,0),gt(r,o,n),o.set(e,i),new mt(t,r,e,o)};class mt{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const vt=(t,e)=>{const{bytes:r,version:n}=t;return 0===n?kt(r,xt(t),e||X.encoder):St(r,xt(t),e||Q.encoder)},Et=new WeakMap,xt=t=>{const e=Et.get(t);if(null==e){const e=new Map;return Et.set(t,e),e}return e};class Bt{constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==It)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Tt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Bt.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=bt(t,e);return Bt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return Bt.equals(this,t)}static equals(t,e){const r=e;return r&&t.code===r.code&&t.version===r.version&&((t,e)=>{if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&((t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0})(t.bytes,r.bytes)}})(t.multihash,r.multihash)}toString(t){return vt(this,t)}toJSON(){return{"/":vt(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof Bt)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new Bt(t,r,n,i||Ct(t,r,n.bytes))}if(!0===e[Ut]){const{version:t,multihash:r,code:n}=e,i=(t=>{const e=F(t),[r,n]=pt(e),[i,o]=pt(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new mt(r,i,s,e)})(r);return Bt.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==It)throw new Error(`Version 0 CID must use dag-pb (code: ${It}) block encoding`);return new Bt(t,e,r,r.bytes);case 1:{const n=Ct(t,e,r.bytes);return new Bt(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return Bt.create(0,It,t)}static createV1(t,e){return Bt.create(1,t,e)}static decode(t){const[e,r]=Bt.decodeFirst(t);if(r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=Bt.inspectBytes(t),r=e.size-e.multihashSize,n=F(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new mt(e.multihashCode,e.digestSize,i,n);return[0===e.version?Bt.createV0(o):Bt.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=pt(t.subarray(e));return e+=n,r};let n=r(),i=It;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=At(t,e),i=Bt.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return xt(i).set(r,t),i}}const At=(t,e)=>{switch(t[0]){case"Q":{const r=e||X;return[X.prefix,r.decode(`${X.prefix}${t}`)]}case X.prefix:{const r=e||X;return[X.prefix,r.decode(t)]}case Q.prefix:{const r=e||Q;return[Q.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}},kt=(t,e,r)=>{const{prefix:n}=r;if(n!==X.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i},St=(t,e,r)=>{const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i},It=112,Tt=18,Ct=(t,e,r)=>{const n=wt(t),i=n+wt(e),o=new Uint8Array(i+r.byteLength);return gt(t,o,0),gt(e,o,n),o.set(r,i),o},Ut=Symbol.for("@ipld/js-cid/CID"),Lt=({name:t,code:e,encode:r})=>new Nt(t,e,r);class Nt{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?bt(this.code,e):e.then((t=>bt(this.code,t)))}throw Error("Unknown type, must be binary type")}}function Ot({enumerable:t=!0,configurable:e=!1}={}){return{enumerable:t,configurable:e,writable:!1}}function*_t(t,e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r],i=Bt.asCID(n);i?yield[e.join("/"),i]:"object"==typeof n&&(yield*Rt(n,e))}else{const r=Bt.asCID(e);r?yield[t.join("/"),r]:yield*Rt(e,t)}}function*Rt(t,e){if(null==t||t instanceof Uint8Array)return;const r=Bt.asCID(t);r&&(yield[e.join("/"),r]);for(const[r,n]of Object.entries(t)){const t=[...e,r];yield*_t(t,n)}}function*Dt(t,e){if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r];yield e.join("/"),"object"!=typeof n||Bt.asCID(n)||(yield*Vt(n,e))}else yield*Vt(e,t)}function*Vt(t,e){if(null!=t&&"object"==typeof t)for(const[r,n]of Object.entries(t)){const t=[...e,r];yield t.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||Bt.asCID(n)||(yield*Dt(t,n))}}class Mt{constructor({cid:t,bytes:e,value:r}){if(!t||!e||void 0===r)throw new Error("Missing required argument");this.cid=t,this.bytes=e,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Ot(),bytes:Ot(),value:Ot(),asBlock:Ot()})}links(){return Rt(this.value,[])}tree(){return Vt(this.value,[])}get(t="/"){return function(t,e){let r=t;for(const[t,n]of e.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${e.slice(0,t+1).map((t=>`[${JSON.stringify(t)}]`)).join("")}`);const i=Bt.asCID(r);if(i)return{value:i,remaining:e.slice(t+1).join("/")}}return{value:r}}(this.value,t.split("/").filter(Boolean))}}async function Pt({value:t,codec:e,hasher:r}){if(void 0===t)throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");const n=e.encode(t),i=await r.digest(n),o=Bt.create(1,e.code,i);return new Mt({value:t,bytes:n,cid:o})}async function Ht({bytes:t,codec:e,hasher:r}){if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");const n=e.decode(t),i=await r.digest(t),o=Bt.create(1,e.code,i);return new Mt({value:n,bytes:t,cid:o})}const $t=["string","number","bigint","symbol"],Ft=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class jt{constructor(t,e,r){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}jt.uint=new jt(0,"uint",!0),jt.negint=new jt(1,"negint",!0),jt.bytes=new jt(2,"bytes",!0),jt.string=new jt(3,"string",!0),jt.array=new jt(4,"array",!1),jt.map=new jt(5,"map",!1),jt.tag=new jt(6,"tag",!1),jt.float=new jt(7,"float",!0),jt.false=new jt(7,"false",!0),jt.true=new jt(7,"true",!0),jt.null=new jt(7,"null",!0),jt.undefined=new jt(7,"undefined",!0),jt.break=new jt(7,"break",!0);class zt{constructor(t,e,r){this.type=t,this.value=e,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const qt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,Kt=new TextDecoder,Gt=new TextEncoder;function Jt(t){return qt&&globalThis.Buffer.isBuffer(t)}function Wt(t){return t instanceof Uint8Array?Jt(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const Zt=qt?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):ne(t,e,r):(t,e,r)=>r-e>64?Kt.decode(t.subarray(e,r)):ne(t,e,r),Yt=qt?t=>t.length>64?globalThis.Buffer.from(t):re(t):t=>t.length>64?Gt.encode(t):re(t),Qt=t=>Uint8Array.from(t),Xt=qt?(t,e,r)=>Jt(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),te=qt?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),Wt(globalThis.Buffer.concat(t,e))):(t,e)=>{const r=new Uint8Array(e);let n=0;for(let e of t)n+e.length>r.length&&(e=e.subarray(0,r.length-n)),r.set(e,n),n+=e.length;return r},ee=qt?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function re(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=63&i|128):55296==(64512&i)&&n+1<t.length&&56320==(64512&t.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++n)),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=63&i|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=63&i|128)}return e}function ne(t,e,r){const n=[];for(;e<r;){const i=t[e];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=r){let r,n,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:r=t[e+1],128==(192&r)&&(c=(31&i)<<6|63&r,c>127&&(o=c));break;case 3:r=t[e+1],n=t[e+2],128==(192&r)&&128==(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[e+1],n=t[e+2],a=t[e+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),e+=s}return function(t){const e=t.length;if(e<=ie)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ie));return r}(n)}const ie=4096;class oe{constructor(t=256){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const r=e.length-(this.maxCursor-this.cursor)-1;e.set(t,r)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=ee(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let e;if(1===this.chunks.length){const r=this.chunks[0];t&&this.cursor>r.length/2?(e=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=Xt(r,0,this.cursor)}else e=te(this.chunks,this.cursor);return t&&this.reset(),e}}const se="CBOR decode error:",ae="CBOR encode error:",ce=[];function ue(t,e,r){if(t.length-e<r)throw new Error(`${se} not enough data for type`)}ce[23]=1,ce[24]=2,ce[25]=3,ce[26]=5,ce[27]=9;const he=[24,256,65536,4294967296,BigInt("18446744073709551616")];function le(t,e,r){ue(t,e,1);const n=t[e];if(!0===r.strict&&n<he[0])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function fe(t,e,r){ue(t,e,2);const n=t[e]<<8|t[e+1];if(!0===r.strict&&n<he[1])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function de(t,e,r){ue(t,e,4);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===r.strict&&n<he[2])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function ye(t,e,r){ue(t,e,8);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&o<he[3])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===r.allowBigInt)return o;throw new Error(`${se} integers outside of the safe integer range are not supported`)}function pe(t,e){return ge(t,0,e.value)}function ge(t,e,r){if(r<he[0]){const n=Number(r);t.push([e|n])}else if(r<he[1]){const n=Number(r);t.push([24|e,n])}else if(r<he[2]){const n=Number(r);t.push([25|e,n>>>8,255&n])}else if(r<he[3]){const n=Number(r);t.push([26|e,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<he[4]))throw new Error(`${se} encountered BigInt larger than allowable range`);{const r=[27|e,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&o,o>>=8,r[3]=255&o,o>>=8,r[2]=255&o,o>>=8,r[1]=255&o,t.push(r)}}}pe.encodedSize=function(t){return ge.encodedSize(t.value)},ge.encodedSize=function(t){return t<he[0]?1:t<he[1]?2:t<he[2]?3:t<he[3]?5:9},pe.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const we=BigInt(-1),be=BigInt(1);function me(t,e){const r=e.value,n="bigint"==typeof r?r*we-be:-1*r-1;ge(t,e.type.majorEncoded,n)}function ve(t,e,r,n){ue(t,e,r+n);const i=Xt(t,e+r,e+r+n);return new zt(jt.bytes,i,r+n)}function Ee(t,e,r,n){return ve(t,e,1,r)}function xe(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===jt.string?Yt(t.value):t.value),t.encodedBytes}function Be(t,e){const r=xe(e);ge(t,e.type.majorEncoded,r.length),t.push(r)}function Ae(t,e,r,n,i){const o=r+n;ue(t,e,o);const s=new zt(jt.string,Zt(t,e+r,e+o),o);return!0===i.retainStringBytes&&(s.byteValue=Xt(t,e+r,e+o)),s}function ke(t,e,r,n){return Ae(t,e,1,r,n)}me.encodedSize=function(t){const e=t.value,r="bigint"==typeof e?e*we-be:-1*e-1;return r<he[0]?1:r<he[1]?2:r<he[2]?3:r<he[3]?5:9},me.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},Be.encodedSize=function(t){const e=xe(t);return ge.encodedSize(e.length)+e.length},Be.compareTokens=function(t,e){return r=xe(t),n=xe(e),r.length<n.length?-1:r.length>n.length?1:function(t,e){if(Jt(t)&&Jt(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}(r,n);var r,n};const Se=Be;function Ie(t,e,r,n){return new zt(jt.array,n,r)}function Te(t,e,r,n){return Ie(0,0,1,r)}function Ce(t,e){ge(t,jt.array.majorEncoded,e.value)}function Ue(t,e,r,n){return new zt(jt.map,n,r)}function Le(t,e,r,n){return Ue(0,0,1,r)}function Ne(t,e){ge(t,jt.map.majorEncoded,e.value)}function Oe(t,e,r,n){return new zt(jt.tag,r,1)}function _e(t,e){ge(t,jt.tag.majorEncoded,e.value)}Ce.compareTokens=pe.compareTokens,Ce.encodedSize=function(t){return ge.encodedSize(t.value)},Ne.compareTokens=pe.compareTokens,Ne.encodedSize=function(t){return ge.encodedSize(t.value)},_e.compareTokens=pe.compareTokens,_e.encodedSize=function(t){return ge.encodedSize(t.value)};function Re(t,e,r){if(r){if(!1===r.allowNaN&&Number.isNaN(t))throw new Error(`${se} NaN values are not supported`);if(!1===r.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${se} Infinity values are not supported`)}return new zt(jt.float,t,e)}function De(t,e,r){const n=e.value;if(!1===n)t.push([20|jt.float.majorEncoded]);else if(!0===n)t.push([21|jt.float.majorEncoded]);else if(null===n)t.push([22|jt.float.majorEncoded]);else if(void 0===n)t.push([23|jt.float.majorEncoded]);else{let e,o=!1;r&&!0===r.float64||(He(n),e=$e(Pe,1),n===e||Number.isNaN(n)?(Pe[0]=249,t.push(Pe.slice(0,3)),o=!0):(Fe(n),e=je(Pe,1),n===e&&(Pe[0]=250,t.push(Pe.slice(0,5)),o=!0))),o||(i=n,Me.setFloat64(0,i,!1),e=ze(Pe,1),Pe[0]=251,t.push(Pe.slice(0,9)))}var i}De.encodedSize=function(t,e){const r=t.value;if(!1===r||!0===r||null==r)return 1;if(!e||!0!==e.float64){He(r);let t=$e(Pe,1);if(r===t||Number.isNaN(r))return 3;if(Fe(r),t=je(Pe,1),r===t)return 5}return 9};const Ve=new ArrayBuffer(9),Me=new DataView(Ve,1),Pe=new Uint8Array(Ve,0);function He(t){if(t===1/0)Me.setUint16(0,31744,!1);else if(t===-1/0)Me.setUint16(0,64512,!1);else if(Number.isNaN(t))Me.setUint16(0,32256,!1);else{Me.setFloat32(0,t);const e=Me.getUint32(0),r=(2139095040&e)>>23,n=8388607&e;if(255===r)Me.setUint16(0,31744,!1);else if(0===r)Me.setUint16(0,(2147483648&t)>>16|n>>13,!1);else{const t=r-127;t<-24?Me.setUint16(0,0):t<-14?Me.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):Me.setUint16(0,(2147483648&e)>>16|t+15<<10|n>>13,!1)}}}function $e(t,e){if(t.length-e<2)throw new Error(`${se} not enough data for float16`);const r=(t[e]<<8)+t[e+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let o;return o=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-o:o}function Fe(t){Me.setFloat32(0,t,!1)}function je(t,e){if(t.length-e<4)throw new Error(`${se} not enough data for float32`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function ze(t,e){if(t.length-e<8)throw new Error(`${se} not enough data for float64`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}function qe(t,e,r){throw new Error(`${se} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function Ke(t){return()=>{throw new Error(`${se} ${t}`)}}De.compareTokens=pe.compareTokens;const Ge=[];for(let t=0;t<=23;t++)Ge[t]=qe;Ge[24]=function(t,e,r,n){return new zt(jt.uint,le(t,e+1,n),2)},Ge[25]=function(t,e,r,n){return new zt(jt.uint,fe(t,e+1,n),3)},Ge[26]=function(t,e,r,n){return new zt(jt.uint,de(t,e+1,n),5)},Ge[27]=function(t,e,r,n){return new zt(jt.uint,ye(t,e+1,n),9)},Ge[28]=qe,Ge[29]=qe,Ge[30]=qe,Ge[31]=qe;for(let t=32;t<=55;t++)Ge[t]=qe;Ge[56]=function(t,e,r,n){return new zt(jt.negint,-1-le(t,e+1,n),2)},Ge[57]=function(t,e,r,n){return new zt(jt.negint,-1-fe(t,e+1,n),3)},Ge[58]=function(t,e,r,n){return new zt(jt.negint,-1-de(t,e+1,n),5)},Ge[59]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"!=typeof i){const t=-1-i;if(t>=Number.MIN_SAFE_INTEGER)return new zt(jt.negint,t,9)}if(!0!==n.allowBigInt)throw new Error(`${se} integers outside of the safe integer range are not supported`);return new zt(jt.negint,we-BigInt(i),9)},Ge[60]=qe,Ge[61]=qe,Ge[62]=qe,Ge[63]=qe;for(let t=64;t<=87;t++)Ge[t]=Ee;Ge[88]=function(t,e,r,n){return ve(t,e,2,le(t,e+1,n))},Ge[89]=function(t,e,r,n){return ve(t,e,3,fe(t,e+1,n))},Ge[90]=function(t,e,r,n){return ve(t,e,5,de(t,e+1,n))},Ge[91]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer bytes lengths not supported`);return ve(t,e,9,i)},Ge[92]=qe,Ge[93]=qe,Ge[94]=qe,Ge[95]=Ke("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)Ge[t]=ke;Ge[120]=function(t,e,r,n){return Ae(t,e,2,le(t,e+1,n),n)},Ge[121]=function(t,e,r,n){return Ae(t,e,3,fe(t,e+1,n),n)},Ge[122]=function(t,e,r,n){return Ae(t,e,5,de(t,e+1,n),n)},Ge[123]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer string lengths not supported`);return Ae(t,e,9,i,n)},Ge[124]=qe,Ge[125]=qe,Ge[126]=qe,Ge[127]=Ke("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)Ge[t]=Te;Ge[152]=function(t,e,r,n){return Ie(0,0,2,le(t,e+1,n))},Ge[153]=function(t,e,r,n){return Ie(0,0,3,fe(t,e+1,n))},Ge[154]=function(t,e,r,n){return Ie(0,0,5,de(t,e+1,n))},Ge[155]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer array lengths not supported`);return Ie(0,0,9,i)},Ge[156]=qe,Ge[157]=qe,Ge[158]=qe,Ge[159]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return Ie(0,0,1,1/0)};for(let t=160;t<=183;t++)Ge[t]=Le;Ge[184]=function(t,e,r,n){return Ue(0,0,2,le(t,e+1,n))},Ge[185]=function(t,e,r,n){return Ue(0,0,3,fe(t,e+1,n))},Ge[186]=function(t,e,r,n){return Ue(0,0,5,de(t,e+1,n))},Ge[187]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer map lengths not supported`);return Ue(0,0,9,i)},Ge[188]=qe,Ge[189]=qe,Ge[190]=qe,Ge[191]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return Ue(0,0,1,1/0)};for(let t=192;t<=215;t++)Ge[t]=Oe;Ge[216]=function(t,e,r,n){return new zt(jt.tag,le(t,e+1,n),2)},Ge[217]=function(t,e,r,n){return new zt(jt.tag,fe(t,e+1,n),3)},Ge[218]=function(t,e,r,n){return new zt(jt.tag,de(t,e+1,n),5)},Ge[219]=function(t,e,r,n){return new zt(jt.tag,ye(t,e+1,n),9)},Ge[220]=qe,Ge[221]=qe,Ge[222]=qe,Ge[223]=qe;for(let t=224;t<=243;t++)Ge[t]=Ke("simple values are not supported");Ge[244]=qe,Ge[245]=qe,Ge[246]=qe,Ge[247]=function(t,e,r,n){if(!1===n.allowUndefined)throw new Error(`${se} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new zt(jt.null,null,1):new zt(jt.undefined,void 0,1)},Ge[248]=Ke("simple values are not supported"),Ge[249]=function(t,e,r,n){return Re($e(t,e+1),3,n)},Ge[250]=function(t,e,r,n){return Re(je(t,e+1),5,n)},Ge[251]=function(t,e,r,n){return Re(ze(t,e+1),9,n)},Ge[252]=qe,Ge[253]=qe,Ge[254]=qe,Ge[255]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return new zt(jt.break,void 0,1)};const Je=[];for(let t=0;t<24;t++)Je[t]=new zt(jt.uint,t,1);for(let t=-1;t>=-24;t--)Je[31-t]=new zt(jt.negint,t,1);Je[64]=new zt(jt.bytes,new Uint8Array(0),1),Je[96]=new zt(jt.string,"",1),Je[128]=new zt(jt.array,0,1),Je[160]=new zt(jt.map,0,1),Je[244]=new zt(jt.false,!1,1),Je[245]=new zt(jt.true,!0,1),Je[246]=new zt(jt.null,null,1);const We={float64:!1,mapSorter:function(t,e){const r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,o=Ze[i].compareTokens(r,n);return 0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o},quickEncodeToken:function(t){switch(t.type){case jt.false:return Qt([244]);case jt.true:return Qt([245]);case jt.null:return Qt([246]);case jt.bytes:return t.value.length?void 0:Qt([64]);case jt.string:return""===t.value?Qt([96]):void 0;case jt.array:return 0===t.value?Qt([128]):void 0;case jt.map:return 0===t.value?Qt([160]):void 0;case jt.uint:return t.value<24?Qt([Number(t.value)]):void 0;case jt.negint:if(t.value>=-24)return Qt([31-Number(t.value)])}}},Ze=function(){const t=[];return t[jt.uint.major]=pe,t[jt.negint.major]=me,t[jt.bytes.major]=Be,t[jt.string.major]=Se,t[jt.array.major]=Ce,t[jt.map.major]=Ne,t[jt.tag.major]=_e,t[jt.float.major]=De,t}(),Ye=new oe;class Qe{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${ae} object contains circular references`);return new Qe(e,t)}}const Xe={null:new zt(jt.null,null),undefined:new zt(jt.undefined,void 0),true:new zt(jt.true,!0),false:new zt(jt.false,!1),emptyArray:new zt(jt.array,0),emptyMap:new zt(jt.map,0)},tr={number:(t,e,r,n)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new zt(t>=0?jt.uint:jt.negint,t):new zt(jt.float,t),bigint:(t,e,r,n)=>t>=BigInt(0)?new zt(jt.uint,t):new zt(jt.negint,t),Uint8Array:(t,e,r,n)=>new zt(jt.bytes,t),string:(t,e,r,n)=>new zt(jt.string,t),boolean:(t,e,r,n)=>t?Xe.true:Xe.false,null:(t,e,r,n)=>Xe.null,undefined:(t,e,r,n)=>Xe.undefined,ArrayBuffer:(t,e,r,n)=>new zt(jt.bytes,new Uint8Array(t)),DataView:(t,e,r,n)=>new zt(jt.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,r,n){if(!t.length)return!0===r.addBreakTokens?[Xe.emptyArray,new zt(jt.break)]:Xe.emptyArray;n=Qe.createCheck(n,t);const i=[];let o=0;for(const e of t)i[o++]=er(e,r,n);return r.addBreakTokens?[new zt(jt.array,t.length),i,new zt(jt.break)]:[new zt(jt.array,t.length),i]},Object(t,e,r,n){const i="Object"!==e,o=i?t.keys():Object.keys(t),s=i?t.size:o.length;if(!s)return!0===r.addBreakTokens?[Xe.emptyMap,new zt(jt.break)]:Xe.emptyMap;n=Qe.createCheck(n,t);const a=[];let c=0;for(const e of o)a[c++]=[er(e,r,n),er(i?t.get(e):t[e],r,n)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(a,r),r.addBreakTokens?[new zt(jt.map,s),a,new zt(jt.break)]:[new zt(jt.map,s),a]}};tr.Map=tr.Object,tr.Buffer=tr.Uint8Array;for(const t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))tr[`${t}Array`]=tr.DataView;function er(t,e={},r){const n=function(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if($t.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";return function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(Ft.includes(e))return e}(t)||"Object"}(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||tr[n];if("function"==typeof i){const o=i(t,n,e,r);if(null!=o)return o}const o=tr[n];if(!o)throw new Error(`${ae} unsupported type: ${n}`);return o(t,n,e,r)}function rr(t,e,r,n){if(Array.isArray(e))for(const i of e)rr(t,i,r,n);else r[e.type.major](t,e,n)}function nr(t,e,r){const n=er(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){const t=r.quickEncodeToken(n);if(t)return t;const i=e[n.type.major];if(i.encodedSize){const t=i.encodedSize(n,r),e=new oe(t);if(i(e,n,r),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Wt(e.chunks[0])}}return Ye.reset(),rr(Ye,n,e,r),Ye.toBytes(!0)}const ir={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class or{constructor(t,e={}){this._pos=0,this.data=t,this.options=e}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let e=Je[t];if(void 0===e){const r=Ge[t];if(!r)throw new Error(`${se} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const n=31&t;e=r(this.data,this._pos,n,this.options)}return this._pos+=e.encodedLength,e}}const sr=Symbol.for("DONE"),ar=Symbol.for("BREAK");function cr(t,e){if(t.done())return sr;const r=t.next();if(r.type===jt.break)return ar;if(r.type.terminal)return r.value;if(r.type===jt.array)return function(t,e,r){const n=[];for(let i=0;i<t.value;i++){const o=cr(e,r);if(o===ar){if(t.value===1/0)break;throw new Error(`${se} got unexpected break to lengthed array`)}if(o===sr)throw new Error(`${se} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=o}return n}(r,t,e);if(r.type===jt.map)return function(t,e,r){const n=!0===r.useMaps,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<t.value;s++){const a=cr(e,r);if(a===ar){if(t.value===1/0)break;throw new Error(`${se} got unexpected break to lengthed map`)}if(a===sr)throw new Error(`${se} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${se} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&o.has(a)||!n&&a in i))throw new Error(`${se} found repeat map key "${a}"`);const c=cr(e,r);if(c===sr)throw new Error(`${se} found map but not enough entries (got ${s} [no value], expected ${t.value})`);n?o.set(a,c):i[a]=c}return n?o:i}(r,t,e);if(r.type===jt.tag){if(e.tags&&"function"==typeof e.tags[r.value]){const n=cr(t,e);return e.tags[r.value](n)}throw new Error(`${se} tag not supported (${r.value})`)}throw new Error("unsupported")}function ur(t,e){const[r,n]=function(t,e){if(!(t instanceof Uint8Array))throw new Error(`${se} data to decode must be a Uint8Array`);const r=(e=Object.assign({},ir,e)).tokenizer||new or(t,e),n=cr(r,e);if(n===sr)throw new Error(`${se} did not find any content to decode`);if(n===ar)throw new Error(`${se} got unexpected break`);return[n,t.subarray(r.pos())]}(t,e);if(n.length>0)throw new Error(`${se} too many terminals, data makes no sense`);return r}function hr(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const lr=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var l=0,f=o-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*s[f]>>>0,s[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=e[i],f=0,d=s-1;(0!==l||f<n)&&-1!==d;d--,f++)l+=256*u[d]>>>0,u[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:l,decode:function(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class fr{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class dr{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return pr(this,t)}}class yr{decoders;constructor(t){this.decoders=t}or(t){return pr(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function pr(t,e){return new yr({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class gr{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new fr(t,e,r),this.decoder=new dr(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function wr({name:t,prefix:e,encode:r,decode:n}){return new gr(t,e,r,n)}function br({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=lr(r,t);return wr({prefix:e,name:t,encode:n,decode:t=>hr(i(t))})}function mr({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return wr({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const vr=mr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Er=(mr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),mr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xr=128,Br=-128,Ar=Math.pow(2,31),kr=128,Sr=127,Ir=Math.pow(2,7),Tr=Math.pow(2,14),Cr=Math.pow(2,21),Ur=Math.pow(2,28),Lr=Math.pow(2,35),Nr=Math.pow(2,42),Or=Math.pow(2,49),_r=Math.pow(2,56),Rr=Math.pow(2,63);const Dr={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=Ar;)r[n++]=255&e|xr,e/=128;for(;e&Br;)r[n++]=255&e|xr,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&Sr)<<o:(n&Sr)*Math.pow(2,o),o+=7}while(n>=kr);return t.bytes=s-r,i},encodingLength:function(t){return t<Ir?1:t<Tr?2:t<Cr?3:t<Ur?4:t<Lr?5:t<Nr?6:t<Or?7:t<_r?8:t<Rr?9:10}};function Vr(t,e=0){return[Dr.decode(t,e),Dr.decode.bytes]}function Mr(t,e,r=0){return Dr.encode(t,e,r),e}function Pr(t){return Dr.encodingLength(t)}class Hr{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}function $r(t,e){const{bytes:r,version:n}=t;return 0===n?function(t,e,r){const{prefix:n}=r;if(n!==Er.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i}(r,jr(t),e??Er.encoder):function(t,e,r){const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i}(r,jr(t),e??vr.encoder)}const Fr=new WeakMap;function jr(t){const e=Fr.get(t);if(null==e){const e=new Map;return Fr.set(t,e),e}return e}class zr{code;version;multihash;bytes;"/";constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==qr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Kr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return zr.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=function(t,e){const r=e.byteLength,n=Pr(t),i=n+Pr(r),o=new Uint8Array(i+r);return Mr(t,o,0),Mr(r,o,n),o.set(e,i),new Hr(t,r,e,o)}(t,e);return zr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return zr.equals(this,t)}static equals(t,e){const r=e;return null!=r&&t.code===r.code&&t.version===r.version&&function(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}(t.bytes,r.bytes)}}(t.multihash,r.multihash)}toString(t){return $r(this,t)}toJSON(){return{"/":$r(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof zr)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new zr(t,r,n,i??Gr(t,r,n.bytes))}if(!0===e[Jr]){const{version:t,multihash:r,code:n}=e,i=function(t){const e=hr(t),[r,n]=Vr(e),[i,o]=Vr(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Hr(r,i,s,e)}(r);return zr.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==qr)throw new Error(`Version 0 CID must use dag-pb (code: ${qr}) block encoding`);return new zr(t,e,r,r.bytes);case 1:{const n=Gr(t,e,r.bytes);return new zr(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return zr.create(0,qr,t)}static createV1(t,e){return zr.create(1,t,e)}static decode(t){const[e,r]=zr.decodeFirst(t);if(0!==r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=zr.inspectBytes(t),r=e.size-e.multihashSize,n=hr(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Hr(e.multihashCode,e.digestSize,i,n);return[0===e.version?zr.createV0(o):zr.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=Vr(t.subarray(e));return e+=n,r};let n=r(),i=qr;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=function(t,e){switch(t[0]){case"Q":{const r=e??Er;return[Er.prefix,r.decode(`${Er.prefix}${t}`)]}case Er.prefix:{const r=e??Er;return[Er.prefix,r.decode(t)]}case vr.prefix:{const r=e??vr;return[vr.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),i=zr.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return jr(i).set(r,t),i}}const qr=112,Kr=18;function Gr(t,e,r){const n=Pr(t),i=n+Pr(e),o=new Uint8Array(i+r.byteLength);return Mr(t,o,0),Mr(e,o,n),o.set(r,i),o}const Jr=Symbol.for("@ipld/js-cid/CID");function Wr(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}const Zr={float64:!0,typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=zr.asCID(t);if(!e)return null;const r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new zt(jt.tag,42),new zt(jt.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Yr={...Zr,typeEncoders:{...Zr.typeEncoders}},Qr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Qr.tags[42]=function(t){if(0!==t[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return zr.decode(t.subarray(1))};const Xr={...Qr,tags:Qr.tags.slice()},tn="dag-cbor",en=113,rn=t=>{return e=t,r=Zr,r=Object.assign({},We,r),nr(e,Ze,r);var e,r},nn=t=>ur(Wr(t),Qr),on=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),sn=Lt({name:"sha2-256",code:18,encode:on("SHA-256")}),an=(Lt({name:"sha2-512",code:19,encode:on("SHA-512")}),t),cn=sn,un=X,hn=t=>t&&void 0!==t.id&&void 0!==t.next&&void 0!==t.payload&&void 0!==t.v&&void 0!==t.clock&&void 0!==t.refs,ln=async t=>{const{cid:e,bytes:r}=await Pt({value:t,codec:an,hasher:cn}),n=e.toString(un),i=$(t.clock.id,t.clock.time);return{...t,clock:i,hash:n,bytes:r}},fn={create:async(t,e,r,n=null,i=[],o=[])=>{if(null==t)throw new Error("Identity is required, cannot create entry");if(null==e)throw new Error("Entry requires an id");if(null==r)throw new Error("Entry requires a payload");if(null==i||!Array.isArray(i))throw new Error("'next' argument is not an array");const s={id:e,payload:r,next:i,refs:o,clock:n=n||$(t.publicKey),v:2},{bytes:a}=await Pt({value:s,codec:an,hasher:cn}),c=await t.sign(t,a);return s.key=t.publicKey,s.identity=t.hash,s.sig=c,ln(s)},verify:async(t,e)=>{if(!t)throw new Error("Identities is required, cannot verify entry");if(!hn(e))throw new Error("Invalid Log entry");if(!e.key)throw new Error("Entry doesn't have a key");if(!e.sig)throw new Error("Entry doesn't have a signature");const r={id:e.id,payload:e.payload,next:e.next,refs:e.refs,clock:e.clock,v:e.v},{bytes:n}=await Pt({value:r,codec:an,hasher:cn});return t.verify(e.sig,e.key,n)},decode:async t=>{const{cid:e,value:r}=await Ht({bytes:t,codec:an,hasher:cn});return{...r,hash:e.toString(un),bytes:t}},encode:ln,isEntry:hn,isEqual:(t,e)=>t&&e&&t.hash===e.hash},dn=async()=>{let t={};const e=async(e,r)=>{t[e]=r};return{put:e,del:async e=>{delete t[e]},get:async e=>t[e],iterator:async function*(){for await(const[e,r]of Object.entries(t))yield[e,r]},merge:async t=>{if(t)for await(const[r,n]of t.iterator())e(r,n)},clear:async()=>{t={}},close:async()=>{}}},yn=dn,pn=t=>{t=new Set(t);const e={};for(const r of t)for(const t of r.next)e[t]=r.hash;const r=[];for(const n of t)e[n.hash]||r.push(n);return r};function gn(t,e,r){const n=((t,e)=>{const r=t.time-e.time;return 0===r&&t.id!==e.id?t.id<e.id?-1:1:r})(t.clock,e.clock);return 0===n?r(t,e):n}function wn(t,e,r){return t.clock.id===e.clock.id?r(t,e):t.clock.id<e.clock.id?-1:1}const bn={SortByClocks:gn,SortByClockId:wn,LastWriteWins:function(t,e){const r=(t,e)=>t,n=(t,e)=>wn(t,e,r);return((t,e)=>gn(t,e,n))(t,e)},NoZeroes:function(t){const e=`Your log's tiebreaker function, ${t.name}, has returned zero and therefore cannot be`;return(r,n)=>{const i=t(r,n);if(0===i)throw Error(e);return i}}},{LastWriteWins:mn,NoZeroes:vn}=bn,En=(t,e)=>Math.max(t,e.clock.time),xn=dn,Bn=async()=>({canAppend:async t=>!0}),An=async(t,{logId:e,logHeads:r,access:n,entryStorage:i,headsStorage:o,indexStorage:s,sortFn:a}={})=>{if(null==t)throw new Error("Identity is required");if(null!=r&&!Array.isArray(r))throw new Error("'logHeads' argument must be an array");const c=e||(new Date).getTime().toString();n=n||await Bn();const u=i||await xn(),h=s||await xn();o=o||await xn();const l=await(async({storage:t,heads:e})=>{t=t||await yn();const r=async e=>{e=pn(e);for(const r of e)await t.put(r.hash,r.bytes)},n=async e=>{await t.clear(),await r(e)},i=async function*(){const e=t.iterator();for await(const[,t]of e){const e=await fn.decode(t);yield e}},o=async()=>{const t=[];for await(const e of i())t.push(e);return t};return await r(e||[]),{put:r,set:n,add:async t=>{const e=await o();if(e.find((e=>fn.isEqual(e,t))))return;const r=pn([...e,t]);return await n(r),r},remove:async t=>{const e=(await o()).filter((e=>e.hash!==t));await n(e)},iterator:i,all:o,clear:async()=>{await t.clear()},close:async()=>{await t.close()}}})({storage:o,heads:r});a=vn(a||mn);const f=new k({concurrency:1}),d=new k({concurrency:1}),y=async()=>{const e=Math.max(0,(await p()).reduce(En,0));return $(t.publicKey,e)},p=async()=>(await l.all()).sort(a).reverse(),g=async()=>{const t=[];for await(const e of v())t.unshift(e);return t},w=async t=>{const e=await u.get(t);if(e)return await fn.decode(e)},b=async t=>null!=await h.get(t),m=async e=>d.add((async()=>{if(await b(e.hash))return!1;const r=async e=>{if(e.id!==c)throw new Error(`Entry's id (${e.id}) doesn't match the log's id (${c}).`);if(!await n.canAppend(e))throw new Error(`Could not append entry:\nKey "${e.identity}" is not allowed to write to the log`);if(!await fn.verify(t,e))throw new Error(`Could not validate signature for entry "${e.hash}"`)};await r(e);const i=(await p()).map((t=>t.hash)),o=new Set([e.hash]),s=new Set([...e.next,...e.refs]),a=new Set,f=async()=>{const t=Array.from(s.values()).filter(b).map(w),e=await Promise.all(t);for(const t of e){s.delete(t.hash),await r(t),o.add(t.hash);for(const e of[...t.next,...t.refs])await b(e)||o.has(e)?i.includes(e)&&a.add(e):s.add(e)}s.size>0&&await f()};await f();for(const t of o.values())await h.put(t,!0);for(const t of a.values())await l.remove(t);return await u.put(e.hash,e.bytes),await l.add(e),!0})),v=async function*(t,e){e=e||(()=>!1);let r=(t=t||await p()).sort(a);const n={};let i=[];const o={},s=t=>!(n[t]||o[t]);let c;for(;r.length>0;)if(r=r.sort(a),c=r.pop(),c){const{hash:t,next:a}=c;if(!n[t]){if(yield c,!0===await e(c))break;n[t]=!0,o[t]=!0,i=[...i,...a].filter(s);const u=t=>{if(!n[t]&&!o[t])return o[t]=!0,w(t)},h=await Promise.all(i.map(u));i=h.filter((t=>null!=t)).reduce(((t,e)=>Array.from(new Set([...t,...e.next]))),[]).filter(s),r=[...h,...r]}}};return{id:c,clock:y,heads:p,values:g,all:g,get:w,has:b,append:async(e,r={referencesCount:0})=>f.add((async()=>{const i=await p(),o=i.map((t=>t.hash)),s=await(async(t,e=0)=>{let r=[];const n=async t=>r.length>=e&&-1!==e;for await(const{hash:e}of v(t,n))r.push(e);return r=r.slice(t.length+1,e),r})(i,r.referencesCount+i.length),a=await fn.create(t,c,e,(t=>$(t.id,++t.time))(await y()),o,s);if(!await n.canAppend(a))throw new Error(`Could not append entry:\nKey "${t.hash}" is not allowed to write to the log`);return await l.set([a]),await u.put(a.hash,a.bytes),await h.put(a.hash,!0),a})),join:async t=>{if(!t)throw new Error("Log instance not defined");if(!(e=t)||void 0===e.id||void 0===e.clock||void 0===e.heads||void 0===e.values||void 0===e.access||void 0===e.identity||void 0===e.storage)throw new Error("Given argument is not an instance of Log");var e;u.merge&&await u.merge(t.storage);const r=await t.heads();for(const t of r)await m(t)},joinEntry:m,traverse:v,iterator:async function*({amount:t=-1,gt:e,gte:r,lt:n,lte:i}={}){if(0===t)return;if("string"==typeof i&&(i=[await w(i)]),"string"==typeof n){const t=await w(n);n=await Promise.all(t.next.map((t=>w(t))))}if(null!=n&&!Array.isArray(n))throw new Error("lt must be a string or an array of Entries");if(null!=i&&!Array.isArray(i))throw new Error("lte must be a string or an array of Entries");const o=(n||i||await p()).filter((t=>null!=t)),s=e||r?await w(e||r):null,a=s||-1===t?-1:t;let c=0;const u=s&&-1!==t&&!n&&!i,h=u?new H(t+2):null;let l=0;const f=v(o,(async t=>(c++,!!t&&(c>=a&&-1!==a||!(!s||!fn.isEqual(t,s))))));for await(const t of f){const r=n&&fn.isEqual(t,o),i=e&&fn.isEqual(t,s);r||i||(u?h.set(l++,t.hash):yield t)}if(u){const e=h.keys.length,r=e>t?e-t:0,n=h.keys.slice(r,e);for(const t of n){const e=h.get(t),r=await w(e);yield r}}},clear:async()=>{await h.clear(),await l.clear(),await u.clear()},close:async()=>{await h.close(),await l.close(),await u.close()},access:n,identity:t,storage:u}},kn=async(t,e)=>({put:async(r,n)=>{await t.put(r,n),await e.put(r,n)},get:async r=>{let n=await t.get(r);return n||(n=await e.get(r),n&&await t.put(r,n)),n},del:async r=>{await t.del(r),await e.del(r)},iterator:async function*({amount:r,reverse:n}={}){const i=[],o={amount:r||-1,reverse:n||!1};for(const r of[t,e])for await(const[t,e]of r.iterator(o))i[t]||(i[t]=!0,yield[t,e])},merge:async r=>{await t.merge(r),await e.merge(r),await r.merge(t),await r.merge(e)},clear:async()=>{await t.clear(),await e.clear()},close:async()=>{await t.close(),await e.close()}}),Sn=async({ipfs:t,pin:e,timeout:r}={})=>{if(!t)throw new Error("An instance of ipfs is required.");return{put:async(n,i)=>{const o=Bt.parse(n,X),{signal:s}=new V.TimeoutController(r||3e4);await t.blockstore.put(o,i,{signal:s}),e&&!await t.pins.isPinned(o)&&await function(t){if(null!=t[Symbol.asyncIterator])return(async()=>{for await(const e of t);})();for(const e of t);}(t.pins.add(o))},del:async t=>{},get:async e=>{const n=Bt.parse(e,X),{signal:i}=new V.TimeoutController(r||3e4),o=await t.blockstore.get(n,{signal:i});if(o)return o},iterator:async function*(){},merge:async t=>{},clear:async()=>{},close:async()=>{}}};var In=r(301);const Tn=async({path:t,valueEncoding:e}={})=>{t=t||"./level",e=e||"view";const r=new In.Level(t,{valueEncoding:e,passive:!0});return await r.open(),{put:async(t,e)=>{await r.put(t,e)},del:async t=>{await r.del(t)},get:async t=>{try{const e=await r.get(t);if(e)return e}catch(t){}},iterator:async function*({amount:t,reverse:e}={}){const n={limit:t||-1,reverse:e||!1};for await(const[t,e]of r.iterator(n))yield[t,e]},merge:async t=>{},clear:async()=>{await r.clear()},close:async()=>{await r.close()}}},Cn=1e6,Un=async({size:t}={})=>{let e=new H(t||Cn);return{put:async(t,r)=>{e.set(t,r)},del:async t=>{e.remove(t)},get:async t=>e.get(t),iterator:async function*(){for await(const t of e.keys){const r=e.get(t);yield[t,r]}},merge:async t=>{if(t)for await(const[r,n]of t.iterator())e.set(r,n)},clear:async()=>{e=new H(t||Cn)},close:async()=>{}}},Ln=1e3,Nn=async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f})=>{o=P(o||"./orbitdb",`./${r}/`),s=s||{},h=Number(h)>-1?h:16,c=c||await kn(await Un({size:Ln}),await Sn({ipfs:t,pin:!0})),a=a||await kn(await Un({size:Ln}),await Tn({path:P(o,"/log/_heads/")})),u=u||await kn(await Un({size:Ln}),await Tn({path:P(o,"/log/_index/")}));const d=await An(e,{logId:r,access:i,entryStorage:c,headsStorage:a,indexStorage:u}),y=new b.EventEmitter,p=new k({concurrency:1}),g=await(async({ipfs:t,log:e,events:r,onSynced:n,start:i,timeout:o})=>{if(!t)throw new Error("An instance of ipfs is required.");if(!e)throw new Error("An instance of log is required.");const s=t.libp2p,a=t.libp2p.services.pubsub,c=e.id,u=P("/orbitdb/heads/",c),h=new k({concurrency:1}),l=new Set;r=r||new b.EventEmitter,o=o||3e4;let f=!1;const d=t=>async function*(){const t=await e.heads();for await(const{bytes:e}of t)yield e}(),y=t=>async i=>{for await(const t of i){const e=t.subarray();e&&n&&await n(e)}f&&await(async t=>{const n=await e.heads();r.emit("join",t,n)})(t)},p=async({connection:t,stream:e})=>{const n=String(t.remotePeer);try{l.add(n),await L(e,y(n),d,e)}catch(t){l.delete(n),r.emit("error",t)}},g=async t=>{h.add((async()=>{const{peerId:e,subscriptions:n}=t.detail,i=String(e),a=n.find((t=>t.topic===c));if(a)if(a.subscribe){if(l.has(i))return;const t=new V.TimeoutController(o),{signal:n}=t;try{l.add(i);const t=await s.dialProtocol(e,u,{signal:n});await L(d,t,y(i))}catch(t){l.delete(i),"UnsupportedProtocolError"===t.name||r.emit("error",t)}finally{t&&t.clear()}}else l.delete(i),r.emit("leave",i)}))},w=async t=>{const{topic:e,data:i}=t.detail;e===c&&h.add((async()=>{try{i&&n&&await n(i)}catch(t){r.emit("error",t)}}))},m=async t=>{l.delete(t.detail.toString())},v=async()=>{f||(await s.handle(u,p),a.addEventListener("subscription-change",g),a.addEventListener("message",w),await a.subscribe(c),s.addEventListener("peer:disconnect",m),f=!0)};return!1!==i&&await v(),{add:async t=>{f&&await a.publish(c,t.bytes)},stop:async()=>{f&&(f=!1,await h.onIdle(),a.removeEventListener("subscription-change",g),a.removeEventListener("message",w),await s.unhandle(u),await a.unsubscribe(c),s.removeEventListener("peer:disconnect",m),l.clear())},start:v,events:r,peers:l}})({ipfs:t,log:d,events:y,onSynced:async t=>{await p.add((async()=>{const e=await fn.decode(t);e&&await d.joinEntry(e)&&(f&&await f(d,e),y.emit("update",e))}))},start:l});return{address:r,name:n,identity:e,meta:s,close:async()=>{await g.stop(),await p.onIdle(),await d.close(),i&&i.close&&await i.close(),y.emit("close")},drop:async()=>{await p.onIdle(),await d.clear(),i&&i.drop&&await i.drop(),y.emit("drop")},addOperation:async t=>{const e=await p.add((async()=>{const e=await d.append(t,{referencesCount:h});return await g.add(e),f&&await f(d,e),y.emit("update",e),e.hash}));return await p.onIdle(),e},log:d,sync:g,peers:g.peers,events:y,access:i}},On="documents",_n={indexBy:"_id"},Rn=({indexBy:t}=_n)=>async({ipfs:e,identity:r,address:n,name:i,access:o,directory:s,meta:a,headsStorage:c,entryStorage:u,indexStorage:h,referencesCount:l,syncAutomatically:f,onUpdate:d})=>{const y=await Nn({ipfs:e,identity:r,address:n,name:i,access:o,directory:s,meta:a,headsStorage:c,entryStorage:u,indexStorage:h,referencesCount:l,syncAutomatically:f}),{addOperation:p,log:g}=y,w=async t=>{for await(const e of b())if(t===e.key)return e},b=async function*({amount:t}={}){const e={};let r=0;for await(const n of g.iterator()){const{op:i,key:o,value:s}=n.payload;if("PUT"!==i||e[o])"DEL"!==i||e[o]||(e[o]=!0);else{e[o]=!0,r++;const t=n.hash;yield{hash:t,key:o,value:s}}if(r>=t)break}};return{...y,type:On,put:async e=>{const r=e[t];if(!r)throw new Error(`The provided document doesn't contain field '${t}'`);return p({op:"PUT",key:r,value:e})},del:async t=>{if(!await w(t))throw new Error(`No document with key '${t}' in the database`);return p({op:"DEL",key:t,value:null})},get:w,iterator:b,query:async t=>{const e=[];for await(const r of b())t(r.value)&&e.push(r.value);return e},indexBy:t,all:async()=>{const t=[];for await(const e of b())t.unshift(e);return t}}};Rn.type=On;const Dn=Rn,Vn="events",Mn=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f})=>{const d=await Nn({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f}),{addOperation:y,log:p}=d,g=async function*({gt:t,gte:e,lt:r,lte:n,amount:i}={}){const o=p.iterator({gt:t,gte:e,lt:r,lte:n,amount:i});for await(const t of o){const e=t.hash,r=t.payload.value;yield{hash:e,value:r}}};return{...d,type:Vn,add:async t=>y({op:"ADD",key:null,value:t}),get:async t=>(await p.get(t)).payload.value,iterator:g,all:async()=>{const t=[];for await(const e of g())t.unshift(e);return t}}};Mn.type=Vn;const Pn=Mn,Hn="keyvalue",$n=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f})=>{const d=await Nn({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f}),{addOperation:y,log:p}=d,g=async(t,e)=>y({op:"PUT",key:t,value:e}),w=async function*({amount:t}={}){const e={};let r=0;for await(const n of p.traverse()){const{op:i,key:o,value:s}=n.payload;if("PUT"!==i||e[o])"DEL"!==i||e[o]||(e[o]=!0);else{e[o]=!0,r++;const t=n.hash;yield{key:o,value:s,hash:t}}if(r>=t)break}};return{...d,type:Hn,put:g,set:g,del:async t=>y({op:"DEL",key:t,value:null}),get:async t=>{for await(const e of p.traverse()){const{op:r,key:n,value:i}=e.payload;if("PUT"===r&&n===t)return i;if("DEL"===r&&n===t)return}},iterator:w,all:async()=>{const t=[];for await(const e of w())t.unshift(e);return t}}};$n.type=Hn;const Fn=$n,jn="json",zn=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:f})=>{o=P(o||"./orbitdb",`./${r}/_index/`);const d=await(({directory:t}={})=>async()=>{const e=await Tn({path:t,valueEncoding:jn}),r=await Tn({path:P(t,"/_indexedEntries/"),valueEncoding:jn});return{get:e.get,iterator:e.iterator,update:async(t,n)=>{const i=new Set,o=new Set,s=n.hash,a=async t=>!0===await r.get(t),c=async t=>!await a(t),u=async t=>{for await(const e of t.next)await c(e)&&o.add(e);return await a(s)&&0===o.size};for await(const n of t.traverse(null,u)){const{hash:t,payload:s}=n;if(await c(t)){const{op:a,key:c}=s;"PUT"!==a||i.has(c)?"DEL"!==a||i.has(c)||(i.add(c),await e.del(c),await r.put(t,!0)):(i.add(c),await e.put(c,n),await r.put(t,!0)),o.delete(t)}}},close:async()=>{await e.close(),await r.close()},drop:async()=>{await e.clear(),await r.clear()}}})({directory:o})(),y=await Fn()({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:l,onUpdate:d.update});return{...y,get:async t=>{const e=await d.get(t);if(e)return e.payload.value},iterator:async function*({amount:t}={}){const e=d.iterator({amount:t,reverse:!0});for await(const t of e){const e=t[1],{key:r,value:n}=e.payload,i=e.hash;yield{key:r,value:n,hash:i}}},close:async()=>{await y.close(),await d.close()},drop:async()=>{await y.drop(),await d.drop()}}};zn.type="keyvalue";const qn=zn,Kn={},Gn=t=>{if(!t.type)throw new Error("Database type does not contain required field 'type'.");Kn[t.type]=t};Gn(Pn),Gn(Dn),Gn(Fn);class Jn extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}}class Wn extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}}class Zn extends Error{static name="InvalidPrivateKeyError";constructor(t="Invalid private key"){super(t),this.name="InvalidPrivateKeyError"}}class Yn extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}}function Qn(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Xn=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var l=0,f=o-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*s[f]>>>0,s[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=e[i],f=0,d=s-1;(0!==l||f<n)&&-1!==d;d--,f++)l+=256*u[d]>>>0,u[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:l,decode:function(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class ti{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ei{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){this.name=t,this.prefix=e;const n=e.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return ni(this,t)}}class ri{decoders;constructor(t){this.decoders=t}or(t){return ni(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function ni(t,e){return new ri({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class ii{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new ti(t,e,r),this.decoder=new ei(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function oi({name:t,prefix:e,encode:r,decode:n}){return new ii(t,e,r,n)}function si({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=Xn(r,t);return oi({prefix:e,name:t,encode:n,decode:t=>Qn(i(t))})}function ai({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return oi({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const ci=si({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ui=(si({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ai({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),hi=(ai({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ai({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ai({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ai({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ai({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ai({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ai({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ai({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),si({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}));si({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var li=128,fi=-128,di=Math.pow(2,31),yi=128,pi=127,gi=Math.pow(2,7),wi=Math.pow(2,14),bi=Math.pow(2,21),mi=Math.pow(2,28),vi=Math.pow(2,35),Ei=Math.pow(2,42),xi=Math.pow(2,49),Bi=Math.pow(2,56),Ai=Math.pow(2,63);const ki={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=di;)r[n++]=255&e|li,e/=128;for(;e&fi;)r[n++]=255&e|li,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&pi)<<o:(n&pi)*Math.pow(2,o),o+=7}while(n>=yi);return t.bytes=s-r,i},encodingLength:function(t){return t<gi?1:t<wi?2:t<bi?3:t<mi?4:t<vi?5:t<Ei?6:t<xi?7:t<Bi?8:t<Ai?9:10}};function Si(t,e=0){return[ki.decode(t,e),ki.decode.bytes]}function Ii(t,e,r=0){return ki.encode(t,e,r),e}function Ti(t){return ki.encodingLength(t)}function Ci(t,e){const r=e.byteLength,n=Ti(t),i=n+Ti(r),o=new Uint8Array(i+r);return Ii(t,o,0),Ii(r,o,n),o.set(e,i),new Ui(t,r,e,o)}class Ui{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}function Li(t,e){const{bytes:r,version:n}=t;return 0===n?function(t,e,r){const{prefix:n}=r;if(n!==ci.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i}(r,Oi(t),e??ci.encoder):function(t,e,r){const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i}(r,Oi(t),e??ui.encoder)}const Ni=new WeakMap;function Oi(t){const e=Ni.get(t);if(null==e){const e=new Map;return Ni.set(t,e),e}return e}class _i{code;version;multihash;bytes;"/";constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==Ri)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Di)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _i.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=Ci(t,e);return _i.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return _i.equals(this,t)}static equals(t,e){const r=e;return null!=r&&t.code===r.code&&t.version===r.version&&function(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}(t.bytes,r.bytes)}}(t.multihash,r.multihash)}toString(t){return Li(this,t)}toJSON(){return{"/":Li(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof _i)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new _i(t,r,n,i??Vi(t,r,n.bytes))}if(!0===e[Mi]){const{version:t,multihash:r,code:n}=e,i=function(t){const e=Qn(t),[r,n]=Si(e),[i,o]=Si(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Ui(r,i,s,e)}(r);return _i.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==Ri)throw new Error(`Version 0 CID must use dag-pb (code: ${Ri}) block encoding`);return new _i(t,e,r,r.bytes);case 1:{const n=Vi(t,e,r.bytes);return new _i(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return _i.create(0,Ri,t)}static createV1(t,e){return _i.create(1,t,e)}static decode(t){const[e,r]=_i.decodeFirst(t);if(0!==r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=_i.inspectBytes(t),r=e.size-e.multihashSize,n=Qn(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Ui(e.multihashCode,e.digestSize,i,n);return[0===e.version?_i.createV0(o):_i.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=Si(t.subarray(e));return e+=n,r};let n=r(),i=Ri;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=function(t,e){switch(t[0]){case"Q":{const r=e??ci;return[ci.prefix,r.decode(`${ci.prefix}${t}`)]}case ci.prefix:{const r=e??ci;return[ci.prefix,r.decode(t)]}case ui.prefix:{const r=e??ui;return[ui.prefix,r.decode(t)]}case hi.prefix:{const r=e??hi;return[hi.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),i=_i.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return Oi(i).set(r,t),i}}const Ri=112,Di=18;function Vi(t,e,r){const n=Ti(t),i=n+Ti(e),o=new Uint8Array(i+r.byteLength);return Ii(t,o,0),Ii(e,o,n),o.set(r,i),o}const Mi=Symbol.for("@ipld/js-cid/CID"),Pi=Qn,Hi=function(t){return Ci(0,Pi(t))};function $i(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Fi(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function ji(t,...e){if(!((r=t)instanceof Uint8Array||null!=r&&"object"==typeof r&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function zi(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}const qi="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Ki=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Gi=(t,e)=>t<<32-e|t>>>e;function Ji(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Wi(t){return"string"==typeof t&&(t=Ji(t)),ji(t),t}function Zi(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];ji(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}new Uint8Array(new Uint32Array([287454020]).buffer)[0];class Yi{clone(){return this._cloneInto()}}function Qi(t){const e=e=>t().update(Wi(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Xi(t=32){if(qi&&"function"==typeof qi.getRandomValues)return qi.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}const to=(t,e,r)=>t&e^t&r^e&r;class eo extends Yi{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ki(this.buffer)}update(t){zi(this);const{view:e,buffer:r,blockLen:n}=this,i=(t=Wi(t)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=Ki(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){zi(this),function(t,e){ji(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=Ki(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}}const ro=BigInt(2**32-1),no=BigInt(32);function io(t,e=!1){return e?{h:Number(t&ro),l:Number(t>>no&ro)}:{h:0|Number(t>>no&ro),l:0|Number(t&ro)}}const oo={fromBig:io,split:function(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:o,l:s}=io(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]},toBig:(t,e)=>BigInt(t>>>0)<<no|BigInt(e>>>0),shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:(t,e,r)=>t<<r|e>>>32-r,rotlSL:(t,e,r)=>e<<r|t>>>32-r,rotlBH:(t,e,r)=>e<<r-32|t>>>64-r,rotlBL:(t,e,r)=>t<<r-32|e>>>64-r,add:function(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/2**32|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,add5H:(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,add5L:(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},so=oo,[ao,co]=(()=>so.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),uo=new Uint32Array(80),ho=new Uint32Array(80);class lo extends eo{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:h,Fl:l,Gh:f,Gl:d,Hh:y,Hl:p}=this;return[t,e,r,n,i,o,s,a,c,u,h,l,f,d,y,p]}set(t,e,r,n,i,o,s,a,c,u,h,l,f,d,y,p){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|l,this.Gh=0|f,this.Gl=0|d,this.Hh=0|y,this.Hl=0|p}process(t,e){for(let r=0;r<16;r++,e+=4)uo[r]=t.getUint32(e),ho[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|uo[t-15],r=0|ho[t-15],n=so.rotrSH(e,r,1)^so.rotrSH(e,r,8)^so.shrSH(e,r,7),i=so.rotrSL(e,r,1)^so.rotrSL(e,r,8)^so.shrSL(e,r,7),o=0|uo[t-2],s=0|ho[t-2],a=so.rotrSH(o,s,19)^so.rotrBH(o,s,61)^so.shrSH(o,s,6),c=so.rotrSL(o,s,19)^so.rotrBL(o,s,61)^so.shrSL(o,s,6),u=so.add4L(i,c,ho[t-7],ho[t-16]),h=so.add4H(u,n,a,uo[t-7],uo[t-16]);uo[t]=0|h,ho[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:h,El:l,Fh:f,Fl:d,Gh:y,Gl:p,Hh:g,Hl:w}=this;for(let t=0;t<80;t++){const e=so.rotrSH(h,l,14)^so.rotrSH(h,l,18)^so.rotrBH(h,l,41),b=so.rotrSL(h,l,14)^so.rotrSL(h,l,18)^so.rotrBL(h,l,41),m=h&f^~h&y,v=l&d^~l&p,E=so.add5L(w,b,v,co[t],ho[t]),x=so.add5H(E,g,e,m,ao[t],uo[t]),B=0|E,A=so.rotrSH(r,n,28)^so.rotrBH(r,n,34)^so.rotrBH(r,n,39),k=so.rotrSL(r,n,28)^so.rotrBL(r,n,34)^so.rotrBL(r,n,39),S=r&i^r&s^i&s,I=n&o^n&a^o&a;g=0|y,w=0|p,y=0|f,p=0|d,f=0|h,d=0|l,({h,l}=so.add(0|c,0|u,0|x,0|B)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const T=so.add3L(B,k,I);r=so.add3H(T,x,A,S),n=0|T}({h:r,l:n}=so.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=so.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=so.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=so.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l}=so.add(0|this.Eh,0|this.El,0|h,0|l)),({h:f,l:d}=so.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:y,l:p}=so.add(0|this.Gh,0|this.Gl,0|y,0|p)),({h:g,l:w}=so.add(0|this.Hh,0|this.Hl,0|g,0|w)),this.set(r,n,i,o,s,a,c,u,h,l,f,d,y,p,g,w)}roundClean(){uo.fill(0),ho.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const fo=Qi((()=>new lo)),yo=(BigInt(0),BigInt(1)),po=BigInt(2);function go(t){return t instanceof Uint8Array||null!=t&&"object"==typeof t&&"Uint8Array"===t.constructor.name}function wo(t){if(!go(t))throw new Error("Uint8Array expected")}const bo=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function mo(t){wo(t);let e="";for(let r=0;r<t.length;r++)e+=bo[t[r]];return e}function vo(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}const Eo={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function xo(t){return t>=Eo._0&&t<=Eo._9?t-Eo._0:t>=Eo._A&&t<=Eo._F?t-(Eo._A-10):t>=Eo._a&&t<=Eo._f?t-(Eo._a-10):void 0}function Bo(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=xo(t.charCodeAt(i)),o=xo(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Ao(t){return vo(mo(t))}function ko(t){return wo(t),vo(mo(Uint8Array.from(t).reverse()))}function So(t,e){return Bo(t.toString(16).padStart(2*e,"0"))}function Io(t,e){return So(t,e).reverse()}function To(t,e,r){let n;if("string"==typeof e)try{n=Bo(e)}catch(r){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!go(e))throw new Error(`${t} must be hex string or Uint8Array`);n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Co(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];wo(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}const Uo=t=>(po<<BigInt(t-1))-yo,Lo=t=>new Uint8Array(t),No=t=>Uint8Array.from(t);function Oo(t,e,r){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=Lo(t),i=Lo(t),o=0;const s=()=>{n.fill(1),i.fill(0),o=0},a=(...t)=>r(i,n,...t),c=(t=Lo())=>{i=a(No([0]),t),n=a(),0!==t.length&&(i=a(No([1]),t),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const r=[];for(;t<e;){n=a();const e=n.slice();r.push(e),t+=n.length}return Co(...r)};return(t,e)=>{let r;for(s(),c(t);!(r=e(u()));)c();return s(),r}}const _o={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||go(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Ro(t,e,r={}){const n=(e,r,n)=>{const i=_o[r];if("function"!=typeof i)throw new Error(`Invalid validator "${r}", expected function`);const o=t[e];if(!(n&&void 0===o||i(o,t)))throw new Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${r}`)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const Do=BigInt(0),Vo=BigInt(1),Mo=BigInt(2),Po=BigInt(3),Ho=BigInt(4),$o=BigInt(5),Fo=BigInt(8);function jo(t,e){const r=t%e;return r>=Do?r:e+r}function zo(t,e,r){if(r<=Do||e<Do)throw new Error("Expected power/modulo > 0");if(r===Vo)return Do;let n=Vo;for(;e>Do;)e&Vo&&(n=n*t%r),t=t*t%r,e>>=Vo;return n}function qo(t,e,r){let n=t;for(;e-- >Do;)n*=n,n%=r;return n}function Ko(t,e){if(t===Do||e<=Do)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=jo(t,e),n=e,i=Do,o=Vo,s=Vo,a=Do;for(;r!==Do;){const t=n/r,e=n%r,c=i-s*t,u=o-a*t;n=r,r=e,i=s,o=a,s=c,a=u}if(n!==Vo)throw new Error("invert: does not exist");return jo(i,e)}BigInt(9),BigInt(16);const Go=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Jo(t,e){const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Wo(t,e,r=!1,n={}){if(t<=Do)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:o}=Jo(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=function(t){if(t%Ho===Po){const e=(t+Vo)/Ho;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}if(t%Fo===$o){const e=(t-$o)/Fo;return function(t,r){const n=t.mul(r,Mo),i=t.pow(n,e),o=t.mul(r,i),s=t.mul(t.mul(o,Mo),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-Vo)/Mo;let r,n,i;for(r=t-Vo,n=0;r%Mo===Do;r/=Mo,n++);for(i=Mo;i<t&&zo(i,e,t)!==t-Vo;i++);if(1===n){const e=(t+Vo)/Ho;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+Vo)/Mo;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=n,c=t.pow(t.mul(t.ONE,i),r),u=t.pow(s,o),h=t.pow(s,r);for(;!t.eql(h,t.ONE);){if(t.eql(h,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(h);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const r=t.pow(c,Vo<<BigInt(a-e-1));c=t.sqr(r),u=t.mul(u,r),h=t.mul(h,c),a=e}return u}}(t)}(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:Uo(i),ZERO:Do,ONE:Vo,create:e=>jo(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return Do<=e&&e<t},is0:t=>t===Do,isOdd:t=>(t&Vo)===Vo,neg:e=>jo(-e,t),eql:(t,e)=>t===e,sqr:e=>jo(e*e,t),add:(e,r)=>jo(e+r,t),sub:(e,r)=>jo(e-r,t),mul:(e,r)=>jo(e*r,t),pow:(t,e)=>function(t,e,r){if(r<Do)throw new Error("Expected power > 0");if(r===Do)return t.ONE;if(r===Vo)return e;let n=t.ONE,i=e;for(;r>Do;)r&Vo&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Vo;return n}(a,t,e),div:(e,r)=>jo(e*Ko(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Ko(e,t),sqrt:n.sqrt||(t=>s(a,t)),invertBatch:t=>function(t,e){const r=new Array(e.length),n=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),i=t.inv(n);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),i),r}(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?Io(t,o):So(t,o),fromBytes:t=>{if(t.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${t.length}`);return r?ko(t):Ao(t)}});return Object.freeze(a)}function Zo(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Yo(t){const e=Zo(t);return e+Math.ceil(e/2)}const Qo=BigInt(0),Xo=BigInt(1);function ts(t,e){const r=(t,e)=>{const r=e.negate();return t?r:e},n=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,i=e;for(;r>Qo;)r&Xo&&(n=n.add(i)),i=i.double(),r>>=Xo;return n},precomputeWindow(t,e){const{windows:r,windowSize:i}=n(e),o=[];let s=t,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,i,o){const{windows:s,windowSize:a}=n(e);let c=t.ZERO,u=t.BASE;const h=BigInt(2**e-1),l=2**e,f=BigInt(e);for(let t=0;t<s;t++){const e=t*a;let n=Number(o&h);o>>=f,n>a&&(n-=l,o+=Xo);const s=e,d=e+Math.abs(n)-1,y=t%2!=0,p=n<0;0===n?u=u.add(r(y,i[s])):c=c.add(r(p,i[d]))}return{p:c,f:u}},wNAFCached(t,e,r,n){const i=t._WINDOW_SIZE||1;let o=e.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&e.set(t,n(o))),this.wNAF(i,o,r)}}}function es(t){return Ro(t.Fp,Go.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Ro(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Jo(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const rs=BigInt(0),ns=BigInt(1),is=BigInt(2),os=BigInt(8),ss={zip215:!0};function as(t){const e=function(t){const e=es(t);return Ro(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,u=is<<BigInt(8*a)-ns,h=r.create,l=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:rs}}}),f=e.adjustScalarBytes||(t=>t),d=e.domain||((t,e,r)=>{if(e.length||r)throw new Error("Contexts/pre-hash are not supported");return t}),y=t=>"bigint"==typeof t&&rs<t,p=(t,e)=>y(t)&&y(e)&&t<e,g=t=>t===rs||p(t,u);function w(t,e){if(p(t,e))return t;throw new Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function b(t){return t===rs?t:w(t,n)}const m=new Map;function v(t){if(!(t instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(t,e,r,n){if(this.ex=t,this.ey=e,this.ez=r,this.et=n,!g(t))throw new Error("x required");if(!g(e))throw new Error("y required");if(!g(r))throw new Error("z required");if(!g(n))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof E)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};if(!g(e)||!g(r))throw new Error("invalid affine point");return new E(e,r,ns,h(e*r))}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(E.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,m.delete(this)}assertValidity(){const{a:t,d:r}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:n,ey:i,ez:o,et:s}=this,a=h(n*n),c=h(i*i),u=h(o*o),l=h(u*u),f=h(a*t);if(h(u*h(f+c))!==h(l+h(r*h(a*c))))throw new Error("bad point: equation left != right (1)");if(h(n*i)!==h(o*s))throw new Error("bad point: equation left != right (2)")}equals(t){v(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=h(e*s),c=h(i*n),u=h(r*s),l=h(o*n);return a===c&&u===l}is0(){return this.equals(E.ZERO)}negate(){return new E(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,o=h(r*r),s=h(n*n),a=h(is*h(i*i)),c=h(t*o),u=r+n,l=h(h(u*u)-o-s),f=c+s,d=f-a,y=c-s,p=h(l*d),g=h(f*y),w=h(l*y),b=h(d*f);return new E(p,g,b,w)}add(t){v(t);const{a:r,d:n}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:l,et:f}=t;if(r===BigInt(-1)){const t=h((o-i)*(u+c)),e=h((o+i)*(u-c)),r=h(e-t);if(r===rs)return this.double();const n=h(s*is*f),d=h(a*is*l),y=d+n,p=e+t,g=d-n,w=h(y*r),b=h(p*g),m=h(y*g),v=h(r*p);return new E(w,b,v,m)}const d=h(i*c),y=h(o*u),p=h(a*n*f),g=h(s*l),w=h((i+o)*(c+u)-d-y),b=g-p,m=g+p,x=h(y-r*d),B=h(w*b),A=h(m*x),k=h(w*x),S=h(b*m);return new E(B,A,S,k)}subtract(t){return this.add(t.negate())}wNAF(t){return A.wNAFCached(this,m,t,E.normalizeZ)}multiply(t){const{p:e,f:r}=this.wNAF(w(t,n));return E.normalizeZ([e,r])[0]}multiplyUnsafe(t){let e=b(t);return e===rs?B:this.equals(B)||e===ns?this:this.equals(x)?this.wNAF(e).p:A.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(t){const{ex:e,ey:n,ez:i}=this,o=this.is0();null==t&&(t=o?os:r.inv(i));const s=h(e*t),a=h(n*t),c=h(i*t);if(o)return{x:rs,y:ns};if(c!==ns)throw new Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){const{h:t}=e;return t===ns?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:o}=e,s=r.BYTES,a=(t=To("pointHex",t,s)).slice(),c=t[s-1];a[s-1]=-129&c;const f=ko(a);f===rs||w(f,n?u:r.ORDER);const d=h(f*f),y=h(d-ns),p=h(i*d-o);let{isValid:g,value:b}=l(y,p);if(!g)throw new Error("Point.fromHex: invalid y coordinate");const m=(b&ns)===ns,v=0!=(128&c);if(!n&&b===rs&&v)throw new Error("Point.fromHex: x=0 and x_0=1");return v!==m&&(b=h(-b)),E.fromAffine({x:b,y:f})}static fromPrivateKey(t){return I(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=Io(e,r.BYTES);return n[n.length-1]|=t&ns?128:0,n}toHex(){return mo(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,ns,h(e.Gx*e.Gy)),E.ZERO=new E(rs,ns,ns,rs);const{BASE:x,ZERO:B}=E,A=ts(E,8*a);function k(t){return jo(t,n)}function S(t){return k(ko(t))}function I(t){const e=a;t=To("private key",t,e);const r=To("hashed private key",o(t),2*e),n=f(r.slice(0,e)),i=r.slice(e,2*e),s=S(n),c=x.multiply(s),u=c.toRawBytes();return{head:n,prefix:i,scalar:s,point:c,pointBytes:u}}function T(t=new Uint8Array,...e){const r=Co(...e);return S(o(d(r,To("context",t),!!i)))}const C=ss;return x._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return I(t).pointBytes},sign:function(t,e,n={}){t=To("message",t),i&&(t=i(t));const{prefix:o,scalar:s,pointBytes:c}=I(e),u=T(n.context,o,t),h=x.multiply(u).toRawBytes(),l=k(u+T(n.context,h,c,t)*s);return b(l),To("result",Co(h,Io(l,r.BYTES)),2*a)},verify:function(t,e,n,o=C){const{context:s,zip215:a}=o,c=r.BYTES;t=To("signature",t,2*c),e=To("message",e),i&&(e=i(e));const u=ko(t.slice(c,2*c));let h,l,f;try{h=E.fromHex(n,a),l=E.fromHex(t.slice(0,c),a),f=x.multiplyUnsafe(u)}catch(t){return!1}if(!a&&h.isSmallOrder())return!1;const d=T(s,l.toRawBytes(),h.toRawBytes(),e);return l.add(h.multiplyUnsafe(d)).subtract(f).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>s(r.BYTES),precompute:(t=8,e=E.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}const cs=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),us=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),hs=(BigInt(0),BigInt(1)),ls=BigInt(2),fs=BigInt(5),ds=BigInt(10),ys=BigInt(20),ps=BigInt(40),gs=BigInt(80);const ws=Wo(cs,void 0,!0),bs={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ws,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:fo,randomBytes:Xi,adjustScalarBytes:function(t){return t[0]&=248,t[31]&=127,t[31]|=64,t},uvRatio:function(t,e){const r=cs,n=jo(e*e*e,r),i=jo(n*n*e,r);let o=jo(t*n*function(t){const e=cs,r=t*t%e*t%e,n=qo(r,ls,e)*r%e,i=qo(n,hs,e)*t%e,o=qo(i,fs,e)*i%e,s=qo(o,ds,e)*o%e,a=qo(s,ys,e)*s%e,c=qo(a,ps,e)*a%e,u=qo(c,gs,e)*c%e,h=qo(u,gs,e)*c%e,l=qo(h,ds,e)*o%e;return{pow_p_5_8:qo(l,ls,e)*t%e,b2:r}}(t*i).pow_p_5_8,r);const s=jo(e*o*o,r),a=o,c=jo(o*us,r),u=s===t,h=s===jo(-t,r),l=s===jo(-t*us,r);return u&&(o=a),(h||l)&&(o=c),(jo(o,r)&Vo)===Vo&&(o=jo(-o,r)),{isValid:u||h,value:o}}},ms=as(bs);const vs=(ws.ORDER+BigInt(3))/BigInt(8);ws.pow(ls,vs),ws.sqrt(ws.neg(ws.ONE)),ws.ORDER,BigInt(5),BigInt(8),BigInt(486662),function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const r=t.sqrt(e);t.isOdd(r)&&t.neg(r)}(ws,ws.neg(BigInt(486664))),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const Es=64,xs=32;function Bs(t,e){const r=new Uint8Array(Es);for(let n=0;n<xs;n++)r[n]=t[n],r[xs+n]=e[n];return r}class As{type="Ed25519";raw;constructor(t){this.raw=Ss(t,32)}toMultihash(){return Hi(jl(this))}toCID(){return _i.createV1(114,this.toMultihash())}toString(){return ci.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}verify(t,e){return function(t,e,r){return ms.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}(this.raw,e,t)}}class ks{type="Ed25519";raw;publicKey;constructor(t,e){this.raw=Ss(t,Es),this.publicKey=new As(e)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}sign(t){return function(t,e){const r=t.subarray(0,xs);return ms.sign(e instanceof Uint8Array?e:e.subarray(),r)}(this.raw,t)}}function Ss(t,e){if((t=Uint8Array.from(t??[])).length!==e)throw new Jn(`Key must be a Uint8Array of length ${e}, got ${t.length}`);return t}const Is=Math.pow(2,7),Ts=Math.pow(2,14),Cs=Math.pow(2,21),Us=Math.pow(2,28),Ls=Math.pow(2,35),Ns=Math.pow(2,42),Os=Math.pow(2,49),_s=128,Rs=127;function Ds(t){if(t<Is)return 1;if(t<Ts)return 2;if(t<Cs)return 3;if(t<Us)return 4;if(t<Ls)return 5;if(t<Ns)return 6;if(t<Os)return 7;if(null!=Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Vs(t,e,r=0){switch(Ds(t)){case 8:e[r++]=255&t|_s,t/=128;case 7:e[r++]=255&t|_s,t/=128;case 6:e[r++]=255&t|_s,t/=128;case 5:e[r++]=255&t|_s,t/=128;case 4:e[r++]=255&t|_s,t>>>=7;case 3:e[r++]=255&t|_s,t>>>=7;case 2:e[r++]=255&t|_s,t>>>=7;case 1:e[r++]=255&t,t>>>=7;break;default:throw new Error("unreachable")}return e}const Ms=new Float32Array([-0]),Ps=new Uint8Array(Ms.buffer);function Hs(t,e,r){Ms[0]=t,e[r]=Ps[0],e[r+1]=Ps[1],e[r+2]=Ps[2],e[r+3]=Ps[3]}const $s=new Float64Array([-0]),Fs=new Uint8Array($s.buffer);function js(t,e,r){$s[0]=t,e[r]=Fs[0],e[r+1]=Fs[1],e[r+2]=Fs[2],e[r+3]=Fs[3],e[r+4]=Fs[4],e[r+5]=Fs[5],e[r+6]=Fs[6],e[r+7]=Fs[7]}const zs=BigInt(Number.MAX_SAFE_INTEGER),qs=BigInt(Number.MIN_SAFE_INTEGER);class Ks{lo;hi;constructor(t,e){this.lo=0|t,this.hi=0|e}toNumber(t=!1){if(!t&&this.hi>>>31>0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(t+4294967296*e)}return this.lo+4294967296*this.hi}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(BigInt(t)+(BigInt(e)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){const t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){const t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){const t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}static fromBigInt(t){if(0n===t)return Gs;if(t<zs&&t>qs)return this.fromNumber(Number(t));const e=t<0n;e&&(t=-t);let r=t>>32n,n=t-(r<<32n);return e&&(r=0n|~r,n=0n|~n,++n>Js&&(n=0n,++r>Js&&(r=0n))),new Ks(Number(n),Number(r))}static fromNumber(t){if(0===t)return Gs;const e=t<0;e&&(t=-t);let r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new Ks(r,n)}static from(t){return"number"==typeof t?Ks.fromNumber(t):"bigint"==typeof t?Ks.fromBigInt(t):"string"==typeof t?Ks.fromBigInt(BigInt(t)):null!=t.low||null!=t.high?new Ks(t.low>>>0,t.high>>>0):Gs}}const Gs=new Ks(0,0);Gs.toBigInt=function(){return 0n},Gs.zzEncode=Gs.zzDecode=function(){return this},Gs.length=function(){return 1};const Js=4294967296n;function Ws(t,e,r){const n=r;let i,o;for(let n=0;n<t.length;++n)i=t.charCodeAt(n),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=t.charCodeAt(n+1)))?(i=65536+((1023&i)<<10)+(1023&o),++n,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=63&i|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=63&i|128);return r-n}function Zs(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Ys(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}class Qs{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Zs(this,10);return t}int32(){return 0|this.uint32()}sint32(){const t=this.uint32();return t>>>1^-(1&t)|0}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw Zs(this,4);return Ys(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Zs(this,4);return 0|Ys(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw Zs(this,4);const t=function(t,e){return Ps[0]=t[e],Ps[1]=t[e+1],Ps[2]=t[e+2],Ps[3]=t[e+3],Ms[0]}(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Zs(this,4);const t=function(t,e){return Fs[0]=t[e],Fs[1]=t[e+1],Fs[2]=t[e+2],Fs[3]=t[e+3],Fs[4]=t[e+4],Fs[5]=t[e+5],Fs[6]=t[e+6],Fs[7]=t[e+7],$s[0]}(this.buf,this.pos);return this.pos+=8,t}bytes(){const t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw Zs(this,t);return this.pos+=t,e===r?new Uint8Array(0):this.buf.subarray(e,r)}string(){const t=this.bytes();return function(t,e,r){if(r-e<1)return"";let n;const i=[];let o,s=0;for(;e<r;)o=t[e++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&t[e++]:o>239&&o<365?(o=((7&o)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((n??(n=[])).push(String.fromCharCode.apply(String,i)),s=0);return null!=n?(s>0&&n.push(String.fromCharCode.apply(String,i.slice(0,s))),n.join("")):String.fromCharCode.apply(String,i.slice(0,s))}(t,0,t.length)}skip(t){if("number"==typeof t){if(this.pos+t>this.len)throw Zs(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw Zs(this)}while(0!=(128&this.buf[this.pos++]));return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){const t=new Ks(0,0);let e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw Zs(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Zs(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Zs(this,8);const t=Ys(this.buf,this.pos+=4),e=Ys(this.buf,this.pos+=4);return new Ks(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const t=function(t,e){let r=t[e],n=0;if(n+=r&Rs,r<_s)return n;if(r=t[e+1],n+=(r&Rs)<<7,r<_s)return n;if(r=t[e+2],n+=(r&Rs)<<14,r<_s)return n;if(r=t[e+3],n+=(r&Rs)<<21,r<_s)return n;if(r=t[e+4],n+=(r&Rs)*Us,r<_s)return n;if(r=t[e+5],n+=(r&Rs)*Ls,r<_s)return n;if(r=t[e+6],n+=(r&Rs)*Ns,r<_s)return n;if(r=t[e+7],n+=(r&Rs)*Os,r<_s)return n;throw new RangeError("Could not decode varint")}(this.buf,this.pos);return this.pos+=Ds(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function Xs(t,e,r){const n=function(t){return new Qs(t instanceof Uint8Array?t:t.subarray())}(t);return e.decode(n,void 0,r)}function ta(t=0){return new Uint8Array(t)}function ea(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const ra=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var l=0,f=o-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*s[f]>>>0,s[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var l=e[i],f=0,d=s-1;(0!==l||f<n)&&-1!==d;d--,f++)l+=256*u[d]>>>0,u[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:l,decode:function(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class na{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ia{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return sa(this,t)}}class oa{decoders;constructor(t){this.decoders=t}or(t){return sa(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function sa(t,e){return new oa({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class aa{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new na(t,e,r),this.decoder=new ia(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function ca({name:t,prefix:e,encode:r,decode:n}){return new aa(t,e,r,n)}function ua({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=ra(r,t);return ca({prefix:e,name:t,encode:n,decode:t=>ea(i(t))})}function ha({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ca({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const la=ua({prefix:"9",name:"base10",alphabet:"0123456789"}),fa=ha({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),da=ha({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ya=ha({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),pa=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ga=pa.reduce(((t,e,r)=>(t[r]=e,t)),[]),wa=pa.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]),ba=ca({prefix:"🚀",name:"base256emoji",encode:function(t){return t.reduce(((t,e)=>t+ga[e]),"")},decode:function(t){const e=[];for(const r of t){const t=wa[r.codePointAt(0)];if(void 0===t)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}}),ma=ha({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),va=ha({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ea=ha({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),xa=ha({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ba=ha({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Aa=ha({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ka=ha({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Sa=ha({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ia=ha({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ta=ua({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ca=ua({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ua=ua({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),La=ua({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Na=ha({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Oa=ha({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_a=ha({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ra=ha({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Da=ha({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Va=ca({prefix:"\0",name:"identity",encode:t=>{return e=t,(new TextDecoder).decode(e);var e},decode:t=>function(t){return(new TextEncoder).encode(t)}(t)}),Ma=new TextEncoder,Pa=new TextDecoder,Ha="json",$a=512;function Fa(t){return Ma.encode(JSON.stringify(t))}function ja(t){return JSON.parse(Pa.decode(t))}const za="raw",qa=85;function Ka(t){return ea(t)}function Ga(t){return ea(t)}var Ja=128,Wa=-128,Za=Math.pow(2,31),Ya=128,Qa=127,Xa=Math.pow(2,7),tc=Math.pow(2,14),ec=Math.pow(2,21),rc=Math.pow(2,28),nc=Math.pow(2,35),ic=Math.pow(2,42),oc=Math.pow(2,49),sc=Math.pow(2,56),ac=Math.pow(2,63);const cc={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=Za;)r[n++]=255&e|Ja,e/=128;for(;e&Wa;)r[n++]=255&e|Ja,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&Qa)<<o:(n&Qa)*Math.pow(2,o),o+=7}while(n>=Ya);return t.bytes=s-r,i},encodingLength:function(t){return t<Xa?1:t<tc?2:t<ec?3:t<rc?4:t<nc?5:t<ic?6:t<oc?7:t<sc?8:t<ac?9:10}};function uc(t,e,r=0){return cc.encode(t,e,r),e}function hc(t){return cc.encodingLength(t)}function lc(t,e){const r=e.byteLength,n=hc(t),i=n+hc(r),o=new Uint8Array(i+r);return uc(t,o,0),uc(r,o,n),o.set(e,i),new fc(t,r,e,o)}class fc{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const dc=ea,yc={code:0,name:"identity",encode:dc,digest:function(t){return lc(0,dc(t))}};function pc({name:t,code:e,encode:r}){return new gc(t,e,r)}class gc{name;code;encode;constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?lc(this.code,e):e.then((t=>lc(this.code,t)))}throw Error("Unknown type, must be binary type")}}function wc(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const bc=pc({name:"sha2-256",code:18,encode:wc("SHA-256")}),mc=pc({name:"sha2-512",code:19,encode:wc("SHA-512")});new WeakMap,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const vc={...d,...s,...f,...i,...o,...c,...u,...h,...l,...a};function Ec(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const xc=Ec("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Bc=Ec("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{const e=ta((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),Ac={utf8:xc,"utf-8":xc,hex:vc.base16,latin1:Bc,ascii:Bc,binary:Bc,...vc};function kc(t,e="utf8"){const r=Ac[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}class Sc{fn;len;next;val;constructor(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}}function Ic(){}class Tc{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}}const Cc=function(t){const e=8192;let r,n=e;return function(t){if(t<1||t>4096)return ta(t);n+t>e&&(r=ta(e),n=0);const i=r.subarray(n,n+=t);return 0!=(7&n)&&(n=1+(7|n)),i}}();class Uc{len;head;tail;states;constructor(){this.len=0,this.head=new Sc(Ic,0,0),this.tail=this.head,this.states=null}_push(t,e,r){return this.tail=this.tail.next=new Sc(t,e,r),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Oc((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(_c,10,Ks.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){const e=Ks.fromBigInt(t);return this._push(_c,e.length(),e)}uint64Number(t){return this._push(Vs,Ds(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){const e=Ks.fromBigInt(t).zzEncode();return this._push(_c,e.length(),e)}sint64Number(t){const e=Ks.fromNumber(t).zzEncode();return this._push(_c,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Lc,1,t?1:0)}fixed32(t){return this._push(Rc,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){const e=Ks.fromBigInt(t);return this._push(Rc,4,e.lo)._push(Rc,4,e.hi)}fixed64Number(t){const e=Ks.fromNumber(t);return this._push(Rc,4,e.lo)._push(Rc,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(Hs,4,t)}double(t){return this._push(js,8,t)}bytes(t){const e=t.length>>>0;return 0===e?this._push(Lc,1,0):this.uint32(e)._push(Dc,e,t)}string(t){const e=function(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e}(t);return 0!==e?this.uint32(e)._push(Ws,e,t):this._push(Lc,1,0)}fork(){return this.states=new Tc(this),this.head=this.tail=new Sc(Ic,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Sc(Ic,0,0),this.len=0),this}ldelim(){const t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),0!==r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this}finish(){let t=this.head.next;const e=(r=this.len,null!=globalThis.Buffer?ta(r):Cc(r));var r;let n=0;for(;null!=t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}}function Lc(t,e,r){e[r]=255&t}function Nc(t,e,r){for(;t>127;)e[r++]=127&t|128,t>>>=7;e[r]=t}class Oc extends Sc{next;constructor(t,e){super(Nc,t,e),this.next=void 0}}function _c(t,e,r){for(;0!==t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Rc(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Dc(t,e,r){e.set(t,r)}function Vc(t,e,r){e.set(t,r)}function Mc(t,e,r){t.length<40?Ws(t,e,r):null!=e.utf8Write?e.utf8Write(t,r):e.set(kc(t),r)}function Pc(t,e){const r=new Uc;return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Hc,$c,Fc,jc,zc;function qc(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Kc(t,e){return qc("message",Hc.LENGTH_DELIMITED,t,e)}null!=globalThis.Buffer&&(Uc.prototype.bytes=function(t){const e=t.length>>>0;return this.uint32(e),e>0&&this._push(Vc,e,t),this},Uc.prototype.string=function(t){const e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(Mc,e,t),this}),function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"}(Hc||(Hc={})),function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.secp256k1="secp256k1"}($c||($c={})),function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.secp256k1=2]="secp256k1"}(Fc||(Fc={})),function(t){t.codec=()=>function(t){function e(e){if(null==t[e.toString()])throw new Error("Invalid enum value");return t[e]}return qc("enum",Hc.VARINT,(function(t,r){const n=e(t);r.int32(n)}),(function(t){return e(t.int32())}))}(Fc)}($c||($c={})),function(t){let e;t.codec=()=>(null==e&&(e=Kc(((t,e,r={})=>{!1!==r.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),$c.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==r.lengthDelimited&&e.ldelim()}),((t,e,r={})=>{const n={},i=null==e?t.len:t.pos+e;for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:n.Type=$c.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>Pc(e,t.codec()),t.decode=(e,r)=>Xs(e,t.codec(),r)}(jc||(jc={})),function(t){let e;t.codec=()=>(null==e&&(e=Kc(((t,e,r={})=>{!1!==r.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),$c.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==r.lengthDelimited&&e.ldelim()}),((t,e,r={})=>{const n={},i=null==e?t.len:t.pos+e;for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:n.Type=$c.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>Pc(e,t.codec()),t.decode=(e,r)=>Xs(e,t.codec(),r)}(zc||(zc={}));const Gc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Jc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Wc=new Uint32Array(64);class Zc extends eo{constructor(){super(64,32,8,!1),this.A=0|Jc[0],this.B=0|Jc[1],this.C=0|Jc[2],this.D=0|Jc[3],this.E=0|Jc[4],this.F=0|Jc[5],this.G=0|Jc[6],this.H=0|Jc[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)Wc[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Wc[t-15],r=Wc[t-2],n=Gi(e,7)^Gi(e,18)^e>>>3,i=Gi(r,17)^Gi(r,19)^r>>>10;Wc[t]=i+Wc[t-7]+n+Wc[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Gi(s,6)^Gi(s,11)^Gi(s,25))+((h=s)&a^~h&c)+Gc[t]+Wc[t]|0,l=(Gi(r,2)^Gi(r,13)^Gi(r,22))+to(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+l|0}var h;r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){Wc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Yc=Qi((()=>new Zc));var Qc=r(43);function Xc(t,e){let r=0;if(1===t.length)return t[0];for(let n=t.length-1;n>=0;n--)r+=t[t.length-1-n]*Math.pow(2,e*n);return r}function tu(t,e,r=-1){const n=r;let i=t,o=0,s=Math.pow(2,e);for(let r=1;r<8;r++){if(t<s){let t;if(n<0)t=new ArrayBuffer(r),o=r;else{if(n<r)return new ArrayBuffer(0);t=new ArrayBuffer(n),o=n}const s=new Uint8Array(t);for(let t=r-1;t>=0;t--){const r=Math.pow(2,t*e);s[o-t-1]=Math.floor(i/r),i-=s[o-t-1]*r}return t}s*=Math.pow(2,e)}return new ArrayBuffer(0)}function eu(...t){let e=0,r=0;for(const r of t)e+=r.length;const n=new ArrayBuffer(e),i=new Uint8Array(n);for(const e of t)i.set(e,r),r+=e.length;return i}function ru(){const t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const e=255===t[0]&&128&t[1],r=0===t[0]&&0==(128&t[1]);(e||r)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(e);for(let t=0;t<this.valueHex.byteLength;t++)r[t]=0;r[0]=128&t[0];const n=Xc(r,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let e=0;e<this.valueHex.byteLength;e++)o[e]=t[e];return o[0]&=127,Xc(o,8)-n}function nu(t,e){const r=t.toString(10);if(e<r.length)return"";const n=e-r.length,i=new Array(n);for(let t=0;t<n;t++)i[t]="0";return i.join("").concat(r)}function iu(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ou(t){let e=0,r=0;for(let r=0;r<t.length;r++)e+=t[r].byteLength;const n=new Uint8Array(e);for(let e=0;e<t.length;e++){const i=t[e];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function su(t,e,r,n){return e instanceof Uint8Array?e.byteLength?r<0?(t.error="Wrong parameter: inputOffset less than zero",!1):n<0?(t.error="Wrong parameter: inputLength less than zero",!1):!(e.byteLength-r-n<0&&(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}Math.log(2);class au{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return ou(this.items)}}const cu=[new Uint8Array([1])],uu="0123456789",hu="",lu=new ArrayBuffer(0),fu=new Uint8Array(0),du="EndOfContent",yu="OCTET STRING",pu="BIT STRING";function gu(t){var e;return(e=class extends t{constructor(...t){var e;super(...t);const r=t[0]||{};this.isHexOnly=null!==(e=r.isHexOnly)&&void 0!==e&&e,this.valueHexView=r.valueHex?Qc.vJ.toUint8Array(r.valueHex):fu}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,e,r){const n=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!su(this,n,e,r))return-1;const i=e+r;return this.valueHexView=n.subarray(e,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),e)}toBER(t=!1){return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",lu)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Qc.ep.ToHex(this.valueHexView)}}}).NAME="hexBlock",e}class wu{constructor({blockLength:t=0,error:e="",warnings:r=[],valueBeforeDecode:n=fu}={}){this.blockLength=t,this.error=e,this.warnings=r,this.valueBeforeDecodeView=Qc.vJ.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Qc.ep.ToHex(this.valueBeforeDecodeView)}}}wu.NAME="baseBlock";class bu extends wu{fromBER(t,e,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}bu.NAME="valueBlock";class mu extends(gu(wu)){constructor({idBlock:t={}}={}){var e,r,n,i;super(),t?(this.isHexOnly=null!==(e=t.isHexOnly)&&void 0!==e&&e,this.valueHexView=t.valueHex?Qc.vJ.toUint8Array(t.valueHex):fu,this.tagClass=null!==(r=t.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=t.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=t.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",lu}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!t){let t=this.tagNumber;t&=31,e|=t,r[0]=e}return r.buffer}if(!this.isHexOnly){const r=tu(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,o=new Uint8Array(i+1);if(o[0]=31|e,!t){for(let t=0;t<i-1;t++)o[t+1]=128|n[t];o[i]=n[i-1]}return o.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|e,!t){const t=this.valueHexView;for(let e=0;e<t.length-1;e++)r[e+1]=128|t[e];r[this.valueHexView.byteLength]=t[t.length-1]}return r.buffer}fromBER(t,e,r){const n=Qc.vJ.toUint8Array(t);if(!su(this,n,e,r))return-1;const i=n.subarray(e,e+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&i[0]),this.isHexOnly=!1;const o=31&i[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let t=1,e=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[t];){if(e[t-1]=127&i[t],t++,t>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(t===r){r+=255;const t=new Uint8Array(r);for(let r=0;r<e.length;r++)t[r]=e[r];e=this.valueHexView=new Uint8Array(r)}}this.blockLength=t+1,e[t-1]=127&i[t];const n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e[r];e=this.valueHexView=new Uint8Array(t),e.set(n),this.blockLength<=9?this.tagNumber=Xc(e,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}mu.NAME="identificationBlock";class vu extends wu{constructor({lenBlock:t={}}={}){var e,r,n;super(),this.isIndefiniteForm=null!==(e=t.isIndefiniteForm)&&void 0!==e&&e,this.longFormUsed=null!==(r=t.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=t.length)&&void 0!==n?n:0}fromBER(t,e,r){const n=Qc.vJ.toUint8Array(t);if(!su(this,n,e,r))return-1;const i=n.subarray(e,e+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,e+this.blockLength;const o=127&i[0];if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const s=e+1,a=n.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=Xc(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,e+this.blockLength}toBER(t=!1){let e,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),!1===t&&(r=new Uint8Array(e),r[0]=128),e;if(this.longFormUsed){const n=tu(this.length,8);if(n.byteLength>127)return this.error="Too big length",lu;if(e=new ArrayBuffer(n.byteLength+1),t)return e;const i=new Uint8Array(n);r=new Uint8Array(e),r[0]=128|n.byteLength;for(let t=0;t<n.byteLength;t++)r[t+1]=i[t];return e}return e=new ArrayBuffer(1),!1===t&&(r=new Uint8Array(e),r[0]=this.length),e}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}vu.NAME="lengthBlock";const Eu={};class xu extends wu{constructor({name:t="",optional:e=!1,primitiveSchema:r,...n}={},i){super(n),this.name=t,this.optional=e,r&&(this.primitiveSchema=r),this.idBlock=new mu(n),this.lenBlock=new vu(n),this.valueBlock=i?new i(n):new bu(n)}fromBER(t,e,r){const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(t,e){const r=e||new au;e||Bu(this);const n=this.idBlock.toBER(t);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,r),r.write(new ArrayBuffer(2));else{const e=this.valueBlock.toBER(t);this.lenBlock.length=e.byteLength;const n=this.lenBlock.toBER(t);r.write(n),r.write(e)}return e?lu:r.final()}toJSON(){const t={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return"ascii"===t?this.onAsciiEncoding():Qc.ep.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${Qc.ep.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(t){return this===t||t instanceof this.constructor&&function(t,e){if(t.byteLength!==e.byteLength)return!1;const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]!==n[t])return!1;return!0}(this.toBER(),t.toBER())}}function Bu(t){if(t instanceof Eu.Constructed)for(const e of t.valueBlock.value)Bu(e)&&(t.lenBlock.isIndefiniteForm=!0);return!!t.lenBlock.isIndefiniteForm}xu.NAME="BaseBlock";class Au extends xu{constructor({value:t="",...e}={},r){super(e,r),t&&this.fromString(t)}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}fromBER(t,e,r){const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Au.NAME="BaseStringBlock";class ku extends(gu(bu)){constructor({isHexOnly:t=!0,...e}={}){super(e),this.isHexOnly=t}}var Su,Iu,Tu,Cu,Uu,Lu,Nu,Ou,_u,Ru,Du,Vu,Mu,Pu,Hu,$u,Fu,ju,zu,qu,Ku,Gu,Ju,Wu,Zu,Yu,Qu,Xu,th,eh,rh,nh,ih;ku.NAME="PrimitiveValueBlock";class oh extends xu{constructor(t={}){super(t,ku),this.idBlock.isConstructed=!1}}function sh(t,e=0,r=t.length){const n=e;let i=new xu({},bu);const o=new wu;if(!su(o,t,e,r))return i.error=o.error,{offset:-1,result:i};if(!t.subarray(e,e+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(t,e,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===s)return i.error=i.idBlock.error,{offset:-1,result:i};if(e=s,r-=i.idBlock.blockLength,s=i.lenBlock.fromBER(t,e,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===s)return i.error=i.lenBlock.error,{offset:-1,result:i};if(e=s,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=xu;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=Eu.EndOfContent;break;case 1:a=Eu.Boolean;break;case 2:a=Eu.Integer;break;case 3:a=Eu.BitString;break;case 4:a=Eu.OctetString;break;case 5:a=Eu.Null;break;case 6:a=Eu.ObjectIdentifier;break;case 10:a=Eu.Enumerated;break;case 12:a=Eu.Utf8String;break;case 13:a=Eu.RelativeObjectIdentifier;break;case 14:a=Eu.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=Eu.Sequence;break;case 17:a=Eu.Set;break;case 18:a=Eu.NumericString;break;case 19:a=Eu.PrintableString;break;case 20:a=Eu.TeletexString;break;case 21:a=Eu.VideotexString;break;case 22:a=Eu.IA5String;break;case 23:a=Eu.UTCTime;break;case 24:a=Eu.GeneralizedTime;break;case 25:a=Eu.GraphicString;break;case 26:a=Eu.VisibleString;break;case 27:a=Eu.GeneralString;break;case 28:a=Eu.UniversalString;break;case 29:a=Eu.CharacterString;break;case 30:a=Eu.BmpString;break;case 31:a=Eu.DATE;break;case 32:a=Eu.TimeOfDay;break;case 33:a=Eu.DateTime;break;case 34:a=Eu.Duration;break;default:{const t=i.idBlock.isConstructed?new Eu.Constructed:new Eu.Primitive;t.idBlock=i.idBlock,t.lenBlock=i.lenBlock,t.warnings=i.warnings,i=t}}}else a=i.idBlock.isConstructed?Eu.Constructed:Eu.Primitive;return i=function(t,e){if(t instanceof e)return t;const r=new e;return r.idBlock=t.idBlock,r.lenBlock=t.lenBlock,r.warnings=t.warnings,r.valueBeforeDecodeView=t.valueBeforeDecodeView,r}(i,a),s=i.fromBER(t,e,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=t.subarray(n,n+i.blockLength),{offset:s,result:i}}function ah(t){if(!t.byteLength){const t=new xu({},bu);return t.error="Input buffer has zero length",{offset:-1,result:t}}return sh(Qc.vJ.toUint8Array(t).slice(),0,t.byteLength)}Su=oh,Eu.Primitive=Su,oh.NAME="PRIMITIVE";class ch extends bu{constructor({value:t=[],isIndefiniteForm:e=!1,...r}={}){super(r),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,r){const n=Qc.vJ.toUint8Array(t);if(!su(this,n,e,r))return-1;if(this.valueBeforeDecodeView=n.subarray(e,e+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),e;let i=e;for(;(this.isIndefiniteForm?1:r)>0;){const t=sh(n,i,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(i=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),this.isIndefiniteForm&&t.result.constructor.NAME===du)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===du?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(t,e){const r=e||new au;for(let e=0;e<this.value.length;e++)this.value[e].toBER(t,r);return e?lu:r.final()}toJSON(){const t={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const e of this.value)t.value.push(e.toJSON());return t}}ch.NAME="ConstructedValueBlock";class uh extends xu{constructor(t={}){super(t,ch),this.idBlock.isConstructed=!0}fromBER(t,e,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const t=[];for(const e of this.valueBlock.value)t.push(e.toString("ascii").split("\n").map((t=>`  ${t}`)).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return t.length?`${e} :\n${t.join("\n")}`:`${e} :`}}Iu=uh,Eu.Constructed=Iu,uh.NAME="CONSTRUCTED";class hh extends bu{fromBER(t,e,r){return e}toBER(t){return lu}}hh.override="EndOfContentValueBlock";class lh extends xu{constructor(t={}){super(t,hh),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Tu=lh,Eu.EndOfContent=Tu,lh.NAME=du;class fh extends xu{constructor(t={}){super(t,bu),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,e+r>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+r}toBER(t,e){const r=new ArrayBuffer(2);if(!t){const t=new Uint8Array(r);t[0]=5,t[1]=0}return e&&e.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}Cu=fh,Eu.Null=Cu,fh.NAME="NULL";class dh extends(gu(bu)){constructor({value:t,...e}={}){super(e),e.valueHex?this.valueHexView=Qc.vJ.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}fromBER(t,e,r){const n=Qc.vJ.toUint8Array(t);return su(this,n,e,r)?(this.valueHexView=n.subarray(e,e+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,ru.call(this),this.blockLength=r,e+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}dh.NAME="BooleanValueBlock";class yh extends xu{constructor(t={}){super(t,dh),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Uu=yh,Eu.Boolean=Uu,yh.NAME="BOOLEAN";class ph extends(gu(ch)){constructor({isConstructed:t=!1,...e}={}){super(e),this.isConstructed=t}fromBER(t,e,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=ch.prototype.fromBER.call(this,t,e,r),-1===n)return n;for(let t=0;t<this.value.length;t++){const e=this.value[t].constructor.NAME;if(e===du){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(e!==yu)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(t,e,r),this.blockLength=r;return n}toBER(t,e){return this.isConstructed?ch.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}ph.NAME="OctetStringValueBlock";class gh extends xu{constructor({idBlock:t={},lenBlock:e={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!r.isIndefiniteForm},...r},ph),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(t,e,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const n=(t instanceof ArrayBuffer?new Uint8Array(t):t).subarray(e,e+r);try{if(n.byteLength){const t=sh(n,0,n.byteLength);-1!==t.offset&&t.offset===r&&(this.valueBlock.value=[t.result])}}catch(t){}}return super.fromBER(t,e,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?uh.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${Qc.ep.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const t=[];for(const e of this.valueBlock.value)e instanceof gh&&t.push(e.valueBlock.valueHexView);return Qc.vJ.concat(t)}}Lu=gh,Eu.OctetString=Lu,gh.NAME=yu;class wh extends(gu(ch)){constructor({unusedBits:t=0,isConstructed:e=!1,...r}={}){super(r),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,r){if(!r)return e;let n=-1;if(this.isConstructed){if(n=ch.prototype.fromBER.call(this,t,e,r),-1===n)return n;for(const t of this.value){const e=t.constructor.NAME;if(e===du){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(e!==pu)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=t.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=Qc.vJ.toUint8Array(t);if(!su(this,i,e,r))return-1;const o=i.subarray(e,e+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const t=o.subarray(1);try{if(t.byteLength){const e=sh(t,0,t.byteLength);-1!==e.offset&&e.offset===r-1&&(this.value=[e.result])}}catch(t){}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,e+r}toBER(t,e){if(this.isConstructed)return ch.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return lu;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}wh.NAME="BitStringValueBlock";class bh extends xu{constructor({idBlock:t={},lenBlock:e={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!r.isIndefiniteForm},...r},wh),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(t,e,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(t,e,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return uh.prototype.onAsciiEncoding.call(this);{const t=[],e=this.valueBlock.valueHexView;for(const r of e)t.push(r.toString(2).padStart(8,"0"));const r=t.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function mh(t,e){const r=new Uint8Array([0]),n=new Uint8Array(t),i=new Uint8Array(e);let o=n.slice(0);const s=o.length-1,a=i.slice(0),c=a.length-1;let u=0,h=0;for(let t=c<s?s:c;t>=0;t--,h++)u=1==h<a.length?o[s-h]+a[c-h]+r[0]:o[s-h]+r[0],r[0]=u/10,1==h>=o.length?o=eu(new Uint8Array([u%10]),o):o[s-h]=u%10;return r[0]>0&&(o=eu(r,o)),o}function vh(t){if(t>=cu.length)for(let e=cu.length;e<=t;e++){const t=new Uint8Array([0]);let r=cu[e-1].slice(0);for(let e=r.length-1;e>=0;e--){const n=new Uint8Array([(r[e]<<1)+t[0]]);t[0]=n[0]/10,r[e]=n[0]%10}t[0]>0&&(r=eu(t,r)),cu.push(r)}return cu[t]}function Eh(t,e){let r=0;const n=new Uint8Array(t),i=new Uint8Array(e),o=n.slice(0),s=o.length-1,a=i.slice(0),c=a.length-1;let u,h=0;for(let t=c;t>=0;t--,h++)u=o[s-h]-a[c-h]-r,1==u<0?(r=1,o[s-h]=u+10):(r=0,o[s-h]=u);if(r>0)for(let t=s-c+1;t>=0;t--,h++){if(u=o[s-h]-r,!(u<0)){r=0,o[s-h]=u;break}r=1,o[s-h]=u+10}return o.slice()}Nu=bh,Eu.BitString=Nu,bh.NAME=pu;class xh extends(gu(bu)){constructor({value:t,...e}={}){super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),void 0!==t&&(this.valueDec=t)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=ru.call(this)))}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(t){const e=t<0?-1*t:t;let r=128;for(let n=1;n<8;n++){if(e<=r){if(t<0){const t=tu(r-e,8,n);return new Uint8Array(t)[0]|=128,t}let i=tu(e,8,n),o=new Uint8Array(i);if(128&o[0]){const t=i.slice(0),e=new Uint8Array(t);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let r=0;r<t.byteLength;r++)o[r+1]=e[r];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(t))}get valueDec(){return this._valueDec}fromDER(t,e,r,n=0){const i=this.fromBER(t,e,r);if(-1===i)return i;const o=this.valueHexView;return 0===o[0]&&0!=(128&o[1])?this.valueHexView=o.subarray(1):0!==n&&o.length<n&&(n-o.length>1&&(n=o.length+1),this.valueHexView=o.subarray(n-o.length)),i}toDER(t=!1){const e=this.valueHexView;switch(!0){case 0!=(128&e[0]):{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(e,1),this.valueHexView=t}break;case 0===e[0]&&0==(128&e[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(t)}fromBER(t,e,r){const n=super.fromBER(t,e,r);return-1===n||this.setValueHex(),n}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const t=8*this.valueHexView.length-1;let e,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let o="",s=!1;for(let s=i.byteLength-1;s>=0;s--){e=i[s];for(let i=0;i<8;i++)1==(1&e)&&(n===t?(r=Eh(vh(n),r),o="-"):r=mh(r,vh(n))),n++,e>>=1}for(let t=0;t<r.length;t++)r[t]&&(s=!0),s&&(o+=uu.charAt(r[t]));return!1===s&&(o+=uu.charAt(0)),o}}Ou=xh,xh.NAME="IntegerValueBlock",Object.defineProperty(Ou.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Bh extends xu{constructor(t={}){super(t,xh),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return iu(),BigInt(this.valueBlock.toString())}static fromBigInt(t){iu();const e=BigInt(t),r=new au,n=e.toString(16).replace(/^-/,""),i=new Uint8Array(Qc.ep.FromHex(n));if(e<0){const t=new Uint8Array(i.length+(128&i[0]?1:0));t[0]|=128;const n=BigInt(`0x${Qc.ep.ToHex(t)}`)+e,o=Qc.vJ.toUint8Array(Qc.ep.FromHex(n.toString(16)));o[0]|=128,r.write(o)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new Bh({valueHex:r.final()})}convertToDER(){const t=new Bh({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new Bh({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}_u=Bh,Eu.Integer=_u,Bh.NAME="INTEGER";class Ah extends Bh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Ru=Ah,Eu.Enumerated=Ru,Ah.NAME="ENUMERATED";class kh extends(gu(bu)){constructor({valueDec:t=-1,isFirstSid:e=!1,...r}={}){super(r),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,r){if(!r)return e;const n=Qc.vJ.toUint8Array(t);if(!su(this,n,e,r))return-1;const i=n.subarray(e,e+r);this.valueHexView=new Uint8Array(r);for(let t=0;t<r&&(this.valueHexView[t]=127&i[t],this.blockLength++,0!=(128&i[t]));t++);const o=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++)o[t]=this.valueHexView[t];return this.valueHexView=o,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Xc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){iu();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const r=new Uint8Array(e.length/7);for(let t=0;t<r.length;t++)r[t]=parseInt(e.slice(7*t,7*t+7),2)+(t+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView,r=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)r[t]=128|e[t];return r[this.blockLength-1]=e[this.blockLength-1],r.buffer}const e=tu(this.valueDec,7);if(0===e.byteLength)return this.error="Error during encoding SID value",lu;const r=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e),n=e.byteLength-1;for(let e=0;e<n;e++)r[e]=128|t[e];r[n]=t[n]}return r}toString(){let t="";if(this.isHexOnly)t=Qc.ep.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}kh.NAME="sidBlock";class Sh extends bu{constructor({value:t="",...e}={}){super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,r){let n=e;for(;r>0;){const e=new kh;if(n=e.fromBER(t,n,r),-1===n)return this.blockLength=0,this.error=e.error,n;0===this.value.length&&(e.isFirstSid=!0),this.blockLength+=e.blockLength,r-=e.blockLength,this.value.push(e)}return n}toBER(t){const e=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(t);if(0===n.byteLength)return this.error=this.value[r].error,lu;e.push(n)}return ou(e)}fromString(t){this.value=[];let e=0,r=0,n="",i=!1;do{if(r=t.indexOf(".",e),n=-1===r?t.substring(e):t.substring(e,r),e=r+1,i){const t=this.value[0];let e=0;switch(t.valueDec){case 0:break;case 1:e=40;break;case 2:e=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;t.valueDec=r+e,i=!1}else{const t=new kh;if(n>Number.MAX_SAFE_INTEGER){iu();const e=BigInt(n);t.valueBigInt=e}else if(t.valueDec=parseInt(n,10),isNaN(t.valueDec))return;this.value.length||(t.isFirstSid=!0,i=!0),this.value.push(t)}}while(-1!==r)}toString(){let t="",e=!1;for(let r=0;r<this.value.length;r++){e=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(t=`${t}.`),e?(n=`{${n}}`,this.value[r].isFirstSid?t=`2.{${n} - 80}`:t+=n):t+=n}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Sh.NAME="ObjectIdentifierValueBlock";class Ih extends xu{constructor(t={}){super(t,Sh),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Du=Ih,Eu.ObjectIdentifier=Du,Ih.NAME="OBJECT IDENTIFIER";class Th extends(gu(wu)){constructor({valueDec:t=0,...e}={}){super(e),this.valueDec=t}fromBER(t,e,r){if(0===r)return e;const n=Qc.vJ.toUint8Array(t);if(!su(this,n,e,r))return-1;const i=n.subarray(e,e+r);this.valueHexView=new Uint8Array(r);for(let t=0;t<r&&(this.valueHexView[t]=127&i[t],this.blockLength++,0!=(128&i[t]));t++);const o=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++)o[t]=this.valueHexView[t];return this.valueHexView=o,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Xc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView,r=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)r[t]=128|e[t];return r[this.blockLength-1]=e[this.blockLength-1],r.buffer}const e=tu(this.valueDec,7);if(0===e.byteLength)return this.error="Error during encoding SID value",lu;const r=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e),n=e.byteLength-1;for(let e=0;e<n;e++)r[e]=128|t[e];r[n]=t[n]}return r.buffer}toString(){let t="";return t=this.isHexOnly?Qc.ep.ToHex(this.valueHexView):this.valueDec.toString(),t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Th.NAME="relativeSidBlock";class Ch extends bu{constructor({value:t="",...e}={}){super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,r){let n=e;for(;r>0;){const e=new Th;if(n=e.fromBER(t,n,r),-1===n)return this.blockLength=0,this.error=e.error,n;this.blockLength+=e.blockLength,r-=e.blockLength,this.value.push(e)}return n}toBER(t,e){const r=[];for(let e=0;e<this.value.length;e++){const n=this.value[e].toBER(t);if(0===n.byteLength)return this.error=this.value[e].error,lu;r.push(n)}return ou(r)}fromString(t){this.value=[];let e=0,r=0,n="";do{r=t.indexOf(".",e),n=-1===r?t.substring(e):t.substring(e,r),e=r+1;const i=new Th;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let t="",e=!1;for(let r=0;r<this.value.length;r++){e=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(t=`${t}.`),e?(n=`{${n}}`,t+=n):t+=n}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Ch.NAME="RelativeObjectIdentifierValueBlock";class Uh extends xu{constructor(t={}){super(t,Ch),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Vu=Uh,Eu.RelativeObjectIdentifier=Vu,Uh.NAME="RelativeObjectIdentifier";class Lh extends uh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Mu=Lh,Eu.Sequence=Mu,Lh.NAME="SEQUENCE";class Nh extends uh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Pu=Nh,Eu.Set=Pu,Nh.NAME="SET";class Oh extends(gu(bu)){constructor({...t}={}){super(t),this.isHexOnly=!0,this.value=hu}toJSON(){return{...super.toJSON(),value:this.value}}}Oh.NAME="StringValueBlock";class _h extends Oh{}_h.NAME="SimpleStringValueBlock";class Rh extends Au{constructor({...t}={}){super(t,_h)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,Qc.vJ.toUint8Array(t))}fromString(t){const e=t.length,r=this.valueBlock.valueHexView=new Uint8Array(e);for(let n=0;n<e;n++)r[n]=t.charCodeAt(n);this.valueBlock.value=t}}Rh.NAME="SIMPLE STRING";class Dh extends Rh{fromBuffer(t){this.valueBlock.valueHexView=Qc.vJ.toUint8Array(t);try{this.valueBlock.value=Qc.ep.ToUtf8String(t)}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`),this.valueBlock.value=Qc.ep.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(Qc.ep.FromUtf8String(t)),this.valueBlock.value=t}}Dh.NAME="Utf8StringValueBlock";class Vh extends Dh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Hu=Vh,Eu.Utf8String=Hu,Vh.NAME="UTF8String";class Mh extends Rh{fromBuffer(t){this.valueBlock.value=Qc.ep.ToUtf16String(t),this.valueBlock.valueHexView=Qc.vJ.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(Qc.ep.FromUtf16String(t))}}Mh.NAME="BmpStringValueBlock";class Ph extends Mh{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}$u=Ph,Eu.BmpString=$u,Ph.NAME="BMPString";class Hh extends Rh{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),r=new Uint8Array(e);for(let t=0;t<r.length;t+=4)r[t]=r[t+3],r[t+1]=r[t+2],r[t+2]=0,r[t+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,r=this.valueBlock.valueHexView=new Uint8Array(4*e);for(let n=0;n<e;n++){const e=tu(t.charCodeAt(n),8),i=new Uint8Array(e);if(i.length>4)continue;const o=4-i.length;for(let t=i.length-1;t>=0;t--)r[4*n+t+o]=i[t]}this.valueBlock.value=t}}Hh.NAME="UniversalStringValueBlock";class $h extends Hh{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Fu=$h,Eu.UniversalString=Fu,$h.NAME="UniversalString";class Fh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}ju=Fh,Eu.NumericString=ju,Fh.NAME="NumericString";class jh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}zu=jh,Eu.PrintableString=zu,jh.NAME="PrintableString";class zh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}qu=zh,Eu.TeletexString=qu,zh.NAME="TeletexString";class qh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Ku=qh,Eu.VideotexString=Ku,qh.NAME="VideotexString";class Kh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Gu=Kh,Eu.IA5String=Gu,Kh.NAME="IA5String";class Gh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Ju=Gh,Eu.GraphicString=Ju,Gh.NAME="GraphicString";class Jh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Wu=Jh,Eu.VisibleString=Wu,Jh.NAME="VisibleString";class Wh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Zu=Wh,Eu.GeneralString=Zu,Wh.NAME="GeneralString";class Zh extends Rh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Yu=Zh,Eu.CharacterString=Yu,Zh.NAME="CharacterString";class Yh extends Jh{constructor({value:t,valueDate:e,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let e=0;e<t.length;e++)this.valueBlock.valueHexView[e]=t.charCodeAt(e)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,Qc.vJ.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(t);if(null===e)return void(this.error="Wrong input string for conversion");const r=parseInt(e[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(t="iso"){if("iso"===t){const t=new Array(7);return t[0]=nu(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=nu(this.month,2),t[2]=nu(this.day,2),t[3]=nu(this.hour,2),t[4]=nu(this.minute,2),t[5]=nu(this.second,2),t[6]="Z",t.join("")}return super.toString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Qu=Yh,Eu.UTCTime=Qu,Yh.NAME="UTCTime";class Qh extends Yh{constructor(t={}){var e;super(t),null!==(e=this.millisecond)&&void 0!==e||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let e,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===t[t.length-1])n=t.substring(0,t.length-1),r=!0;else{const e=new Number(t[t.length-1]);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");n=t}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let t=1,e=n.indexOf("+"),r="";if(-1===e&&(e=n.indexOf("-"),t=-1),-1!==e){if(r=n.substring(e+1),n=n.substring(0,e),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(s=t*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=t*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const t=new Number(`0${n.substring(c)}`);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");o=t.valueOf(),i=n.substring(0,c)}else i=n;switch(!0){case 8===i.length:if(e=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let t=60*o;this.minute=Math.floor(t),t=60*(t-this.minute),this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 12===i.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let t=60*o;this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 14===i.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const t=1e3*o;this.millisecond=Math.floor(t)}break;default:throw new Error("Wrong input string for conversion")}const u=e.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let t=1;t<u.length;t++)switch(t){case 1:this.year=parseInt(u[t],10);break;case 2:this.month=parseInt(u[t],10);break;case 3:this.day=parseInt(u[t],10);break;case 4:this.hour=parseInt(u[t],10)+s;break;case 5:this.minute=parseInt(u[t],10)+a;break;case 6:this.second=parseInt(u[t],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const t=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=t.getUTCFullYear(),this.month=t.getUTCMonth(),this.day=t.getUTCDay(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds(),this.millisecond=t.getUTCMilliseconds()}}toString(t="iso"){if("iso"===t){const t=[];return t.push(nu(this.year,4)),t.push(nu(this.month,2)),t.push(nu(this.day,2)),t.push(nu(this.hour,2)),t.push(nu(this.minute,2)),t.push(nu(this.second,2)),0!==this.millisecond&&(t.push("."),t.push(nu(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(t)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Xu=Qh,Eu.GeneralizedTime=Xu,Qh.NAME="GeneralizedTime";class Xh extends Vh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}th=Xh,Eu.DATE=th,Xh.NAME="DATE";class tl extends Vh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}eh=tl,Eu.TimeOfDay=eh,tl.NAME="TimeOfDay";class el extends Vh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}rh=el,Eu.DateTime=rh,el.NAME="DateTime";class rl extends Vh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}nh=rl,Eu.Duration=nh,rl.NAME="Duration";class nl extends Vh{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}function il(t,e="utf8"){const r=Ac[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}ih=nl,Eu.TIME=ih,nl.NAME="TIME";class ol extends Error{constructor(t="An error occurred while signing a message"){super(t),this.name="SigningError"}}class sl extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}}class al extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}}const cl={get(t=globalThis){const e=t.crypto;if(null==e?.subtle)throw new al("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return e}};function ul(t){if("RSA"!==t.kty)throw new Jn("invalid key type");if(null==t.n)throw new Jn("invalid key modulus");return 8*kc(t.n,"base64url").length}class hl{type="RSA";_key;_raw;_multihash;constructor(t,e){this._key=t,this._multihash=e}get raw(){return null==this._raw&&(this._raw=yl(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return _i.createV1(114,this._multihash)}toString(){return ci.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}verify(t,e){return async function(t,e,r){const n=await cl.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return cl.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}(this._key,e,t)}}class ll{type="RSA";_key;_raw;publicKey;constructor(t,e){this._key=t,this.publicKey=e}get raw(){return null==this._raw&&(this._raw=function(t){if(null==t.n||null==t.e||null==t.d||null==t.p||null==t.q||null==t.dp||null==t.dq||null==t.qi)throw new Jn("JWK was missing components");const e=new Lh({value:[new Bh({value:0}),Bh.fromBigInt(gl(kc(t.n,"base64url"))),Bh.fromBigInt(gl(kc(t.e,"base64url"))),Bh.fromBigInt(gl(kc(t.d,"base64url"))),Bh.fromBigInt(gl(kc(t.p,"base64url"))),Bh.fromBigInt(gl(kc(t.q,"base64url"))),Bh.fromBigInt(gl(kc(t.dp,"base64url"))),Bh.fromBigInt(gl(kc(t.dq,"base64url"))),Bh.fromBigInt(gl(kc(t.qi,"base64url")))]}).toBER();return new Uint8Array(e,0,e.byteLength)}(this._key)),this._raw}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}sign(t){return async function(t,e){const r=await cl.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await cl.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}(this._key,t)}}const fl=8192,dl=18;function yl(t){if(null==t.n||null==t.e)throw new Jn("JWK was missing components");const e=new Lh({value:[new Lh({value:[new Ih({value:"1.2.840.113549.1.1.1"}),new fh]}),new bh({valueHex:new Lh({value:[Bh.fromBigInt(gl(kc(t.n,"base64url"))),Bh.fromBigInt(gl(kc(t.e,"base64url")))]}).toBER()})]}).toBER();return new Uint8Array(e,0,e.byteLength)}function pl(t){let e=t.valueBlock.valueHexView;for(;0===e[0];)e=e.subarray(1);return il(e,"base64url")}function gl(t){const e=[];return t.forEach((function(t){let r=t.toString(16);r.length%2>0&&(r=`0${r}`),e.push(r)})),BigInt("0x"+e.join(""))}class wl extends Yi{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Fi(t.outputLen),Fi(t.blockLen)}(t);const r=Wi(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return zi(this),this.iHash.update(t),this}digestInto(t){zi(this),ji(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bl=(t,e,r)=>new wl(t,e).update(r).digest();bl.create=(t,e)=>new wl(t,e);const{bytesToNumberBE:ml,hexToBytes:vl}=e,El={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=El;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(128&n[0])throw new e("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ml(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=El,r="string"==typeof t?vl(t):t;wo(r);let n=r.length;if(n<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=El._parseInt(r.subarray(2)),{d:s,l:a}=El._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),c=r(s);return`30${r(s+o+4)}02${c}${i}02${a}${n}`}},xl=BigInt(0),Bl=BigInt(1),Al=(BigInt(2),BigInt(3));function kl(t){const e=function(t){const e=es(t);return Ro(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(t){return jo(t,n)}function a(t){return Ko(t,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=function(t){const e=function(t){const e=es(t);Ro(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=e.toBytes||((t,e,n)=>{const i=e.toAffine();return Co(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),i=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){const{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&xl<t&&t<e.n}function a(t){if(!s(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=e;if(r&&"bigint"!=typeof t){if(go(t)&&(t=mo(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*n,"0")}let s;try{s="bigint"==typeof t?t:Ao(To("private key",t,n))}catch(e){throw new Error(`private key must be ${n} bytes, hex or bigint, not ${typeof t}`)}return i&&(s=jo(s,o)),a(s),s}const u=new Map;function h(t){if(!(t instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required")}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof l)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?l.ZERO:new l(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(l.fromAffine)}static fromHex(t){const e=l.fromAffine(i(To("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return l.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:n}=this.toAffine();if(!r.isValid(t)||!r.isValid(n))throw new Error("bad point: x or y not FE");const i=r.sqr(n),s=o(t);if(!r.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){h(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),u=r.eql(r.mul(n,a),r.mul(s,i));return c&&u}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,Al),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,h=r.ZERO,f=r.mul(o,o),d=r.mul(s,s),y=r.mul(a,a),p=r.mul(o,s);return p=r.add(p,p),h=r.mul(o,a),h=r.add(h,h),c=r.mul(t,h),u=r.mul(i,y),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(p,c),h=r.mul(i,h),y=r.mul(t,y),p=r.sub(f,y),p=r.mul(t,p),p=r.add(p,h),h=r.add(f,f),f=r.add(h,f),f=r.add(f,y),f=r.mul(f,p),u=r.add(u,f),y=r.mul(s,a),y=r.add(y,y),f=r.mul(y,p),c=r.sub(c,f),h=r.mul(y,d),h=r.add(h,h),h=r.add(h,h),new l(c,u,h)}add(t){h(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let u=r.ZERO,f=r.ZERO,d=r.ZERO;const y=e.a,p=r.mul(e.b,Al);let g=r.mul(n,s),w=r.mul(i,a),b=r.mul(o,c),m=r.add(n,i),v=r.add(s,a);m=r.mul(m,v),v=r.add(g,w),m=r.sub(m,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(g,b),v=r.sub(v,E),E=r.add(i,o),u=r.add(a,c),E=r.mul(E,u),u=r.add(w,b),E=r.sub(E,u),d=r.mul(y,v),u=r.mul(p,b),d=r.add(u,d),u=r.sub(w,d),d=r.add(w,d),f=r.mul(u,d),w=r.add(g,g),w=r.add(w,g),b=r.mul(y,b),v=r.mul(p,v),w=r.add(w,b),b=r.sub(g,b),b=r.mul(y,b),v=r.add(v,b),g=r.mul(w,v),f=r.add(f,g),g=r.mul(E,v),u=r.mul(m,u),u=r.sub(u,g),g=r.mul(m,w),d=r.mul(E,d),d=r.add(d,g),new l(u,f,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(l.ZERO)}wNAF(t){return d.wNAFCached(this,u,t,(t=>{const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(l.fromAffine)}))}multiplyUnsafe(t){const n=l.ZERO;if(t===xl)return n;if(a(t),t===Bl)return this;const{endo:i}=e;if(!i)return d.unsafeLadder(this,t);let{k1neg:o,k1:s,k2neg:c,k2:u}=i.splitScalar(t),h=n,f=n,y=this;for(;s>xl||u>xl;)s&Bl&&(h=h.add(y)),u&Bl&&(f=f.add(y)),y=y.double(),s>>=Bl,u>>=Bl;return o&&(h=h.negate()),c&&(f=f.negate()),f=new l(r.mul(f.px,i.beta),f.py,f.pz),h.add(f)}multiply(t){a(t);let n,i,o=t;const{endo:s}=e;if(s){const{k1neg:t,k1:e,k2neg:a,k2:c}=s.splitScalar(o);let{p:u,f:h}=this.wNAF(e),{p:f,f:y}=this.wNAF(c);u=d.constTimeNegate(t,u),f=d.constTimeNegate(a,f),f=new l(r.mul(f.px,s.beta),f.py,f.pz),n=u.add(f),i=h.add(y)}else{const{p:t,f:e}=this.wNAF(o);n=t,i=e}return l.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(t,e,r){const n=l.BASE,i=(t,e)=>e!==xl&&e!==Bl&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){const{px:e,py:n,pz:i}=this,o=this.is0();null==t&&(t=o?r.ONE:r.inv(i));const s=r.mul(e,t),a=r.mul(n,t),c=r.mul(i,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===Bl)return!0;if(r)return r(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===Bl?this:r?r(l,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),n(l,this,t)}toHex(t=!0){return mo(this.toRawBytes(t))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);const f=e.nBitLength,d=ts(l,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}({...e,toBytes(t,e,n){const i=e.toAffine(),o=r.toBytes(i.x),s=Co;return n?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(t){const e=t.length,n=t[0],s=t.subarray(1);if(e!==i||2!==n&&3!==n){if(e===o&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}{const t=Ao(s);if(!(xl<(a=t)&&a<r.ORDER))throw new Error("Point is not on curve");const e=h(t);let i;try{i=r.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("Point is not on curve"+e)}return 1==(1&n)!=((i&Bl)===Bl)&&(i=r.neg(i)),{x:t,y:i}}var a}}),f=t=>mo(So(t,e.nByteLength));function d(t){return t>n>>Bl}const y=(t,e,r)=>Ao(t.slice(e,r));class p{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){const r=e.nByteLength;return t=To("compactSignature",t,2*r),new p(y(t,0,r),y(t,r,2*r))}static fromDER(t){const{r:e,s:r}=El.toSig(To("DER",t));return new p(e,r)}assertValidity(){if(!l(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!l(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){const{r:n,s:i,recovery:o}=this,u=m(To("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const h=2===o||3===o?n+e.n:n;if(h>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const l=0==(1&o)?"02":"03",d=c.fromHex(l+f(h)),y=a(h),p=s(-u*y),g=s(i*y),w=c.BASE.multiplyAndAddUnsafe(d,p,g);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Bo(this.toDERHex())}toDERHex(){return El.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Bo(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const g={isValidPrivateKey(t){try{return u(t),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const t=Yo(e.n);return function(t,e,r=!1){const n=t.length,i=Zo(e),o=Yo(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);const s=jo(r?Ao(t):ko(t),e-Vo)+Vo;return r?Io(s,i):So(s,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function w(t){const e=go(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===o:r?n===2*i||n===2*o:t instanceof c}const b=e.bits2int||function(t){const r=Ao(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},m=e.bits2int_modN||function(t){return s(b(t))},v=Uo(e.nBitLength);function E(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(xl<=t&&t<v))throw new Error(`bigint expected < 2^${e.nBitLength}`);return So(t,e.nByteLength)}const x={lowS:e.lowS,prehash:!1},B={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(w(t))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(u(t)).toRawBytes(r)},sign:function(t,n,i=x){const{seed:o,k2sig:h}=function(t,n,i=x){if(["recovered","canonical"].some((t=>t in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:h}=e;let{lowS:f,prehash:y,extraEntropy:g}=i;null==f&&(f=!0),t=To("msgHash",t),y&&(t=To("prehashed msgHash",o(t)));const w=m(t),v=u(n),B=[E(v),E(w)];if(null!=g&&!1!==g){const t=!0===g?h(r.BYTES):g;B.push(To("extraEntropy",t))}const A=Co(...B),k=w;return{seed:A,k2sig:function(t){const e=b(t);if(!l(e))return;const r=a(e),n=c.BASE.multiply(e).toAffine(),i=s(n.x);if(i===xl)return;const o=s(r*s(k+i*v));if(o===xl)return;let u=(n.x===i?0:2)|Number(n.y&Bl),h=o;return f&&d(o)&&(h=function(t){return d(t)?s(-t):t}(o),u^=1),new p(i,h,u)}}}(t,n,i),f=e;return Oo(f.hash.outputLen,f.nByteLength,f.hmac)(o,h)},verify:function(t,r,n,i=B){const o=t;if(r=To("msgHash",r),n=To("publicKey",n),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:h}=i;let l,f;try{if("string"==typeof o||go(o))try{l=p.fromDER(o)}catch(t){if(!(t instanceof El.Err))throw t;l=p.fromCompact(o)}else{if("object"!=typeof o||"bigint"!=typeof o.r||"bigint"!=typeof o.s)throw new Error("PARSE");{const{r:t,s:e}=o;l=new p(t,e)}}f=c.fromHex(n)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&l.hasHighS())return!1;h&&(r=e.hash(r));const{r:d,s:y}=l,g=m(r),w=a(y),b=s(g*w),v=s(d*w),E=c.BASE.multiplyAndAddUnsafe(f,b,v)?.toAffine();return!!E&&s(E.x)===d},ProjectivePoint:c,Signature:p,utils:g}}function Sl(t){return{hash:t,hmac:(e,...r)=>bl(t,e,Zi(...r)),randomBytes:Xi}}BigInt(4);const Il=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Tl=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Cl=BigInt(1),Ul=BigInt(2),Ll=(t,e)=>(t+e/Ul)/e;const Nl=Wo(Il,void 0,void 0,{sqrt:function(t){const e=Il,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,h=u*u*t%e,l=qo(h,r,e)*h%e,f=qo(l,r,e)*h%e,d=qo(f,Ul,e)*u%e,y=qo(d,i,e)*d%e,p=qo(y,o,e)*y%e,g=qo(p,a,e)*p%e,w=qo(g,c,e)*g%e,b=qo(w,a,e)*p%e,m=qo(b,r,e)*h%e,v=qo(m,s,e)*y%e,E=qo(v,n,e)*u%e,x=qo(E,Ul,e);if(!Nl.eql(Nl.sqr(x),t))throw new Error("Cannot find square root");return x}}),Ol=function(t,e){const r=e=>kl({...t,...Sl(e)});return Object.freeze({...r(e),create:r})}({a:BigInt(0),b:BigInt(7),Fp:Nl,n:Tl,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Tl,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Cl*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Ll(o*t,e),c=Ll(-n*t,e);let u=jo(t-a*r-c*i,e),h=jo(-a*n-c*o,e);const l=u>s,f=h>s;if(l&&(u=e-u),f&&(h=e-h),u>s||h>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:u,k2neg:f,k2:h}}}},Yc);function _l({name:t,code:e,encode:r}){return new Rl(t,e,r)}BigInt(0),Ol.ProjectivePoint;class Rl{name;code;encode;constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?Ci(this.code,e):e.then((t=>Ci(this.code,t)))}throw Error("Unknown type, must be binary type")}}function Dl(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const Vl=_l({name:"sha2-256",code:18,encode:Dl("SHA-256")});function Ml(t){return null!=t&&"function"==typeof t.then&&"function"==typeof t.catch&&"function"==typeof t.finally}_l({name:"sha2-512",code:19,encode:Dl("SHA-512")});class Pl{type="secp256k1";raw;_key;constructor(t){this._key=function(t){try{return Ol.ProjectivePoint.fromHex(t),t}catch(t){throw new Wn(String(t))}}(t),this.raw=function(t){return Ol.ProjectivePoint.fromHex(t).toRawBytes(!0)}(this._key)}toMultihash(){return Hi(jl(this))}toCID(){return _i.createV1(114,this.toMultihash())}toString(){return ci.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}verify(t,e){return function(t,e,r){const n=Vl.digest(r instanceof Uint8Array?r:r.subarray());if(Ml(n))return n.then((({digest:r})=>Ol.verify(e,r,t))).catch((t=>{throw new sl(String(t))}));try{return Ol.verify(e,n.digest,t)}catch(t){throw new sl(String(t))}}(this._key,e,t)}}class Hl{type="secp256k1";raw;publicKey;constructor(t,e){this.raw=function(t){try{return Ol.getPublicKey(t,!0),t}catch(t){throw new Zn(String(t))}}(t),this.publicKey=new Pl(e??function(t){try{return Ol.getPublicKey(t,!0)}catch(t){throw new Zn(String(t))}}(t))}equals(t){return null!=t&&t.raw instanceof Uint8Array&&$i(this.raw,t.raw)}sign(t){return function(t,e){const r=Vl.digest(e instanceof Uint8Array?e:e.subarray());if(Ml(r))return r.then((({digest:e})=>Ol.sign(e,t).toDERRawBytes())).catch((t=>{throw new ol(String(t))}));try{return Ol.sign(r.digest,t).toDERRawBytes()}catch(t){throw new ol(String(t))}}(this.raw,t)}}async function $l(t,e){if("Ed25519"===t)return async function(){const{privateKey:t,publicKey:e}=function(){const t=ms.utils.randomPrivateKey(),e=ms.getPublicKey(t);return{privateKey:Bs(t,e),publicKey:e}}();return new ks(t,e)}();if("secp256k1"===t)return async function(){const t=Ol.utils.randomPrivateKey();return new Hl(t)}();if("RSA"===t)return async function(t){if(t>fl)throw new Jn("Key size is too large");const e=await async function(t){const e=await cl.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await async function(t){if(null==t.privateKey||null==t.publicKey)throw new Jn("Private and public key are required");return Promise.all([cl.get().subtle.exportKey("jwk",t.privateKey),cl.get().subtle.exportKey("jwk",t.publicKey)])}(e);return{privateKey:r[0],publicKey:r[1]}}(t),r=Yc(jc.encode({Type:$c.RSA,Data:yl(e.publicKey)})),n=Ci(dl,r);return new ll(e.privateKey,new hl(e.publicKey,n))}(e??2048);throw new Yn}function Fl(t){return 32===t.byteLength?function(t){return t=Ss(t,32),new As(t)}(t):33===t.byteLength?function(t){return new Pl(t)}(t):function(t){const e=function(t){const{result:e}=ah(t),r=e.valueBlock.value[1].valueBlock.value[0].valueBlock.value;return{kty:"RSA",n:pl(r[0]),e:pl(r[1])}}(t);if(ul(e)>fl)throw new Wn("Key size is too large");const r=Yc(jc.encode({Type:$c.RSA,Data:t})),n=Ci(dl,r);return new hl(e,n)}(t)}function jl(t){return jc.encode({Type:$c[t.type],Data:t.raw})}function zl(t){return 64===t.byteLength?function(t){if(t.length>Es){const e=(t=Ss(t,Es+32)).subarray(0,Es),r=t.subarray(Es,t.length);return new ks(e,r)}const e=(t=Ss(t,Es)).subarray(0,Es),r=t.subarray(32);return new ks(e,r)}(t):32===t.byteLength?function(t){return new Hl(t)}(t):function(t){const e=function(t){const{result:e}=ah(t),r=e.valueBlock.value;return{n:pl(r[1]),e:pl(r[2]),d:pl(r[3]),p:pl(r[4]),q:pl(r[5]),dp:pl(r[6]),dq:pl(r[7]),qi:pl(r[8]),kty:"RSA",alg:"RS256"}}(t);return function(t){if(ul(t)>fl)throw new Jn("Key size is too large");const e=function(t){if(null==t)throw new Jn("Missing key parameter");return{privateKey:t,publicKey:{kty:t.kty,n:t.n,e:t.e}}}(t),r=Yc(jc.encode({Type:$c.RSA,Data:yl(e.publicKey)})),n=Ci(dl,r);return new ll(e.privateKey,new hl(e.publicKey,n))}(e)}(t)}const ql=async(t,e)=>{if(!t)throw new Error("No signing key given");if(!e)throw new Error("Given input data was undefined");return e instanceof Uint8Array||(e="string"==typeof e?kc(e):new Uint8Array(e)),il(await t.sign(e),"base16")},Kl=Un({size:1e3}),Gl=async(t,e,r)=>{const n=await Kl,i=await n.get(t);let o=!1;if(i){const t=(t,e)=>e instanceof Uint8Array?0===function(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}(t,e):t.toString()===e.toString();o=i.publicKey===e&&t(i.data,r)}else{const i=await(async(t,e,r)=>{if(!t)throw new Error("No signature given");if(!e)throw new Error("Given publicKey was undefined");if(!r)throw new Error("Given input data was undefined");r instanceof Uint8Array||(r="string"==typeof r?kc(r):new Uint8Array(r));let n=!1;try{const a=Fl(kc(e,"base16"));n=await(i=a,o=r,s=kc(t,"base16"),i.verify(o,s))}catch(t){}var i,o,s;return Promise.resolve(n)})(t,e,r);o=i,i&&await n.put(t,{publicKey:e,data:r})}return o},Jl=async({storage:t,path:e}={})=>{t=t||await kn(await Un({size:1e3}),await Tn({path:e||"./keystore"}));const r=await Un({size:1e3}),n=async(e,n)=>{const{privateKey:i}=n;await t.put("private_"+e,i);const o=zl(i);await r.put(e,o)};return{clear:async()=>{await t.clear(),await r.clear()},close:async()=>{await t.close(),await r.close()},hasKey:async e=>{if(!e)throw new Error("id needed to check a key");let n=!1,i=await r.get(e);if(i)n=!0;else try{i=await t.get("private_"+e),n=null!=i}catch(t){console.error("Error: ENOENT: no such file or directory")}return n},addKey:n,createKey:async t=>{if(!t)throw new Error("id needed to create a key");const e=await $l("secp256k1"),r={publicKey:e.publicKey.raw,privateKey:e.raw};return await n(t,r),e},getKey:async e=>{if(!e)throw new Error("id needed to get a key");let n=await r.get(e);if(!n){let i;try{i=await t.get("private_"+e)}catch(t){}if(!i)return;n=zl(i),await r.put(e,n)}return n},getPublic:(t,e={})=>{const r=e.format||"hex";if(-1===["hex","buffer"].indexOf(r))throw new Error("Supported formats are `hex` and `buffer`");const n=t.publicKey.raw;return"buffer"===r?n:il(n,"base16")}}},Wl=t,Zl=sn,Yl=X,Ql=async({id:t,publicKey:e,signatures:r,type:n,sign:i,verify:o}={})=>{if(!t)throw new Error("Identity id is required");if(!e)throw new Error("Invalid public key");if(!r)throw new Error("Signatures object is required");if(!r.id)throw new Error("Signature of id is required");if(!r.publicKey)throw new Error("Signature of publicKey+id is required");if(!n)throw new Error("Identity type is required");const s={id:t,publicKey:e,signatures:r=Object.assign({},r),type:n,sign:i,verify:o},{hash:a,bytes:c}=await Xl(s);return s.hash=a,s.bytes=c,s},Xl=async t=>{const{id:e,publicKey:r,signatures:n,type:i}=t,o={id:e,publicKey:r,signatures:n,type:i},{cid:s,bytes:a}=await Pt({value:o,codec:Wl,hasher:Zl});return{hash:s.toString(Yl),bytes:Uint8Array.from(a)}},tf=t=>Boolean(t.id&&t.hash&&t.bytes&&t.publicKey&&t.signatures&&t.signatures.id&&t.signatures.publicKey&&t.type),ef="publickey",rf=({keystore:t})=>async()=>{if(!t)throw new Error("PublicKeyIdentityProvider requires a keystore parameter");return{type:ef,getId:async({id:e}={})=>{if(!e)throw new Error("id is required");return il((await t.getKey(e)||await t.createKey(e)).publicKey.raw,"base16")},signIdentity:async(e,{id:r}={})=>{if(!r)throw new Error("id is required");const n=await t.getKey(r);if(!n)throw new Error(`Signing key for '${r}' not found`);return ql(n,e)}}};rf.verifyIdentity=async t=>{const{id:e,publicKey:r,signatures:n}=t;return Gl(n.publicKey,e,r+n.id)},rf.type=ef;const nf=rf,of={},sf=t=>{if(!(t=>Object.keys(of).includes(t))(t))throw new Error(`IdentityProvider type '${t}' is not supported`);return of[t]},af=t=>{if(!t.type||"string"!=typeof t.type)throw new Error("Given IdentityProvider doesn't have a field 'type'.");if(!t.verifyIdentity)throw new Error("Given IdentityProvider doesn't have a function 'verifyIdentity'.");of[t.type]=t};af(nf);const cf=P("./orbitdb","identities"),uf=async({keystore:t,path:e,storage:r,ipfs:n}={})=>{t=t||await Jl({path:e||cf}),r||(r=n?await kn(await Un({size:1e3}),await Sn({ipfs:n,pin:!0})):await dn());const i=await Un({size:1e3}),o=async(e,r)=>{const n=await t.getKey(e.id);if(!n)throw new Error("Private signing key not found from KeyStore");return await ql(n,r)},s=async(t,e,r)=>await Gl(t,e,r);return{createIdentity:async(e={})=>{e.keystore=t;const n=sf("publickey"),i=e.provider||n({keystore:t}),a=await i();if(!sf(a.type))throw new Error("Identity provider is unknown. Use useIdentityProvider(provider) to register the identity provider");const c=await a.getId(e),u=await t.getKey(c)||await t.createKey(c),h=t.getPublic(u),l=await ql(u,c),f={id:l,publicKey:await a.signIdentity(h+l,e)},d=await Ql({id:c,publicKey:h,signatures:f,type:a.type,sign:o,verify:s});return await r.put(d.hash,d.bytes),d},verifyIdentity:async t=>{if(!tf(t))return!1;const{id:e,publicKey:r,signatures:n}=t;if(!await s(n.id,r,e))return!1;const o=await i.get(n.id);if(o)return c=o,(a=t).id===c.id&&a.hash===c.hash&&a.type===c.type&&a.publicKey===c.publicKey&&a.signatures.id===c.signatures.id&&a.signatures.publicKey===c.signatures.publicKey;var a,c;const u=sf(t.type),h=await u.verifyIdentity(t);return h&&await i.put(n.id,t),h},getIdentity:async t=>{const e=await r.get(t);if(e)return(async t=>{const{value:e}=await Ht({bytes:t,codec:Wl,hasher:Zl});return Ql({...e})})(e)},sign:o,verify:s,keystore:t}},hf=t=>{if(!(t=t.toString()).startsWith("/orbitdb")&&!t.startsWith("\\orbitdb"))return!1;let e;t=(t=(t=(t=t.replaceAll("/orbitdb/","")).replaceAll("\\orbitdb\\","")).replaceAll("/","")).replaceAll("\\","");try{e=Bt.parse(t,X)}catch(t){return!1}return void 0!==e},lf=t=>{if(!t)throw new Error(`Not a valid OrbitDB address: ${t}`);if(!hf(t))throw new Error(`Not a valid OrbitDB address: ${t}`);return ff(t)},ff=t=>{if(t&&"orbitdb"===t.protocol&&t.hash)return t;const e="orbitdb",r=t.replace("/orbitdb/","").replace("\\orbitdb\\","");return{protocol:e,hash:r,address:t,toString:()=>M("/",e,r)}},df=t,yf=sn,pf=X,gf=async(t=32)=>{let e="",r=0;for(;r<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),r+=1;return e},wf=t,bf=sn,mf=X,vf="ipfs",Ef=({write:t,storage:e}={})=>async({orbitdb:r,identities:n,address:i})=>{if(e=e||await kn(await Un({size:1e3}),await Sn({ipfs:r.ipfs,pin:!0})),t=t||[r.identity.id],i){const r=await e.get(i.replaceAll("/ipfs/","")),{value:n}=await Ht({bytes:r,codec:wf,hasher:bf});t=n.write}else i=await(async({storage:t,type:e,params:r})=>{const n={type:e,...r},{cid:i,bytes:o}=await Pt({value:n,codec:wf,hasher:bf}),s=i.toString(mf);return await t.put(s,o),s})({storage:e,type:vf,params:{write:t}}),i=P("/",vf,i);return{type:vf,address:i,write:t,canAppend:async e=>{const r=await n.getIdentity(e.identity);if(!r)return!1;const{id:i}=r;return!(!t.includes(i)&&!t.includes("*"))&&await n.verifyIdentity(r)}}};Ef.type=vf;const xf=Ef,Bf="orbitdb",Af=({write:t}={})=>async({orbitdb:e,identities:r,address:n,name:i})=>{n=n||i||await gf(64),t=t||[e.identity.id];const o=await e.open(n,{type:"keyvalue",AccessController:xf({write:t})});n=o.address;const s=async()=>{const t=[];for await(const e of o.iterator())t[e.key]=e.value;return Object.entries({...t,admin:new Set([...t.admin||[],...o.access.write])}).forEach((e=>{const r=e[0];t[r]=new Set([...t[r]||[],...e[1]])})),t},a=async t=>(await s())[t]||new Set([]),c=async(t,e)=>{const r=new Set(await a(t));return r.has(e)||r.has("*")};return{type:Bf,address:n,write:t,canAppend:async t=>{const e=await r.getIdentity(t.identity);if(!e)return!1;const{id:n}=e;return!(!await c("write",n)&&!await c("admin",n))&&await r.verifyIdentity(e)},capabilities:s,get:a,grant:async(t,e)=>{const r=new Set([...await o.get(t)||[],e]);await o.put(t,Array.from(r.values()))},revoke:async(t,e)=>{const r=new Set(await o.get(t)||[]);r.delete(e),r.size>0?await o.put(t,Array.from(r.values())):await o.del(t)},close:async()=>{await o.close()},drop:async()=>{await o.drop()},events:o.events}};Af.type=Bf;const kf=Af,Sf={},If=t=>{if(!t.type)throw new Error("AccessController does not contain required field 'type'.");Sf[t.type]=t};If(xf),If(kf);const Tf=xf,Cf=async({ipfs:t,id:e,identity:r,identities:n,directory:i}={})=>{if(null==t)throw new Error("IPFS instance is a required argument.");e=e||await gf();const o=t.libp2p.peerId;let s;i=i||"./orbitdb",n?s=n.keystore:(s=await Jl({path:P(i,"./keystore")}),n=await uf({ipfs:t,keystore:s})),r?r.provider&&(r=await n.createIdentity({...r})):r=await n.createIdentity({id:e});const a=await(async({ipfs:t,storage:e}={})=>(e=e||await kn(await Un({size:1e5}),await Sn({ipfs:t,pin:!0})),{get:async t=>{const r=await e.get(t),{value:n}=await Ht({bytes:r,codec:df,hasher:yf});return n&&await e.put(t,r),n},create:async({name:t,type:r,accessController:n,meta:i})=>{if(!t)throw new Error("name is required");if(!r)throw new Error("type is required");if(!n)throw new Error("accessController is required");const o=Object.assign({name:t,type:r,accessController:n},void 0!==i?{meta:i}:{}),{cid:s,bytes:a}=await Pt({value:o,codec:df,hasher:yf}),c=s.toString(pf);return await e.put(c,a),{hash:c,manifest:o}},close:async()=>{await e.close()}}))({ipfs:t});let c={};const u=async(e,{type:o,meta:s,sync:l,Database:f,AccessController:d,headsStorage:y,entryStorage:p,indexStorage:g,referencesCount:w}={})=>{let b,m,v;if(c[e])return c[e];if(hf(e)){const i=ff(e);m=await a.get(i.hash),d=(t=>{if(!Sf[t])throw new Error(`AccessController type '${t}' is not supported`);return Sf[t]})(m.accessController.split("/",2).pop())(),v=await d({orbitdb:{open:u,identity:r,ipfs:t},identities:n,address:m.accessController}),b=m.name,o=o||m.type,s=m.meta}else{o=o||"events",d=d||Tf(),v=await d({orbitdb:{open:u,identity:r,ipfs:t},identities:n,name:e});const i=await a.create({name:e,type:o,accessController:v.address,meta:s});if(m=i.manifest,e=ff(i.hash),b=m.name,s=m.meta,c[e])return c[e]}if(f=f||(t=>{if(!t)throw new Error("Type not specified");if(!Kn[t])throw new Error(`Unsupported database type: '${t}'`);return Kn[t]})(o)(),!f)throw new Error(`Unsupported database type: '${o}'`);e=e.toString();const E=await f({ipfs:t,identity:r,address:e,name:b,access:v,directory:i,meta:s,syncAutomatically:l,headsStorage:y,entryStorage:p,indexStorage:g,referencesCount:w});return E.events.on("close",h(e)),c[e]=E,E},h=t=>()=>{delete c[t]};return{id:e,open:u,stop:async()=>{for(const t of Object.values(c))await t.close();s&&await s.close(),a&&await a.close(),c={}},ipfs:t,directory:i,keystore:s,identities:n,identity:r,peerId:o}}})(),OrbitDB=n})();