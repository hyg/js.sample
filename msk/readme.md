## 自动脱敏

### 需求

1. 在对话中（包括而不限于IM、email...等等）自动分析收发内容。
1. 识别可能的敏感词：
    - 名称：包括而不限于人名、地名、机构名称、产品名称、...等等
    - 时间：日期、时刻、...等等
    - 数字: 金额、年龄、身高、体重、...等等
1. 对每个可能的敏感词，询问用户：
    - 是否敏感词，如果是：
        - 黑名单：使用占位符
        - 白名单：使用原文
        - 默认操作：占位符 or 原文
1. 自动模式下，自动选择：
    - 是敏感词：
        - 默认操作：使用占位符
1. 敏感词：
    - 编号
    - 原文：比如Node.js
    - 别名：比如nodejs,node,...提示性的，由agent根据上下文判断。
    - 类型：人名、金额、...等等
    - 黑名单
    - 白名单
    - 默认操作
1. 占位符：<<编号,类型>>
1. 敏感词的元数据前四个字段随正文发给白名单成员，同一次会话中使用相同的编号。
1. 发给黑名单成员的对话内容： 原文...<<编号,类型>>...原文
1. 黑名单成员收到对话内容后，自动生成代号替换占位符：
    - 在同一次对话中，同一个占位符使用相同的代号；
    - 针对不同内容生成易于理解的代号，比如人名使用[张三]、[李四]。
1. 会话记录中附加占位符映射表：{会话ID,[{敏感词元数据],[{占位符:代号}]}

1. TBD：关联数量可以选择保持关系。比如100元被显示为X元，另一处关联的500元则显示为5*X元。

### 用户场景

- userA->agentA：Bun像是一辆轻量电动超跑,Node.js像是一架“波音 747”。Deno则像混合动力，安全和现代语法优先。
- agentA->userA：潜在敏感词列表（含类别建议）
    【Bun】——产品名称
    【Node.js】——产品名称
    【Deno】——产品名称
    【波音 747】——产品名称（飞机型号）
- userA->agentA：bun对B保密，deno对C保密，其他人不用。
- agentA->userA：
{编号:08d1082cc8d85a0833da8815ff1574675c415760e0aff7fb4e32de6de27faf86,原文:bun,别名:Bun,类型:产品,黑名单:B,白名单:C,默认:原文},
{编号:e872e7bd2ae6abcf13a4c834029a342c882c1162ebf77b6720968b2000312ffb,原文:deno,别名:Deno,类型:产品,黑名单:C,白名单:B,默认:原文},
确认请按Enter，补充请直接交代。
- 用户A->agentA：enter
- agentA->agentB：{content:`<<08d1082cc8d85a0833da8815ff1574675c415760e0aff7fb4e32de6de27faf86,产品>>像是一辆轻量电动超跑,Node.js像是一架“波音 747”。Deno则像混合动力，安全和现代语法优先。`,metadata:[{编号:e872e7bd2ae6abcf13a4c834029a342c882c1162ebf77b6720968b2000312ffb,原文:deno,别名:Deno,类型:产品}]}
- agentA->agentB：{content: `Bun像是一辆轻量电动超跑,Node.js像是一架“波音 747”。<<e872e7bd2ae6abcf13a4c834029a342c882c1162ebf77b6720968b2000312ffb,产品>>则像混合动力，安全和现代语法优先。`,metadata:[{编号:08d1082cc8d85a0833da8815ff1574675c415760e0aff7fb4e32de6de27faf86,原文:bun,别名:Bun,类型:产品}]}
- agentA->agentD:{content: `Bun像是一辆轻量电动超跑,Node.js像是一架“波音 747”。Deno则像混合动力，安全和现代语法优先。`,metadata:[{编号:e872e7bd2ae6abcf13a4c834029a342c882c1162ebf77b6720968b2000312ffb,原文:deno,别名:Deno,类型:产品},{编号:08d1082cc8d85a0833da8815ff1574675c415760e0aff7fb4e32de6de27faf86,原文:bun,别名:Bun,类型:产品}]}
- agentB->userB: **产品A**像是一辆轻量电动超跑,Node.js像是一架“波音 747”。Deno则像混合动力，安全和现代语法优先。
- agentC->userC: Bun像是一辆轻量电动超跑,Node.js像是一架“波音 747”。**产品甲**则像混合动力，安全和现代语法优先。
- agentD->userD: Bun像是一辆轻量电动超跑,Node.js像是一架“波音 747”。Deno则像混合动力，安全和现代语法优先。
- agentB->userB：潜在敏感词列表（含类别建议）
    【Node.js】——产品名称
    【deno】——产品名称
    【波音 747】——产品名称（飞机型号）